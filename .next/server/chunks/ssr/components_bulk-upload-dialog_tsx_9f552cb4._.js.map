{"version":3,"sources":["../../../../components/bulk-upload-dialog.tsx","../../../../lib/etl/data-cleaner.ts","../../../../lib/etl/data-validator.ts","../../../../lib/etl/data-deduplicator.ts","../../../../lib/etl/etl-pipeline.ts","../../../../lib/upload-progress-tracker.ts","../../../../components/upload-progress-display.tsx","../../../../components/data-preview-table.tsx","../../../../components/column-mapping-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\"\nimport { Button } from \"@/components/ui/button\"\nimport { Upload, CheckCircle } from \"lucide-react\"\nimport { FileParser, type ParseResult } from \"@/lib/file-parser\"\nimport { ETLPipeline, type ETLResult } from \"@/lib/etl/etl-pipeline\"\nimport { UploadProgressTracker } from \"@/lib/upload-progress-tracker\"\nimport { UploadProgressDisplay } from \"@/components/upload-progress-display\"\nimport { DataPreviewTable } from \"@/components/data-preview-table\"\nimport { ColumnMappingDialog } from \"@/components/column-mapping-dialog\"\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\n\ninterface BulkUploadDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onComplete: () => void\n}\n\nexport function BulkUploadDialog({ open, onOpenChange, onComplete }: BulkUploadDialogProps) {\n  const [file, setFile] = useState<File | null>(null)\n  const [dragActive, setDragActive] = useState(false)\n  const [step, setStep] = useState<\"upload\" | \"mapping\" | \"preview\" | \"processing\">(\"upload\")\n  const [parseResult, setParseResult] = useState<ParseResult | null>(null)\n  const [etlResult, setETLResult] = useState<ETLResult | null>(null)\n  const [columnMapping, setColumnMapping] = useState<Record<string, string> | null>(null)\n  const [showMappingDialog, setShowMappingDialog] = useState(false)\n  const [progressTracker, setProgressTracker] = useState<UploadProgressTracker | null>(null)\n  const [uploadProgress, setUploadProgress] = useState<any>(null)\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true)\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false)\n    }\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    setDragActive(false)\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFile(e.dataTransfer.files[0])\n    }\n  }\n\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFile(e.target.files[0])\n    }\n  }\n\n  const handleFile = async (selectedFile: File) => {\n    const fileType = selectedFile.name.split(\".\").pop()?.toLowerCase()\n\n    if (![\"csv\", \"xlsx\", \"xls\", \"pdf\"].includes(fileType || \"\")) {\n      alert(\"Please upload a CSV, Excel, or PDF file\")\n      return\n    }\n\n    setFile(selectedFile)\n    setStep(\"mapping\")\n\n    try {\n      let result: ParseResult\n\n      if (fileType === \"csv\") {\n        result = await FileParser.parseCSV(selectedFile)\n      } else if (fileType === \"xlsx\" || fileType === \"xls\") {\n        result = await FileParser.parseExcel(selectedFile)\n      } else {\n        result = await FileParser.parsePDF(selectedFile)\n      }\n\n      setParseResult(result)\n\n      // Auto-detect columns and show mapping dialog\n      if (result.data.length > 0) {\n        const sourceColumns = Object.keys(result.data[0])\n        setShowMappingDialog(true)\n      }\n    } catch (error) {\n      console.error(\"Error parsing file:\", error)\n      alert(\"Failed to parse file. Please check the format and try again.\")\n    }\n  }\n\n  const handleMappingConfirm = async (mapping: Record<string, string>) => {\n    setColumnMapping(mapping)\n    setShowMappingDialog(false)\n    setStep(\"preview\")\n\n    // Run ETL pipeline\n    if (parseResult) {\n      const result = await ETLPipeline.process(parseResult.data, [])\n      setETLResult(result)\n    }\n  }\n\n  const handleUpload = async () => {\n    if (!etlResult || etlResult.unique.length === 0) return\n\n    setStep(\"processing\")\n    const tracker = new UploadProgressTracker(etlResult.unique.length)\n    setProgressTracker(tracker)\n\n    tracker.subscribe((progress) => {\n      setUploadProgress(progress)\n    })\n\n    try {\n      // Stage 1: Parsing (already done)\n      tracker.startStage(0, \"File parsed successfully\")\n      tracker.completeStage(0)\n\n      // Stage 2: Cleaning\n      tracker.startStage(1, \"Cleaning customer data...\")\n      await new Promise((resolve) => setTimeout(resolve, 500))\n      tracker.completeStage(1, `Cleaned ${etlResult.cleaned.length} records`)\n\n      // Stage 3: Validation\n      tracker.startStage(2, \"Validating records...\")\n      await new Promise((resolve) => setTimeout(resolve, 500))\n      tracker.completeStage(2, `${etlResult.valid.length} valid records`)\n\n      // Stage 4: Deduplication\n      tracker.startStage(3, \"Checking for duplicates...\")\n      await new Promise((resolve) => setTimeout(resolve, 500))\n      tracker.completeStage(3, `${etlResult.duplicates.length} duplicates found`)\n\n      // Stage 5: Upload\n      tracker.startStage(4, \"Uploading to database...\")\n\n      const batchSize = 50\n      const batches = []\n\n      for (let i = 0; i < etlResult.unique.length; i += batchSize) {\n        batches.push(etlResult.unique.slice(i, i + batchSize))\n      }\n\n      let successCount = 0\n      let failCount = 0\n\n      for (let i = 0; i < batches.length; i++) {\n        const response = await fetch(\"/api/accounting/customers/bulk\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ customers: batches[i] }),\n        })\n\n        if (response.ok) {\n          successCount += batches[i].length\n        } else {\n          failCount += batches[i].length\n        }\n\n        const progress = ((i + 1) / batches.length) * 100\n        tracker.updateStageProgress(4, progress, `Uploaded ${successCount} of ${etlResult.unique.length} records`)\n        tracker.updateRecordProgress(successCount + failCount, successCount, failCount)\n      }\n\n      tracker.completeStage(4, `Successfully uploaded ${successCount} customers`)\n\n      setTimeout(() => {\n        onComplete()\n        onOpenChange(false)\n        resetState()\n      }, 2000)\n    } catch (error) {\n      console.error(\"Error uploading customers:\", error)\n      if (progressTracker) {\n        progressTracker.errorStage(4, \"Failed to upload customers\")\n      }\n    }\n  }\n\n  const resetState = () => {\n    setFile(null)\n    setParseResult(null)\n    setETLResult(null)\n    setColumnMapping(null)\n    setStep(\"upload\")\n    setProgressTracker(null)\n    setUploadProgress(null)\n  }\n\n  return (\n    <>\n      <Dialog open={open} onOpenChange={onOpenChange}>\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Bulk Upload Customers</DialogTitle>\n            <DialogDescription>\n              Upload CSV, Excel, or PDF files with customer data. We'll automatically parse, clean, and validate the\n              data.\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-6\">\n            {/* Upload Step */}\n            {step === \"upload\" && (\n              <div\n                className={`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${\n                  dragActive ? \"border-accent bg-accent/5\" : \"border-border\"\n                }`}\n                onDragEnter={handleDrag}\n                onDragLeave={handleDrag}\n                onDragOver={handleDrag}\n                onDrop={handleDrop}\n              >\n                <Upload className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                <p className=\"text-lg font-medium text-foreground mb-2\">Drag and drop your file here</p>\n                <p className=\"text-sm text-muted-foreground mb-4\">or click to browse</p>\n                <input\n                  type=\"file\"\n                  id=\"file-upload\"\n                  className=\"hidden\"\n                  accept=\".csv,.xlsx,.xls,.pdf\"\n                  onChange={handleFileInput}\n                />\n                <label htmlFor=\"file-upload\">\n                  <Button variant=\"outline\" asChild>\n                    <span>Choose File</span>\n                  </Button>\n                </label>\n                <p className=\"text-xs text-muted-foreground mt-4\">Supported formats: CSV, Excel (.xlsx, .xls), PDF</p>\n              </div>\n            )}\n\n            {/* Preview Step */}\n            {step === \"preview\" && etlResult && (\n              <Tabs defaultValue=\"all\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-4\">\n                  <TabsTrigger value=\"all\">All ({etlResult.stats.totalInput})</TabsTrigger>\n                  <TabsTrigger value=\"valid\">Valid ({etlResult.stats.valid})</TabsTrigger>\n                  <TabsTrigger value=\"errors\">Errors ({etlResult.stats.invalid})</TabsTrigger>\n                  <TabsTrigger value=\"duplicates\">Duplicates ({etlResult.stats.duplicates})</TabsTrigger>\n                </TabsList>\n                <TabsContent value=\"all\" className=\"mt-4\">\n                  <DataPreviewTable\n                    data={etlResult.cleaned}\n                    errors={etlResult.invalid}\n                    warnings={etlResult.warnings}\n                    duplicates={etlResult.duplicates}\n                  />\n                </TabsContent>\n                <TabsContent value=\"valid\" className=\"mt-4\">\n                  <DataPreviewTable data={etlResult.valid} />\n                </TabsContent>\n                <TabsContent value=\"errors\" className=\"mt-4\">\n                  <DataPreviewTable data={etlResult.invalid.map((i) => i.customer)} errors={etlResult.invalid} />\n                </TabsContent>\n                <TabsContent value=\"duplicates\" className=\"mt-4\">\n                  <DataPreviewTable\n                    data={etlResult.duplicates.map((d) => d.duplicate)}\n                    duplicates={etlResult.duplicates}\n                  />\n                </TabsContent>\n              </Tabs>\n            )}\n\n            {/* Processing Step */}\n            {step === \"processing\" && uploadProgress && <UploadProgressDisplay progress={uploadProgress} />}\n\n            {/* Actions */}\n            {step === \"preview\" && etlResult && (\n              <div className=\"flex items-center justify-between pt-4 border-t border-border\">\n                <Button variant=\"outline\" onClick={resetState}>\n                  Start Over\n                </Button>\n                <Button onClick={handleUpload} disabled={etlResult.unique.length === 0} className=\"gap-2\">\n                  <CheckCircle className=\"h-4 w-4\" />\n                  Upload {etlResult.unique.length} Customer{etlResult.unique.length !== 1 ? \"s\" : \"\"}\n                </Button>\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Column Mapping Dialog */}\n      {parseResult && (\n        <ColumnMappingDialog\n          open={showMappingDialog}\n          onOpenChange={setShowMappingDialog}\n          sourceColumns={parseResult.data.length > 0 ? Object.keys(parseResult.data[0]) : []}\n          onConfirm={handleMappingConfirm}\n        />\n      )}\n    </>\n  )\n}\n","export interface CleaningRule {\n  field: string\n  transform: (value: any) => any\n}\n\nexport class DataCleaner {\n  static cleanCustomerData(data: any[]): any[] {\n    return data.map((record) => this.cleanRecord(record))\n  }\n\n  private static cleanRecord(record: any): any {\n    return {\n      contact_name: this.cleanName(record.contact_name),\n      company_name: this.cleanName(record.company_name),\n      email: this.cleanEmail(record.email),\n      phone: this.cleanPhone(record.phone),\n      address_line1: this.cleanAddress(record.address_line1),\n      address_line2: this.cleanAddress(record.address_line2),\n      city: this.cleanCity(record.city),\n      state: this.cleanState(record.state),\n      zip_code: this.cleanZipCode(record.zip_code),\n      country: this.cleanCountry(record.country),\n      tax_id: this.cleanTaxId(record.tax_id),\n      notes: this.cleanNotes(record.notes),\n    }\n  }\n\n  private static cleanName(value: any): string | undefined {\n    if (!value) return undefined\n    return String(value)\n      .trim()\n      .replace(/\\s+/g, \" \") // Replace multiple spaces with single space\n      .replace(/[^\\w\\s\\-'.]/g, \"\") // Remove special characters except dash, apostrophe, period\n  }\n\n  private static cleanEmail(value: any): string | undefined {\n    if (!value) return undefined\n    return String(value).trim().toLowerCase()\n  }\n\n  private static cleanPhone(value: any): string | undefined {\n    if (!value) return undefined\n    // Remove all non-digit characters\n    const digits = String(value).replace(/\\D/g, \"\")\n\n    // Format as (XXX) XXX-XXXX for US numbers\n    if (digits.length === 10) {\n      return `(${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6)}`\n    } else if (digits.length === 11 && digits[0] === \"1\") {\n      return `+1 (${digits.slice(1, 4)}) ${digits.slice(4, 7)}-${digits.slice(7)}`\n    }\n\n    return digits\n  }\n\n  private static cleanAddress(value: any): string | undefined {\n    if (!value) return undefined\n    return String(value).trim().replace(/\\s+/g, \" \")\n  }\n\n  private static cleanCity(value: any): string | undefined {\n    if (!value) return undefined\n    return String(value)\n      .trim()\n      .replace(/\\s+/g, \" \")\n      .replace(/\\b\\w/g, (char) => char.toUpperCase()) // Capitalize first letter of each word\n  }\n\n  private static cleanState(value: any): string | undefined {\n    if (!value) return undefined\n    const state = String(value).trim().toUpperCase()\n\n    // Map full state names to abbreviations\n    const stateMap: Record<string, string> = {\n      ALABAMA: \"AL\",\n      ALASKA: \"AK\",\n      ARIZONA: \"AZ\",\n      ARKANSAS: \"AR\",\n      CALIFORNIA: \"CA\",\n      COLORADO: \"CO\",\n      CONNECTICUT: \"CT\",\n      DELAWARE: \"DE\",\n      FLORIDA: \"FL\",\n      GEORGIA: \"GA\",\n      HAWAII: \"HI\",\n      IDAHO: \"ID\",\n      ILLINOIS: \"IL\",\n      INDIANA: \"IN\",\n      IOWA: \"IA\",\n      KANSAS: \"KS\",\n      KENTUCKY: \"KY\",\n      LOUISIANA: \"LA\",\n      MAINE: \"ME\",\n      MARYLAND: \"MD\",\n      MASSACHUSETTS: \"MA\",\n      MICHIGAN: \"MI\",\n      MINNESOTA: \"MN\",\n      MISSISSIPPI: \"MS\",\n      MISSOURI: \"MO\",\n      MONTANA: \"MT\",\n      NEBRASKA: \"NE\",\n      NEVADA: \"NV\",\n      \"NEW HAMPSHIRE\": \"NH\",\n      \"NEW JERSEY\": \"NJ\",\n      \"NEW MEXICO\": \"NM\",\n      \"NEW YORK\": \"NY\",\n      \"NORTH CAROLINA\": \"NC\",\n      \"NORTH DAKOTA\": \"ND\",\n      OHIO: \"OH\",\n      OKLAHOMA: \"OK\",\n      OREGON: \"OR\",\n      PENNSYLVANIA: \"PA\",\n      \"RHODE ISLAND\": \"RI\",\n      \"SOUTH CAROLINA\": \"SC\",\n      \"SOUTH DAKOTA\": \"SD\",\n      TENNESSEE: \"TN\",\n      TEXAS: \"TX\",\n      UTAH: \"UT\",\n      VERMONT: \"VT\",\n      VIRGINIA: \"VA\",\n      WASHINGTON: \"WA\",\n      \"WEST VIRGINIA\": \"WV\",\n      WISCONSIN: \"WI\",\n      WYOMING: \"WY\",\n    }\n\n    return stateMap[state] || state\n  }\n\n  private static cleanZipCode(value: any): string | undefined {\n    if (!value) return undefined\n    const zip = String(value).replace(/\\D/g, \"\")\n\n    // Format as XXXXX or XXXXX-XXXX\n    if (zip.length === 5) {\n      return zip\n    } else if (zip.length === 9) {\n      return `${zip.slice(0, 5)}-${zip.slice(5)}`\n    }\n\n    return zip\n  }\n\n  private static cleanCountry(value: any): string {\n    if (!value) return \"US\"\n    const country = String(value).trim().toUpperCase()\n\n    // Map common country names to ISO codes\n    const countryMap: Record<string, string> = {\n      \"UNITED STATES\": \"US\",\n      USA: \"US\",\n      AMERICA: \"US\",\n      CANADA: \"CA\",\n      MEXICO: \"MX\",\n      \"UNITED KINGDOM\": \"GB\",\n      UK: \"GB\",\n    }\n\n    return countryMap[country] || country\n  }\n\n  private static cleanTaxId(value: any): string | undefined {\n    if (!value) return undefined\n    // Remove all non-alphanumeric characters\n    return String(value).replace(/[^a-zA-Z0-9]/g, \"\")\n  }\n\n  private static cleanNotes(value: any): string | undefined {\n    if (!value) return undefined\n    return String(value).trim()\n  }\n}\n","export interface ValidationResult {\n  isValid: boolean\n  errors: Array<{ field: string; message: string }>\n  warnings: Array<{ field: string; message: string }>\n}\n\nexport class DataValidator {\n  static validateCustomer(customer: any): ValidationResult {\n    const errors: Array<{ field: string; message: string }> = []\n    const warnings: Array<{ field: string; message: string }> = []\n\n    // Required field validation\n    if (!customer.contact_name || customer.contact_name.trim() === \"\") {\n      errors.push({ field: \"contact_name\", message: \"Contact name is required\" })\n    }\n\n    // Email validation\n    if (customer.email) {\n      if (!this.isValidEmail(customer.email)) {\n        errors.push({ field: \"email\", message: \"Invalid email format\" })\n      }\n    } else {\n      warnings.push({ field: \"email\", message: \"Email is recommended for customer communication\" })\n    }\n\n    // Phone validation\n    if (customer.phone) {\n      if (!this.isValidPhone(customer.phone)) {\n        warnings.push({ field: \"phone\", message: \"Phone number format may be invalid\" })\n      }\n    }\n\n    // State validation\n    if (customer.state && !this.isValidState(customer.state)) {\n      warnings.push({ field: \"state\", message: \"State code may be invalid\" })\n    }\n\n    // Zip code validation\n    if (customer.zip_code && !this.isValidZipCode(customer.zip_code)) {\n      warnings.push({ field: \"zip_code\", message: \"Zip code format may be invalid\" })\n    }\n\n    // Tax ID validation\n    if (customer.tax_id) {\n      if (!this.isValidTaxId(customer.tax_id)) {\n        warnings.push({ field: \"tax_id\", message: \"Tax ID format may be invalid\" })\n      }\n    }\n\n    // Address completeness check\n    if (customer.address_line1 && !customer.city) {\n      warnings.push({ field: \"city\", message: \"City is recommended when address is provided\" })\n    }\n\n    if (customer.address_line1 && !customer.state) {\n      warnings.push({ field: \"state\", message: \"State is recommended when address is provided\" })\n    }\n\n    if (customer.address_line1 && !customer.zip_code) {\n      warnings.push({ field: \"zip_code\", message: \"Zip code is recommended when address is provided\" })\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n    }\n  }\n\n  static validateBatch(customers: any[]): {\n    valid: any[]\n    invalid: Array<{ customer: any; errors: Array<{ field: string; message: string }> }>\n    warnings: Array<{ customer: any; warnings: Array<{ field: string; message: string }> }>\n  } {\n    const valid: any[] = []\n    const invalid: Array<{ customer: any; errors: Array<{ field: string; message: string }> }> = []\n    const warnings: Array<{ customer: any; warnings: Array<{ field: string; message: string }> }> = []\n\n    customers.forEach((customer) => {\n      const result = this.validateCustomer(customer)\n\n      if (result.isValid) {\n        valid.push(customer)\n        if (result.warnings.length > 0) {\n          warnings.push({ customer, warnings: result.warnings })\n        }\n      } else {\n        invalid.push({ customer, errors: result.errors })\n      }\n    })\n\n    return { valid, invalid, warnings }\n  }\n\n  private static isValidEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    return emailRegex.test(email)\n  }\n\n  private static isValidPhone(phone: string): boolean {\n    const digits = phone.replace(/\\D/g, \"\")\n    return digits.length >= 10 && digits.length <= 11\n  }\n\n  private static isValidState(state: string): boolean {\n    const validStates = [\n      \"AL\",\n      \"AK\",\n      \"AZ\",\n      \"AR\",\n      \"CA\",\n      \"CO\",\n      \"CT\",\n      \"DE\",\n      \"FL\",\n      \"GA\",\n      \"HI\",\n      \"ID\",\n      \"IL\",\n      \"IN\",\n      \"IA\",\n      \"KS\",\n      \"KY\",\n      \"LA\",\n      \"ME\",\n      \"MD\",\n      \"MA\",\n      \"MI\",\n      \"MN\",\n      \"MS\",\n      \"MO\",\n      \"MT\",\n      \"NE\",\n      \"NV\",\n      \"NH\",\n      \"NJ\",\n      \"NM\",\n      \"NY\",\n      \"NC\",\n      \"ND\",\n      \"OH\",\n      \"OK\",\n      \"OR\",\n      \"PA\",\n      \"RI\",\n      \"SC\",\n      \"SD\",\n      \"TN\",\n      \"TX\",\n      \"UT\",\n      \"VT\",\n      \"VA\",\n      \"WA\",\n      \"WV\",\n      \"WI\",\n      \"WY\",\n    ]\n    return validStates.includes(state.toUpperCase())\n  }\n\n  private static isValidZipCode(zip: string): boolean {\n    const zipRegex = /^\\d{5}(-\\d{4})?$/\n    return zipRegex.test(zip)\n  }\n\n  private static isValidTaxId(taxId: string): boolean {\n    // EIN format: XX-XXXXXXX (9 digits)\n    // SSN format: XXX-XX-XXXX (9 digits)\n    const digits = taxId.replace(/\\D/g, \"\")\n    return digits.length === 9\n  }\n}\n","export interface DuplicateMatch {\n  original: any\n  duplicate: any\n  matchScore: number\n  matchFields: string[]\n}\n\nexport class DataDeduplicator {\n  static findDuplicates(\n    customers: any[],\n    existingCustomers: any[] = [],\n  ): {\n    unique: any[]\n    duplicates: DuplicateMatch[]\n  } {\n    const allCustomers = [...existingCustomers, ...customers]\n    const unique: any[] = []\n    const duplicates: DuplicateMatch[] = []\n    const processed = new Set<number>()\n\n    customers.forEach((customer, index) => {\n      if (processed.has(index)) return\n\n      let isDuplicate = false\n\n      // Check against existing customers\n      for (const existing of existingCustomers) {\n        const match = this.calculateMatch(customer, existing)\n        if (match.matchScore >= 0.8) {\n          duplicates.push({\n            original: existing,\n            duplicate: customer,\n            matchScore: match.matchScore,\n            matchFields: match.matchFields,\n          })\n          isDuplicate = true\n          break\n        }\n      }\n\n      // Check against other new customers\n      if (!isDuplicate) {\n        for (let i = index + 1; i < customers.length; i++) {\n          if (processed.has(i)) continue\n\n          const match = this.calculateMatch(customer, customers[i])\n          if (match.matchScore >= 0.8) {\n            duplicates.push({\n              original: customer,\n              duplicate: customers[i],\n              matchScore: match.matchScore,\n              matchFields: match.matchFields,\n            })\n            processed.add(i)\n            isDuplicate = true\n            break\n          }\n        }\n      }\n\n      if (!isDuplicate) {\n        unique.push(customer)\n      }\n    })\n\n    return { unique, duplicates }\n  }\n\n  private static calculateMatch(\n    customer1: any,\n    customer2: any,\n  ): {\n    matchScore: number\n    matchFields: string[]\n  } {\n    const matchFields: string[] = []\n    let totalScore = 0\n    let maxScore = 0\n\n    // Email match (highest weight)\n    if (customer1.email && customer2.email) {\n      maxScore += 0.4\n      if (this.normalizeString(customer1.email) === this.normalizeString(customer2.email)) {\n        totalScore += 0.4\n        matchFields.push(\"email\")\n      }\n    }\n\n    // Phone match\n    if (customer1.phone && customer2.phone) {\n      maxScore += 0.3\n      const phone1 = customer1.phone.replace(/\\D/g, \"\")\n      const phone2 = customer2.phone.replace(/\\D/g, \"\")\n      if (phone1 === phone2) {\n        totalScore += 0.3\n        matchFields.push(\"phone\")\n      }\n    }\n\n    // Name match\n    if (customer1.contact_name && customer2.contact_name) {\n      maxScore += 0.2\n      const similarity = this.calculateStringSimilarity(\n        this.normalizeString(customer1.contact_name),\n        this.normalizeString(customer2.contact_name),\n      )\n      if (similarity > 0.8) {\n        totalScore += 0.2 * similarity\n        matchFields.push(\"contact_name\")\n      }\n    }\n\n    // Company name match\n    if (customer1.company_name && customer2.company_name) {\n      maxScore += 0.1\n      const similarity = this.calculateStringSimilarity(\n        this.normalizeString(customer1.company_name),\n        this.normalizeString(customer2.company_name),\n      )\n      if (similarity > 0.8) {\n        totalScore += 0.1 * similarity\n        matchFields.push(\"company_name\")\n      }\n    }\n\n    const matchScore = maxScore > 0 ? totalScore / maxScore : 0\n\n    return { matchScore, matchFields }\n  }\n\n  private static normalizeString(str: string): string {\n    return str.toLowerCase().trim().replace(/\\s+/g, \" \")\n  }\n\n  private static calculateStringSimilarity(str1: string, str2: string): number {\n    // Levenshtein distance algorithm\n    const len1 = str1.length\n    const len2 = str2.length\n    const matrix: number[][] = []\n\n    for (let i = 0; i <= len1; i++) {\n      matrix[i] = [i]\n    }\n\n    for (let j = 0; j <= len2; j++) {\n      matrix[0][j] = j\n    }\n\n    for (let i = 1; i <= len1; i++) {\n      for (let j = 1; j <= len2; j++) {\n        const cost = str1[i - 1] === str2[j - 1] ? 0 : 1\n        matrix[i][j] = Math.min(matrix[i - 1][j] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j - 1] + cost)\n      }\n    }\n\n    const distance = matrix[len1][len2]\n    const maxLen = Math.max(len1, len2)\n    return maxLen === 0 ? 1 : 1 - distance / maxLen\n  }\n}\n","import { DataCleaner } from \"./data-cleaner\"\nimport { DataValidator } from \"./data-validator\"\nimport { DataDeduplicator } from \"./data-deduplicator\"\n\nexport interface ETLResult {\n  cleaned: any[]\n  valid: any[]\n  invalid: Array<{ customer: any; errors: Array<{ field: string; message: string }> }>\n  warnings: Array<{ customer: any; warnings: Array<{ field: string; message: string }> }>\n  duplicates: Array<{\n    original: any\n    duplicate: any\n    matchScore: number\n    matchFields: string[]\n  }>\n  unique: any[]\n  stats: {\n    totalInput: number\n    cleaned: number\n    valid: number\n    invalid: number\n    duplicates: number\n    readyForImport: number\n  }\n}\n\nexport class ETLPipeline {\n  static async process(rawData: any[], existingCustomers: any[] = []): Promise<ETLResult> {\n    // Step 1: Clean the data\n    const cleaned = DataCleaner.cleanCustomerData(rawData)\n\n    // Step 2: Validate the data\n    const { valid, invalid, warnings } = DataValidator.validateBatch(cleaned)\n\n    // Step 3: Deduplicate the data\n    const { unique, duplicates } = DataDeduplicator.findDuplicates(valid, existingCustomers)\n\n    // Calculate stats\n    const stats = {\n      totalInput: rawData.length,\n      cleaned: cleaned.length,\n      valid: valid.length,\n      invalid: invalid.length,\n      duplicates: duplicates.length,\n      readyForImport: unique.length,\n    }\n\n    return {\n      cleaned,\n      valid,\n      invalid,\n      warnings,\n      duplicates,\n      unique,\n      stats,\n    }\n  }\n}\n","export interface UploadStage {\n  name: string\n  status: \"pending\" | \"in-progress\" | \"completed\" | \"error\"\n  progress: number\n  message?: string\n  error?: string\n}\n\nexport interface UploadProgress {\n  stages: UploadStage[]\n  currentStage: number\n  overallProgress: number\n  totalRecords: number\n  processedRecords: number\n  successfulRecords: number\n  failedRecords: number\n  startTime: number\n  estimatedTimeRemaining?: number\n}\n\nexport class UploadProgressTracker {\n  private progress: UploadProgress\n  private listeners: Array<(progress: UploadProgress) => void> = []\n\n  constructor(totalRecords: number) {\n    this.progress = {\n      stages: [\n        { name: \"Parsing File\", status: \"pending\", progress: 0 },\n        { name: \"Cleaning Data\", status: \"pending\", progress: 0 },\n        { name: \"Validating Records\", status: \"pending\", progress: 0 },\n        { name: \"Checking Duplicates\", status: \"pending\", progress: 0 },\n        { name: \"Uploading to Database\", status: \"pending\", progress: 0 },\n      ],\n      currentStage: 0,\n      overallProgress: 0,\n      totalRecords,\n      processedRecords: 0,\n      successfulRecords: 0,\n      failedRecords: 0,\n      startTime: Date.now(),\n    }\n  }\n\n  subscribe(listener: (progress: UploadProgress) => void) {\n    this.listeners.push(listener)\n    return () => {\n      this.listeners = this.listeners.filter((l) => l !== listener)\n    }\n  }\n\n  private notify() {\n    this.listeners.forEach((listener) => listener({ ...this.progress }))\n  }\n\n  startStage(stageIndex: number, message?: string) {\n    this.progress.currentStage = stageIndex\n    this.progress.stages[stageIndex].status = \"in-progress\"\n    this.progress.stages[stageIndex].progress = 0\n    if (message) {\n      this.progress.stages[stageIndex].message = message\n    }\n    this.updateOverallProgress()\n    this.notify()\n  }\n\n  updateStageProgress(stageIndex: number, progress: number, message?: string) {\n    this.progress.stages[stageIndex].progress = Math.min(100, Math.max(0, progress))\n    if (message) {\n      this.progress.stages[stageIndex].message = message\n    }\n    this.updateOverallProgress()\n    this.notify()\n  }\n\n  completeStage(stageIndex: number, message?: string) {\n    this.progress.stages[stageIndex].status = \"completed\"\n    this.progress.stages[stageIndex].progress = 100\n    if (message) {\n      this.progress.stages[stageIndex].message = message\n    }\n    this.updateOverallProgress()\n    this.notify()\n  }\n\n  errorStage(stageIndex: number, error: string) {\n    this.progress.stages[stageIndex].status = \"error\"\n    this.progress.stages[stageIndex].error = error\n    this.updateOverallProgress()\n    this.notify()\n  }\n\n  updateRecordProgress(processed: number, successful: number, failed: number) {\n    this.progress.processedRecords = processed\n    this.progress.successfulRecords = successful\n    this.progress.failedRecords = failed\n    this.updateEstimatedTime()\n    this.notify()\n  }\n\n  private updateOverallProgress() {\n    const totalStages = this.progress.stages.length\n    const completedStages = this.progress.stages.filter((s) => s.status === \"completed\").length\n    const currentStageProgress = this.progress.stages[this.progress.currentStage]?.progress || 0\n\n    this.progress.overallProgress = ((completedStages + currentStageProgress / 100) / totalStages) * 100\n  }\n\n  private updateEstimatedTime() {\n    const elapsed = Date.now() - this.progress.startTime\n    const processedRecords = this.progress.processedRecords\n\n    if (processedRecords > 0) {\n      const timePerRecord = elapsed / processedRecords\n      const remainingRecords = this.progress.totalRecords - processedRecords\n      this.progress.estimatedTimeRemaining = Math.ceil(timePerRecord * remainingRecords)\n    }\n  }\n\n  getProgress(): UploadProgress {\n    return { ...this.progress }\n  }\n}\n","\"use client\"\n\nimport { Card } from \"@/components/ui/card\"\nimport { Progress } from \"@/components/ui/progress\"\nimport { CheckCircle, Circle, Loader2, XCircle, Clock } from 'lucide-react'\nimport type { UploadProgress } from \"@/lib/upload-progress-tracker\"\n\ninterface UploadProgressDisplayProps {\n  progress: UploadProgress\n}\n\nexport function UploadProgressDisplay({ progress }: UploadProgressDisplayProps) {\n  const formatTime = (ms: number) => {\n    const seconds = Math.floor(ms / 1000)\n    if (seconds < 60) return `${seconds}s`\n    const minutes = Math.floor(seconds / 60)\n    const remainingSeconds = seconds % 60\n    return `${minutes}m ${remainingSeconds}s`\n  }\n\n  const getStageIcon = (status: string) => {\n    switch (status) {\n      case \"completed\":\n        return <CheckCircle className=\"h-5 w-5 text-green-500\" />\n      case \"in-progress\":\n        return <Loader2 className=\"h-5 w-5 text-blue-500 animate-spin\" />\n      case \"error\":\n        return <XCircle className=\"h-5 w-5 text-red-500\" />\n      default:\n        return <Circle className=\"h-5 w-5 text-muted-foreground\" />\n    }\n  }\n\n  return (\n    <Card className=\"p-6 border-border\">\n      {/* Overall Progress */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <h3 className=\"text-lg font-semibold text-foreground\">Upload Progress</h3>\n          <span className=\"text-sm font-medium text-muted-foreground\">\n            {Math.round(progress.overallProgress)}%\n          </span>\n        </div>\n        <Progress value={progress.overallProgress} className=\"h-3\" />\n        {progress.estimatedTimeRemaining && (\n          <div className=\"flex items-center gap-2 mt-2 text-sm text-muted-foreground\">\n            <Clock className=\"h-4 w-4\" />\n            <span>Estimated time remaining: {formatTime(progress.estimatedTimeRemaining)}</span>\n          </div>\n        )}\n      </div>\n\n      {/* Stages */}\n      <div className=\"space-y-4 mb-6\">\n        {progress.stages.map((stage, index) => (\n          <div key={index} className=\"space-y-2\">\n            <div className=\"flex items-center gap-3\">\n              {getStageIcon(stage.status)}\n              <div className=\"flex-1\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm font-medium text-foreground\">{stage.name}</span>\n                  {stage.status === \"in-progress\" && (\n                    <span className=\"text-xs text-muted-foreground\">{Math.round(stage.progress)}%</span>\n                  )}\n                </div>\n                {stage.message && <p className=\"text-xs text-muted-foreground mt-1\">{stage.message}</p>}\n                {stage.error && <p className=\"text-xs text-red-500 mt-1\">{stage.error}</p>}\n              </div>\n            </div>\n            {stage.status === \"in-progress\" && (\n              <Progress value={stage.progress} className=\"h-1.5 ml-8\" />\n            )}\n          </div>\n        ))}\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-4 gap-4 pt-4 border-t border-border\">\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-foreground\">{progress.totalRecords}</p>\n          <p className=\"text-xs text-muted-foreground\">Total</p>\n        </div>\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-blue-500\">{progress.processedRecords}</p>\n          <p className=\"text-xs text-muted-foreground\">Processed</p>\n        </div>\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-green-500\">{progress.successfulRecords}</p>\n          <p className=\"text-xs text-muted-foreground\">Success</p>\n        </div>\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-red-500\">{progress.failedRecords}</p>\n          <p className=\"text-xs text-muted-foreground\">Failed</p>\n        </div>\n      </div>\n    </Card>\n  )\n}\n","\"use client\"\n\nimport { useState } from \"react\"\nimport { Card } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\nimport { AlertCircle, CheckCircle, Search, Filter, ChevronLeft, ChevronRight } from \"lucide-react\"\n\ninterface DataPreviewTableProps {\n  data: any[]\n  errors?: Array<{ customer: any; errors: Array<{ field: string; message: string }> }>\n  warnings?: Array<{ customer: any; warnings: Array<{ field: string; message: string }> }>\n  duplicates?: Array<{ original: any; duplicate: any; matchScore: number; matchFields: string[] }>\n  onEdit?: (index: number, field: string, value: any) => void\n  onRemove?: (index: number) => void\n}\n\nexport function DataPreviewTable({\n  data,\n  errors = [],\n  warnings = [],\n  duplicates = [],\n  onEdit,\n  onRemove,\n}: DataPreviewTableProps) {\n  const [searchQuery, setSearchQuery] = useState(\"\")\n  const [filterType, setFilterType] = useState<\"all\" | \"valid\" | \"errors\" | \"warnings\" | \"duplicates\">(\"all\")\n  const [currentPage, setCurrentPage] = useState(1)\n  const itemsPerPage = 10\n\n  const getRecordStatus = (record: any) => {\n    const hasError = errors.some((e) => e.customer === record)\n    const hasWarning = warnings.some((w) => w.customer === record)\n    const isDuplicate = duplicates.some((d) => d.duplicate === record)\n\n    if (hasError) return \"error\"\n    if (isDuplicate) return \"duplicate\"\n    if (hasWarning) return \"warning\"\n    return \"valid\"\n  }\n\n  const getRecordIssues = (record: any) => {\n    const error = errors.find((e) => e.customer === record)\n    const warning = warnings.find((w) => w.customer === record)\n    const duplicate = duplicates.find((d) => d.duplicate === record)\n\n    return {\n      errors: error?.errors || [],\n      warnings: warning?.warnings || [],\n      duplicate,\n    }\n  }\n\n  const filteredData = data.filter((record) => {\n    const status = getRecordStatus(record)\n    const matchesFilter =\n      filterType === \"all\" ||\n      (filterType === \"valid\" && status === \"valid\") ||\n      (filterType === \"errors\" && status === \"error\") ||\n      (filterType === \"warnings\" && status === \"warning\") ||\n      (filterType === \"duplicates\" && status === \"duplicate\")\n\n    const matchesSearch =\n      !searchQuery ||\n      Object.values(record).some((value) => String(value).toLowerCase().includes(searchQuery.toLowerCase()))\n\n    return matchesFilter && matchesSearch\n  })\n\n  const totalPages = Math.ceil(filteredData.length / itemsPerPage)\n  const paginatedData = filteredData.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage)\n\n  const statusCounts = {\n    all: data.length,\n    valid: data.filter((r) => getRecordStatus(r) === \"valid\").length,\n    errors: errors.length,\n    warnings: warnings.length,\n    duplicates: duplicates.length,\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Filters */}\n      <Card className=\"p-4 border-border\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search records...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n          <Select value={filterType} onValueChange={(value: any) => setFilterType(value)}>\n            <SelectTrigger className=\"w-48\">\n              <Filter className=\"h-4 w-4 mr-2\" />\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All ({statusCounts.all})</SelectItem>\n              <SelectItem value=\"valid\">Valid ({statusCounts.valid})</SelectItem>\n              <SelectItem value=\"errors\">Errors ({statusCounts.errors})</SelectItem>\n              <SelectItem value=\"warnings\">Warnings ({statusCounts.warnings})</SelectItem>\n              <SelectItem value=\"duplicates\">Duplicates ({statusCounts.duplicates})</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n      </Card>\n\n      {/* Table */}\n      <Card className=\"border-border overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead className=\"w-12\">Status</TableHead>\n                <TableHead>Contact Name</TableHead>\n                <TableHead>Company</TableHead>\n                <TableHead>Email</TableHead>\n                <TableHead>Phone</TableHead>\n                <TableHead>City</TableHead>\n                <TableHead>State</TableHead>\n                <TableHead className=\"w-24\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {paginatedData.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\n                    No records found\n                  </TableCell>\n                </TableRow>\n              ) : (\n                paginatedData.map((record, index) => {\n                  const status = getRecordStatus(record)\n                  const issues = getRecordIssues(record)\n                  const actualIndex = (currentPage - 1) * itemsPerPage + index\n\n                  return (\n                    <TableRow key={actualIndex} className={status === \"error\" ? \"bg-red-500/5\" : \"\"}>\n                      <TableCell>\n                        {status === \"valid\" && <CheckCircle className=\"h-5 w-5 text-green-500\" />}\n                        {status === \"error\" && <AlertCircle className=\"h-5 w-5 text-red-500\" />}\n                        {status === \"warning\" && <AlertCircle className=\"h-5 w-5 text-yellow-500\" />}\n                        {status === \"duplicate\" && <AlertCircle className=\"h-5 w-5 text-orange-500\" />}\n                      </TableCell>\n                      <TableCell>\n                        <div>\n                          <p className=\"font-medium text-foreground\">{record.contact_name}</p>\n                          {issues.errors.some((e) => e.field === \"contact_name\") && (\n                            <p className=\"text-xs text-red-500 mt-1\">\n                              {issues.errors.find((e) => e.field === \"contact_name\")?.message}\n                            </p>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <p className=\"text-sm text-muted-foreground\">{record.company_name || \"-\"}</p>\n                      </TableCell>\n                      <TableCell>\n                        <div>\n                          <p className=\"text-sm text-muted-foreground\">{record.email || \"-\"}</p>\n                          {issues.errors.some((e) => e.field === \"email\") && (\n                            <p className=\"text-xs text-red-500 mt-1\">\n                              {issues.errors.find((e) => e.field === \"email\")?.message}\n                            </p>\n                          )}\n                          {issues.warnings.some((w) => w.field === \"email\") && (\n                            <p className=\"text-xs text-yellow-500 mt-1\">\n                              {issues.warnings.find((w) => w.field === \"email\")?.message}\n                            </p>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <p className=\"text-sm text-muted-foreground\">{record.phone || \"-\"}</p>\n                      </TableCell>\n                      <TableCell>\n                        <p className=\"text-sm text-muted-foreground\">{record.city || \"-\"}</p>\n                      </TableCell>\n                      <TableCell>\n                        <p className=\"text-sm text-muted-foreground\">{record.state || \"-\"}</p>\n                      </TableCell>\n                      <TableCell>\n                        {onRemove && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => onRemove(actualIndex)}\n                            className=\"text-red-500 hover:text-red-600\"\n                          >\n                            Remove\n                          </Button>\n                        )}\n                      </TableCell>\n                    </TableRow>\n                  )\n                })\n              )}\n            </TableBody>\n          </Table>\n        </div>\n\n        {/* Pagination */}\n        {totalPages > 1 && (\n          <div className=\"flex items-center justify-between px-6 py-4 border-t border-border\">\n            <p className=\"text-sm text-muted-foreground\">\n              Showing {(currentPage - 1) * itemsPerPage + 1} to{\" \"}\n              {Math.min(currentPage * itemsPerPage, filteredData.length)} of {filteredData.length} records\n            </p>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setCurrentPage((p) => Math.max(1, p - 1))}\n                disabled={currentPage === 1}\n              >\n                <ChevronLeft className=\"h-4 w-4\" />\n              </Button>\n              <span className=\"text-sm text-muted-foreground\">\n                Page {currentPage} of {totalPages}\n              </span>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))}\n                disabled={currentPage === totalPages}\n              >\n                <ChevronRight className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n        )}\n      </Card>\n    </div>\n  )\n}\n","\"use client\"\n\nimport { useState } from \"react\"\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\"\nimport { Button } from \"@/components/ui/button\"\nimport { Label } from \"@/components/ui/label\"\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\nimport { Card } from \"@/components/ui/card\"\nimport { ArrowRight, CheckCircle } from \"lucide-react\"\n\ninterface ColumnMappingDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  sourceColumns: string[]\n  onConfirm: (mapping: Record<string, string>) => void\n}\n\nconst targetFields = [\n  { value: \"contact_name\", label: \"Contact Name\", required: true },\n  { value: \"company_name\", label: \"Company Name\", required: false },\n  { value: \"email\", label: \"Email\", required: false },\n  { value: \"phone\", label: \"Phone\", required: false },\n  { value: \"address_line1\", label: \"Address Line 1\", required: false },\n  { value: \"address_line2\", label: \"Address Line 2\", required: false },\n  { value: \"city\", label: \"City\", required: false },\n  { value: \"state\", label: \"State\", required: false },\n  { value: \"zip_code\", label: \"Zip Code\", required: false },\n  { value: \"country\", label: \"Country\", required: false },\n  { value: \"tax_id\", label: \"Tax ID\", required: false },\n  { value: \"notes\", label: \"Notes\", required: false },\n]\n\nexport function ColumnMappingDialog({ open, onOpenChange, sourceColumns, onConfirm }: ColumnMappingDialogProps) {\n  const [mapping, setMapping] = useState<Record<string, string>>({})\n\n  const handleMappingChange = (targetField: string, sourceColumn: string) => {\n    setMapping((prev) => ({\n      ...prev,\n      [targetField]: sourceColumn,\n    }))\n  }\n\n  const handleConfirm = () => {\n    onConfirm(mapping)\n    onOpenChange(false)\n  }\n\n  const isValid = targetFields.filter((f) => f.required).every((f) => mapping[f.value] && mapping[f.value] !== \"skip\")\n\n  const getMappedCount = () => {\n    return Object.values(mapping).filter((v) => v && v !== \"skip\").length\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Map Columns</DialogTitle>\n          <DialogDescription>\n            Map your file columns to the customer fields. Required fields are marked with an asterisk.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* Progress */}\n          <Card className=\"p-4 border-border bg-accent/5\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-foreground\">Mapping Progress</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  {getMappedCount()} of {targetFields.length} fields mapped\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                <span className=\"text-sm font-medium text-foreground\">\n                  {Math.round((getMappedCount() / targetFields.length) * 100)}%\n                </span>\n              </div>\n            </div>\n          </Card>\n\n          {/* Mapping Grid */}\n          <div className=\"space-y-3\">\n            {targetFields.map((field) => (\n              <div key={field.value} className=\"flex items-center gap-4 p-4 border border-border rounded-lg\">\n                <div className=\"flex-1\">\n                  <Label className=\"text-sm font-medium text-foreground\">\n                    {field.label}\n                    {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n                  </Label>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {field.required ? \"Required field\" : \"Optional field\"}\n                  </p>\n                </div>\n\n                <ArrowRight className=\"h-5 w-5 text-muted-foreground\" />\n\n                <div className=\"flex-1\">\n                  <Select\n                    value={mapping[field.value] || \"\"}\n                    onValueChange={(value) => handleMappingChange(field.value, value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select column...\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"skip\">Skip this field</SelectItem>\n                      {sourceColumns.map((column) => (\n                        <SelectItem key={column} value={column}>\n                          {column}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex items-center justify-end gap-3 pt-4 border-t border-border\">\n            <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleConfirm} disabled={!isValid}>\n              Confirm Mapping\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}