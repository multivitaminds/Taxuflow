{"version":3,"sources":["../../../../components/risk/customer-risk-hub.tsx","../../../../lib/ml/customer-risk-analyzer.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Card } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\nimport {\n  Search,\n  TrendingUp,\n  TrendingDown,\n  AlertTriangle,\n  Users,\n  Calendar,\n  Target,\n  Activity,\n  XCircle,\n  Mail,\n} from \"lucide-react\"\nimport { CustomerRiskAnalyzer } from \"@/lib/ml/customer-risk-analyzer\"\n\nexport function CustomerRiskHub() {\n  const [customers, setCustomers] = useState<any[]>([])\n  const [riskProfiles, setRiskProfiles] = useState<Map<string, any>>(new Map())\n  const [searchQuery, setSearchQuery] = useState(\"\")\n  const [filterRisk, setFilterRisk] = useState<\"all\" | \"low\" | \"medium\" | \"high\" | \"critical\">(\"all\")\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    loadCustomerRiskData()\n  }, [])\n\n  async function loadCustomerRiskData() {\n    try {\n      const response = await fetch(\"/api/accounting/customers\")\n      const data = await response.json()\n\n      if (data.customers) {\n        setCustomers(data.customers)\n\n        // Calculate risk profiles for each customer\n        const analyzer = new CustomerRiskAnalyzer()\n        const profiles = new Map()\n\n        for (const customer of data.customers) {\n          const profile = await analyzer.analyzeCustomerRisk(customer)\n          profiles.set(customer.id, profile)\n        }\n\n        setRiskProfiles(profiles)\n      }\n    } catch (error) {\n      console.error(\"Error loading customer risk data:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getRiskColor = (score: number) => {\n    if (score >= 80) return \"text-emerald-500 bg-emerald-500/10\"\n    if (score >= 60) return \"text-blue-500 bg-blue-500/10\"\n    if (score >= 40) return \"text-amber-500 bg-amber-500/10\"\n    return \"text-red-500 bg-red-500/10\"\n  }\n\n  const getRiskLevel = (score: number) => {\n    if (score >= 80) return \"low\"\n    if (score >= 60) return \"medium\"\n    if (score >= 40) return \"high\"\n    return \"critical\"\n  }\n\n  const filteredCustomers = customers.filter((customer) => {\n    const profile = riskProfiles.get(customer.id)\n    const matchesSearch =\n      customer.company_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      customer.contact_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      customer.email?.toLowerCase().includes(searchQuery.toLowerCase())\n\n    const matchesFilter = filterRisk === \"all\" || (profile && getRiskLevel(profile.creditScore) === filterRisk)\n\n    return matchesSearch && matchesFilter\n  })\n\n  const stats = {\n    totalCustomers: customers.length,\n    lowRisk: Array.from(riskProfiles.values()).filter((p) => p.creditScore >= 80).length,\n    mediumRisk: Array.from(riskProfiles.values()).filter((p) => p.creditScore >= 60 && p.creditScore < 80).length,\n    highRisk: Array.from(riskProfiles.values()).filter((p) => p.creditScore >= 40 && p.creditScore < 60).length,\n    criticalRisk: Array.from(riskProfiles.values()).filter((p) => p.creditScore < 40).length,\n    totalAtRisk: Array.from(riskProfiles.values())\n      .filter((p) => p.creditScore < 60)\n      .reduce((sum, p) => sum + (p.outstandingBalance || 0), 0),\n    avgCreditScore:\n      Array.from(riskProfiles.values()).reduce((sum, p) => sum + p.creditScore, 0) / riskProfiles.size || 0,\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950\">\n      {/* Header */}\n      <div className=\"border-b border-slate-800 bg-slate-900/50 backdrop-blur-xl\">\n        <div className=\"container mx-auto px-6 py-8\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <div>\n              <h1 className=\"text-4xl font-bold text-white mb-2 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent\">\n                Predictive Customer Risk\n              </h1>\n              <p className=\"text-slate-400\">AI-powered credit scoring and collection optimization</p>\n            </div>\n            <Button className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\">\n              <Target className=\"h-4 w-4 mr-2\" />\n              Run Risk Analysis\n            </Button>\n          </div>\n\n          {/* Stats Cards */}\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl hover:bg-slate-800/70 transition-all\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2 bg-emerald-500/10 rounded-lg\">\n                  <Users className=\"h-6 w-6 text-emerald-500\" />\n                </div>\n                <Badge className=\"bg-emerald-500/10 text-emerald-400 border-emerald-500/20\">\n                  {stats.lowRisk} Low Risk\n                </Badge>\n              </div>\n              <p className=\"text-3xl font-bold text-white mb-1\">{stats.totalCustomers}</p>\n              <p className=\"text-sm text-slate-400\">Total Customers</p>\n            </Card>\n\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl hover:bg-slate-800/70 transition-all\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2 bg-blue-500/10 rounded-lg\">\n                  <Activity className=\"h-6 w-6 text-blue-500\" />\n                </div>\n                <TrendingUp className=\"h-5 w-5 text-emerald-500\" />\n              </div>\n              <p className=\"text-3xl font-bold text-white mb-1\">{Math.round(stats.avgCreditScore)}</p>\n              <p className=\"text-sm text-slate-400\">Avg Credit Score</p>\n            </Card>\n\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl hover:bg-slate-800/70 transition-all\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2 bg-amber-500/10 rounded-lg\">\n                  <AlertTriangle className=\"h-6 w-6 text-amber-500\" />\n                </div>\n                <Badge className=\"bg-amber-500/10 text-amber-400 border-amber-500/20\">\n                  {stats.highRisk + stats.criticalRisk} At Risk\n                </Badge>\n              </div>\n              <p className=\"text-3xl font-bold text-white mb-1\">${stats.totalAtRisk.toLocaleString()}</p>\n              <p className=\"text-sm text-slate-400\">At Risk Amount</p>\n            </Card>\n\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl hover:bg-slate-800/70 transition-all\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2 bg-red-500/10 rounded-lg\">\n                  <XCircle className=\"h-6 w-6 text-red-500\" />\n                </div>\n                <TrendingDown className=\"h-5 w-5 text-red-500\" />\n              </div>\n              <p className=\"text-3xl font-bold text-white mb-1\">{stats.criticalRisk}</p>\n              <p className=\"text-sm text-slate-400\">Critical Risk</p>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"container mx-auto px-6 py-8\">\n        <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n          <TabsList className=\"bg-slate-800/50 border-slate-700\">\n            <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n            <TabsTrigger value=\"scoring\">Credit Scoring</TabsTrigger>\n            <TabsTrigger value=\"predictions\">Payment Predictions</TabsTrigger>\n            <TabsTrigger value=\"collections\">Collection Priority</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            {/* Search and Filters */}\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl\">\n              <div className=\"flex flex-col sm:flex-row gap-4\">\n                <div className=\"relative flex-1\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400\" />\n                  <Input\n                    placeholder=\"Search customers...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"pl-10 bg-slate-900/50 border-slate-700 text-white\"\n                  />\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant={filterRisk === \"all\" ? \"default\" : \"outline\"}\n                    onClick={() => setFilterRisk(\"all\")}\n                    size=\"sm\"\n                    className={filterRisk === \"all\" ? \"bg-blue-600\" : \"bg-slate-900/50 border-slate-700\"}\n                  >\n                    All ({stats.totalCustomers})\n                  </Button>\n                  <Button\n                    variant={filterRisk === \"low\" ? \"default\" : \"outline\"}\n                    onClick={() => setFilterRisk(\"low\")}\n                    size=\"sm\"\n                    className={filterRisk === \"low\" ? \"bg-emerald-600\" : \"bg-slate-900/50 border-slate-700\"}\n                  >\n                    Low ({stats.lowRisk})\n                  </Button>\n                  <Button\n                    variant={filterRisk === \"medium\" ? \"default\" : \"outline\"}\n                    onClick={() => setFilterRisk(\"medium\")}\n                    size=\"sm\"\n                    className={filterRisk === \"medium\" ? \"bg-blue-600\" : \"bg-slate-900/50 border-slate-700\"}\n                  >\n                    Medium ({stats.mediumRisk})\n                  </Button>\n                  <Button\n                    variant={filterRisk === \"high\" ? \"default\" : \"outline\"}\n                    onClick={() => setFilterRisk(\"high\")}\n                    size=\"sm\"\n                    className={filterRisk === \"high\" ? \"bg-amber-600\" : \"bg-slate-900/50 border-slate-700\"}\n                  >\n                    High ({stats.highRisk})\n                  </Button>\n                  <Button\n                    variant={filterRisk === \"critical\" ? \"default\" : \"outline\"}\n                    onClick={() => setFilterRisk(\"critical\")}\n                    size=\"sm\"\n                    className={filterRisk === \"critical\" ? \"bg-red-600\" : \"bg-slate-900/50 border-slate-700\"}\n                  >\n                    Critical ({stats.criticalRisk})\n                  </Button>\n                </div>\n              </div>\n            </Card>\n\n            {/* Customer Risk Cards */}\n            {loading ? (\n              <div className=\"text-center py-12 text-slate-400\">Loading customer risk profiles...</div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredCustomers.map((customer) => {\n                  const profile = riskProfiles.get(customer.id) || {}\n                  const riskLevel = getRiskLevel(profile.creditScore || 0)\n\n                  return (\n                    <Card\n                      key={customer.id}\n                      className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl hover:bg-slate-800/70 transition-all\"\n                    >\n                      <div className=\"space-y-4\">\n                        {/* Header */}\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex items-start gap-3 flex-1\">\n                            <div className=\"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg\">\n                              {(customer.company_name || customer.contact_name || \"?\")[0].toUpperCase()}\n                            </div>\n                            <div className=\"flex-1\">\n                              <h3 className=\"font-semibold text-white mb-1\">\n                                {customer.company_name || customer.contact_name || \"Unknown Customer\"}\n                              </h3>\n                              <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n                                {customer.email && (\n                                  <>\n                                    <Mail className=\"h-3 w-3\" />\n                                    <span className=\"truncate\">{customer.email}</span>\n                                  </>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                          <Badge\n                            className={`${getRiskColor(profile.creditScore || 0)} border-0 font-semibold uppercase text-xs`}\n                          >\n                            {riskLevel}\n                          </Badge>\n                        </div>\n\n                        {/* Credit Score Gauge */}\n                        <div className=\"relative\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <span className=\"text-sm text-slate-400\">Credit Score</span>\n                            <span className=\"text-2xl font-bold text-white\">{profile.creditScore || 0}</span>\n                          </div>\n                          <div className=\"h-3 bg-slate-900/50 rounded-full overflow-hidden\">\n                            <div\n                              className={`h-full rounded-full transition-all ${\n                                profile.creditScore >= 80\n                                  ? \"bg-gradient-to-r from-emerald-500 to-emerald-400\"\n                                  : profile.creditScore >= 60\n                                    ? \"bg-gradient-to-r from-blue-500 to-blue-400\"\n                                    : profile.creditScore >= 40\n                                      ? \"bg-gradient-to-r from-amber-500 to-amber-400\"\n                                      : \"bg-gradient-to-r from-red-500 to-red-400\"\n                              }`}\n                              style={{ width: `${profile.creditScore || 0}%` }}\n                            />\n                          </div>\n                        </div>\n\n                        {/* Risk Metrics */}\n                        <div className=\"grid grid-cols-2 gap-4 pt-4 border-t border-slate-700\">\n                          <div>\n                            <p className=\"text-xs text-slate-500 mb-1\">Default Risk</p>\n                            <p className=\"text-lg font-semibold text-white\">\n                              {profile.defaultProbability ? `${Math.round(profile.defaultProbability)}%` : \"N/A\"}\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-slate-500 mb-1\">Collection Priority</p>\n                            <p className=\"text-lg font-semibold text-white\">{profile.collectionPriority || \"N/A\"}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-slate-500 mb-1\">Outstanding</p>\n                            <p className=\"text-lg font-semibold text-white\">\n                              ${(profile.outstandingBalance || 0).toLocaleString()}\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-slate-500 mb-1\">Avg Days Late</p>\n                            <p className=\"text-lg font-semibold text-white\">{profile.avgDaysLate || 0}</p>\n                          </div>\n                        </div>\n\n                        {/* Actions */}\n                        <div className=\"flex gap-2 pt-4 border-t border-slate-700\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"flex-1 bg-slate-900/50 border-slate-700 text-white hover:bg-slate-900\"\n                          >\n                            <Mail className=\"h-4 w-4 mr-2\" />\n                            Send Reminder\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"flex-1 bg-slate-900/50 border-slate-700 text-white hover:bg-slate-900\"\n                          >\n                            <Calendar className=\"h-4 w-4 mr-2\" />\n                            Schedule Call\n                          </Button>\n                        </div>\n                      </div>\n                    </Card>\n                  )\n                })}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"scoring\">\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl\">\n              <p className=\"text-slate-400\">Credit scoring analytics coming soon...</p>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"predictions\">\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl\">\n              <p className=\"text-slate-400\">Payment prediction models coming soon...</p>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"collections\">\n            <Card className=\"p-6 bg-slate-800/50 border-slate-700 backdrop-blur-xl\">\n              <p className=\"text-slate-400\">Collection priority optimization coming soon...</p>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  )\n}\n","export class CustomerRiskAnalyzer {\n  async analyzeCustomerRisk(customer: any) {\n    const creditScore = this.calculateCreditScore(customer)\n    const defaultProbability = this.predictDefaultProbability(customer)\n    const collectionPriority = this.determineCollectionPriority(customer, creditScore, defaultProbability)\n\n    return {\n      creditScore,\n      defaultProbability,\n      collectionPriority,\n      outstandingBalance: customer.outstanding_balance || 0,\n      avgDaysLate: this.calculateAvgDaysLate(customer),\n      paymentHistory: this.analyzePaymentHistory(customer),\n      riskFactors: this.identifyRiskFactors(customer),\n    }\n  }\n\n  private calculateCreditScore(customer: any): number {\n    let score = 100\n\n    // Payment history (40% weight)\n    const outstandingBalance = customer.outstanding_balance || 0\n    const totalRevenue = customer.total_revenue || 1\n    const balanceRatio = outstandingBalance / totalRevenue\n\n    if (balanceRatio > 0.5) score -= 30\n    else if (balanceRatio > 0.3) score -= 20\n    else if (balanceRatio > 0.1) score -= 10\n\n    // Invoice count and age (30% weight)\n    const invoiceCount = customer.invoice_count || 0\n    if (invoiceCount === 0) score -= 20\n    else if (invoiceCount < 3) score -= 10\n\n    // Customer tenure (20% weight)\n    const accountAge = this.getAccountAgeDays(customer.created_at)\n    if (accountAge < 30) score -= 15\n    else if (accountAge < 90) score -= 10\n    else if (accountAge < 180) score -= 5\n\n    // Recent activity (10% weight)\n    if (!customer.email) score -= 5\n    if (!customer.phone) score -= 5\n\n    return Math.max(0, Math.min(100, score))\n  }\n\n  private predictDefaultProbability(customer: any): number {\n    const outstandingBalance = customer.outstanding_balance || 0\n    const totalRevenue = customer.total_revenue || 1\n    const balanceRatio = outstandingBalance / totalRevenue\n\n    let probability = 5 // Base 5% default risk\n\n    if (balanceRatio > 0.8) probability += 60\n    else if (balanceRatio > 0.6) probability += 40\n    else if (balanceRatio > 0.4) probability += 25\n    else if (balanceRatio > 0.2) probability += 10\n\n    const invoiceCount = customer.invoice_count || 0\n    if (invoiceCount === 0) probability += 20\n    else if (invoiceCount < 3) probability += 10\n\n    return Math.min(95, probability)\n  }\n\n  private determineCollectionPriority(customer: any, creditScore: number, defaultProbability: number): number {\n    const outstandingBalance = customer.outstanding_balance || 0\n\n    if (outstandingBalance === 0) return 1\n\n    let priority = 5\n\n    // High default risk increases priority\n    if (defaultProbability > 70) priority += 4\n    else if (defaultProbability > 50) priority += 3\n    else if (defaultProbability > 30) priority += 2\n\n    // Low credit score increases priority\n    if (creditScore < 40) priority += 2\n    else if (creditScore < 60) priority += 1\n\n    // High outstanding balance increases priority\n    if (outstandingBalance > 50000) priority += 2\n    else if (outstandingBalance > 20000) priority += 1\n\n    return Math.min(10, priority)\n  }\n\n  private calculateAvgDaysLate(customer: any): number {\n    // Mock calculation - would query actual invoice data\n    const outstandingBalance = customer.outstanding_balance || 0\n    if (outstandingBalance === 0) return 0\n\n    // Estimate based on balance ratio\n    const totalRevenue = customer.total_revenue || 1\n    const balanceRatio = outstandingBalance / totalRevenue\n\n    if (balanceRatio > 0.5) return 45\n    if (balanceRatio > 0.3) return 30\n    if (balanceRatio > 0.1) return 15\n    return 5\n  }\n\n  private analyzePaymentHistory(customer: any) {\n    // Mock payment history analysis\n    return {\n      onTimePayments: 0,\n      latePayments: 0,\n      totalPayments: 0,\n      onTimeRate: 0,\n    }\n  }\n\n  private identifyRiskFactors(customer: any): string[] {\n    const factors: string[] = []\n\n    if ((customer.outstanding_balance || 0) > 10000) {\n      factors.push(\"High outstanding balance\")\n    }\n\n    if (!(customer.invoice_count || 0)) {\n      factors.push(\"No invoice history\")\n    }\n\n    if (!customer.email) {\n      factors.push(\"Missing contact information\")\n    }\n\n    return factors\n  }\n\n  private getAccountAgeDays(createdAt: string): number {\n    if (!createdAt) return 0\n    const created = new Date(createdAt)\n    const now = new Date()\n    const diffMs = now.getTime() - created.getTime()\n    return Math.floor(diffMs / (1000 * 60 * 60 * 24))\n  }\n}\n"],"names":[],"mappings":"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"}