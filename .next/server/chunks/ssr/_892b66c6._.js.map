{"version":3,"sources":["../../../../app/actions/neobank/create-transfer.ts","../../../../app/actions/neobank/create-transaction.ts","../../../../.next-internal/server/app/neobank/international/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["\"use server\"\n\nimport { createClient } from \"@/lib/supabase/server\"\nimport { createNeobankTransaction } from \"./create-transaction\"\n\nexport async function createNeobankTransfer(data: {\n  fromAccountId?: string\n  toAccountId?: string\n  externalAccountId?: string\n  amount: number\n  transferType: \"internal\" | \"ach\" | \"wire\" | \"p2p\"\n  scheduledDate?: Date\n  memo?: string\n}) {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  if (!user) {\n    return { data: null, error: \"Not authenticated\" }\n  }\n\n  // Create transfer record\n  const { data: transfer, error } = await supabase\n    .from(\"neobank_transfers\")\n    .insert([\n      {\n        user_id: user.id,\n        from_account_id: data.fromAccountId,\n        to_account_id: data.toAccountId,\n        external_account_id: data.externalAccountId,\n        amount: data.amount,\n        transfer_type: data.transferType,\n        status: data.scheduledDate ? \"scheduled\" : \"completed\",\n        scheduled_date: data.scheduledDate || new Date(),\n        completed_date: data.scheduledDate ? null : new Date().toISOString(),\n        currency: \"USD\",\n        memo: data.memo,\n        reference_number: `TXF${Date.now()}${Math.floor(Math.random() * 1000)}`,\n      },\n    ])\n    .select()\n    .single()\n\n  if (error) {\n    console.error(\"[v0] Error creating transfer:\", error)\n    return { data: null, error: error.message }\n  }\n\n  // Create transaction records for immediate transfers\n  if (!data.scheduledDate && data.fromAccountId) {\n    await createNeobankTransaction({\n      accountId: data.fromAccountId,\n      amount: data.amount,\n      description: `Transfer to ${data.toAccountId ? \"account\" : \"external\"}`,\n      transactionType: \"debit\",\n      merchantName: \"Internal Transfer\",\n      memo: data.memo,\n    })\n\n    if (data.toAccountId) {\n      await createNeobankTransaction({\n        accountId: data.toAccountId,\n        amount: data.amount,\n        description: \"Transfer received\",\n        transactionType: \"credit\",\n        merchantName: \"Internal Transfer\",\n        memo: data.memo,\n      })\n    }\n  }\n\n  console.log(\"[v0] Created transfer:\", transfer.id, data.amount)\n  return { data: transfer, error: null }\n}\n","\"use server\"\n\nimport { createClient } from \"@/lib/supabase/server\"\n\nexport async function createNeobankTransaction(data: {\n  accountId: string\n  amount: number\n  description: string\n  transactionType: \"debit\" | \"credit\"\n  merchantName?: string\n  merchantCategoryCode?: string\n  currency?: string\n  memo?: string\n}) {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  if (!user) {\n    return { data: null, error: \"Not authenticated\" }\n  }\n\n  const { data: transaction, error } = await supabase\n    .from(\"neobank_transactions\")\n    .insert([\n      {\n        account_id: data.accountId,\n        amount: data.amount,\n        description: data.description,\n        transaction_type: data.transactionType,\n        merchant_name: data.merchantName || data.description,\n        merchant_category_code: data.merchantCategoryCode || \"general\",\n        currency: data.currency || \"USD\",\n        status: \"completed\",\n        transaction_date: new Date().toISOString(),\n        posted_date: new Date().toISOString(),\n        metadata: data.memo ? { memo: data.memo } : {},\n      },\n    ])\n    .select()\n    .single()\n\n  if (error) {\n    console.error(\"[v0] Error creating transaction:\", error)\n    return { data: null, error: error.message }\n  }\n\n  // Update account balance\n  const balanceChange = data.transactionType === \"credit\" ? data.amount : -data.amount\n  await supabase.rpc(\"update_account_balance\", {\n    account_id: data.accountId,\n    amount_change: balanceChange,\n  })\n\n  console.log(\"[v0] Created transaction:\", transaction.id, data.amount)\n  return { data: transaction, error: null }\n}\n","export {getUserProfile as '40d983bdc873a2f33f08198e581ae6b3a6175ca29e'} from 'ACTIONS_MODULE0'\nexport {getUser as '00b4e5982374ff027d3c9db80af0059fe8abad476a'} from 'ACTIONS_MODULE1'\nexport {createNeobankTransfer as '4090f52813cb329dd4176f7de7aee0d6c4488b0fe5'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,qBCEO,eAAe,EAAyB,CAS9C,EACC,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,CACJ,KAAM,MAAE,CAAI,CAAE,CACf,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,GAE/B,GAAI,CAAC,EACH,IADS,EACF,CAAE,KAAM,KAAM,MAAO,mBAAoB,EAGlD,GAAM,CAAE,KAAM,CAAW,OAAE,CAAK,CAAE,CAAG,MAAM,EACxC,IAAI,CAAC,wBACL,MAAM,CAAC,CACN,CACE,WAAY,EAAK,SAAS,CAC1B,OAAQ,EAAK,MAAM,CACnB,YAAa,EAAK,WAAW,CAC7B,iBAAkB,EAAK,eAAe,CACtC,cAAe,EAAK,YAAY,EAAI,EAAK,WAAW,CACpD,uBAAwB,EAAK,oBAAoB,EAAI,UACrD,SAAU,EAAK,QAAQ,EAAI,MAC3B,OAAQ,YACR,iBAAkB,IAAI,OAAO,WAAW,GACxC,YAAa,IAAI,OAAO,WAAW,GACnC,SAAU,EAAK,IAAI,CAAG,CAAE,KAAM,EAAK,IAAI,AAAC,EAAI,CAAC,CAC/C,EACD,EACA,MAAM,GACN,MAAM,GAET,GAAI,EAEF,KAFS,EACT,QAAQ,KAAK,CAAC,mCAAoC,GAC3C,CAAE,KAAM,KAAM,MAAO,EAAM,OAAO,AAAC,EAI5C,IAAM,EAAyC,WAAzB,EAAK,eAAe,CAAgB,EAAK,MAAM,CAAG,CAAC,EAAK,MAAM,CAOpF,OANA,MAAM,EAAS,GAAG,CAAC,yBAA0B,CAC3C,WAAY,EAAK,SAAS,CAC1B,cAAe,CACjB,GAEA,QAAQ,GAAG,CAAC,4BAA6B,EAAY,EAAE,CAAE,EAAK,MAAM,EAC7D,CAAE,KAAM,EAAa,MAAO,IAAK,CAC1C,CDrDO,eAAe,EAAsB,CAQ3C,EACC,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,CACJ,KAAM,CAAE,MAAI,CAAE,CACf,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,GAE/B,GAAI,CAAC,EACH,IADS,EACF,CAAE,KAAM,KAAM,MAAO,mBAAoB,EAIlD,GAAM,CAAE,KAAM,CAAQ,OAAE,CAAK,CAAE,CAAG,MAAM,EACrC,IAAI,CAAC,qBACL,MAAM,CAAC,CACN,CACE,QAAS,EAAK,EAAE,CAChB,gBAAiB,EAAK,aAAa,CACnC,cAAe,EAAK,WAAW,CAC/B,oBAAqB,EAAK,iBAAiB,CAC3C,OAAQ,EAAK,MAAM,CACnB,cAAe,EAAK,YAAY,CAChC,OAAQ,EAAK,aAAa,CAAG,YAAc,YAC3C,eAAgB,EAAK,aAAa,EAAI,IAAI,KAC1C,eAAgB,EAAK,aAAa,CAAG,KAAO,IAAI,OAAO,WAAW,GAClE,SAAU,MACV,KAAM,EAAK,IAAI,CACf,iBAAkB,CAAC,GAAG,EAAE,KAAK,GAAG,GAAA,EAAK,KAAK,KAAK,CAAiB,IAAhB,KAAK,MAAM,IAAK,CAAO,AACzE,EACD,EACA,MAAM,GACN,MAAM,UAEL,AAAJ,GACE,IADS,IACD,KAAK,CAAC,gCAAiC,GACxC,CAAE,KAAM,KAAM,MAAO,EAAM,OAAO,AAAC,IAIxC,CAAC,EAAK,aAAa,EAAI,EAAK,aAAa,EAAE,CAC7C,MAAM,EAAyB,CAC7B,UAAW,EAAK,aAAa,CAC7B,OAAQ,EAAK,MAAM,CACnB,YAAa,CAAC,YAAY,EAAE,EAAK,WAAW,CAAG,UAAY,WAAA,CAAY,CACvE,gBAAiB,QACjB,aAAc,oBACd,KAAM,EAAK,IAAI,AACjB,GAEI,EAAK,WAAW,EAAE,AACpB,MAAM,EAAyB,CAC7B,UAAW,EAAK,WAAW,CAC3B,OAAQ,EAAK,MAAM,CACnB,YAAa,oBACb,gBAAiB,SACjB,aAAc,oBACd,KAAM,EAAK,IAAI,AACjB,IAIJ,QAAQ,GAAG,CAAC,yBAA0B,EAAS,EAAE,CAAE,EAAK,MAAM,EACvD,CAAE,KAAM,EAAU,MAAO,IAAK,EACvC,iCCxEsB,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,sCDCA,IAAA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,yEELtB,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA"}