{"version":3,"sources":["../../../../components/filing-dashboard-enhanced.tsx/__nextjs-internal-proxy.mjs","../../../../app/dashboard/filing/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const FilingDashboardEnhanced = registerClientReference(\n    function() { throw new Error(\"Attempted to call FilingDashboardEnhanced() from the server but FilingDashboardEnhanced is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/filing-dashboard-enhanced.tsx\",\n    \"FilingDashboardEnhanced\",\n);\n","import { redirect } from \"next/navigation\"\nimport { cookies } from \"next/headers\"\nimport { createClient } from \"@/lib/supabase/server\"\nimport { FilingDashboardEnhanced } from \"@/components/filing-dashboard-enhanced\"\n\nexport const dynamic = \"force-dynamic\"\n\nexport default async function FilingDashboardPage() {\n  console.log(\"[v0] Filing page: Starting to load\")\n\n  const cookieStore = await cookies()\n  const isDemoMode = cookieStore.get(\"demo_mode\")?.value === \"true\"\n\n  if (isDemoMode) {\n    console.log(\"[v0] Filing page: Using demo mode, showing demo filings\")\n    const demoUser = {\n      id: \"demo-user-id\",\n      email: \"demo@taxu.com\",\n    }\n\n    const demoFilings = [\n      {\n        id: \"demo-filing-1\",\n        tax_year: 2024,\n        form_type: \"W-2\" as const,\n        filing_status: \"accepted\" as const,\n        submission_id: \"DEMO-W2-2024-001\",\n        irs_status: \"accepted\",\n        refund_amount: 1250,\n        filed_at: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),\n        accepted_at: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),\n        rejected_at: null,\n        rejection_reasons: null,\n        provider_name: \"IRS E-File\",\n        created_at: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),\n        updated_at: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),\n      },\n      {\n        id: \"demo-filing-2\",\n        tax_year: 2024,\n        form_type: \"1099-NEC\" as const,\n        filing_status: \"pending\" as const,\n        submission_id: \"DEMO-1099-2024-001\",\n        irs_status: \"pending\",\n        refund_amount: null,\n        filed_at: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n        accepted_at: null,\n        rejected_at: null,\n        rejection_reasons: null,\n        provider_name: \"IRS E-File\",\n        created_at: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n        updated_at: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n      },\n    ]\n\n    return <FilingDashboardEnhanced user={demoUser as any} filings={demoFilings} />\n  }\n\n  let supabase\n  try {\n    supabase = await createClient()\n  } catch (error) {\n    console.error(\"[v0] Filing page: Error creating Supabase client:\", error)\n    redirect(\"/login?redirect=/dashboard/filing\")\n  }\n\n  if (!supabase) {\n    console.log(\"[v0] Filing page: No Supabase client, redirecting to login\")\n    redirect(\"/login?redirect=/dashboard/filing\")\n  }\n\n  let user\n  try {\n    const {\n      data: { user: authUser },\n      error: authError,\n    } = await supabase.auth.getUser()\n\n    if (authError || !authUser) {\n      console.log(\"[v0] Filing page: No authenticated user, redirecting to login\", authError)\n      redirect(\"/login?redirect=/dashboard/filing\")\n    }\n\n    user = authUser\n  } catch (error) {\n    console.error(\"[v0] Filing page: Error getting user:\", error)\n    redirect(\"/login?redirect=/dashboard/filing\")\n  }\n\n  let w2Filings = []\n  let nec1099Filings = []\n\n  try {\n    const { data: w2Data, error: w2Error } = await supabase\n      .from(\"w2_filings\")\n      .select(\"*\")\n      .eq(\"user_id\", user.id)\n      .order(\"created_at\", { ascending: false })\n\n    if (w2Error) {\n      console.error(\"[v0] Error fetching W-2 filings:\", w2Error)\n    } else {\n      w2Filings = w2Data || []\n    }\n  } catch (error) {\n    console.error(\"[v0] Exception fetching W-2 filings:\", error)\n  }\n\n  try {\n    const { data: necData, error: necError } = await supabase\n      .from(\"nec_1099_filings\")\n      .select(\"*\")\n      .eq(\"user_id\", user.id)\n      .order(\"created_at\", { ascending: false })\n\n    if (necError) {\n      console.error(\"[v0] Error fetching 1099-NEC filings:\", necError)\n    } else {\n      nec1099Filings = necData || []\n    }\n  } catch (error) {\n    console.error(\"[v0] Exception fetching 1099-NEC filings:\", error)\n  }\n\n  console.log(\n    `[v0] Fetched ${w2Filings.length} W-2 filings and ${nec1099Filings.length} 1099-NEC filings for user ${user.id}`,\n  )\n\n  const transformedW2Filings = w2Filings.map((filing) => {\n    let refundAmount = filing.refund_amount || null\n\n    if (!refundAmount && filing.irs_status === \"accepted\") {\n      const wages = filing.wages || 0\n      const federalWithheld = filing.federal_tax_withheld || 0\n      const ssWithheld = filing.social_security_tax || 0\n      const medicareWithheld = filing.medicare_tax || 0\n\n      const standardDeduction = 13850\n      const taxableIncome = Math.max(0, wages - standardDeduction)\n      const estimatedTax = taxableIncome * 0.1\n      const totalWithheld = federalWithheld + ssWithheld + medicareWithheld\n\n      refundAmount = Math.max(0, Math.round(totalWithheld - estimatedTax))\n    }\n\n    const normalizedStatus = (filing.irs_status || \"\").toLowerCase()\n\n    return {\n      id: filing.id,\n      tax_year: filing.tax_year,\n      form_type: \"W-2\" as const,\n      filing_status:\n        normalizedStatus === \"accepted\" ? \"accepted\" : normalizedStatus === \"rejected\" ? \"rejected\" : \"pending\",\n      submission_id: filing.submission_id || \"\",\n      irs_status: filing.irs_status,\n      refund_amount: refundAmount,\n      filed_at: filing.submitted_at,\n      accepted_at: filing.accepted_at,\n      rejected_at: filing.rejected_at,\n      rejection_reasons: filing.rejection_reasons,\n      provider_name: \"IRS E-File\",\n      created_at: filing.created_at,\n      updated_at: filing.updated_at,\n    }\n  })\n\n  const transformedNecFilings = nec1099Filings.map((filing) => {\n    const normalizedStatus = (filing.irs_status || \"\").toLowerCase()\n\n    return {\n      id: filing.id,\n      tax_year: filing.tax_year,\n      form_type: \"1099-NEC\" as const,\n      filing_status:\n        normalizedStatus === \"accepted\" ? \"accepted\" : normalizedStatus === \"rejected\" ? \"rejected\" : \"pending\",\n      submission_id: filing.submission_id || \"\",\n      irs_status: filing.irs_status,\n      refund_amount: null,\n      filed_at: filing.submitted_at,\n      accepted_at: filing.accepted_at,\n      rejected_at: filing.rejected_at,\n      rejection_reasons: filing.rejection_reasons,\n      provider_name: \"IRS E-File\",\n      created_at: filing.created_at,\n      updated_at: filing.updated_at,\n    }\n  })\n\n  const allFilings = [...transformedW2Filings, ...transformedNecFilings].sort(\n    (a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime(),\n  )\n\n  console.log(`[v0] Filing page: Rendering with ${allFilings.length} total filings`)\n\n  return <FilingDashboardEnhanced user={user} filings={allFilings} />\n}\n"],"names":[],"mappings":"+aAEO,IAAM,EAA0B,CAAA,EAAA,AADvC,EAAA,CAAA,CAAA,QACuC,uBAAA,AAAuB,EAC1D,WAAa,MAAM,AAAI,MAAM,4PAA8P,EAC3R,yEACA,2FAHG,IAAM,EAA0B,CAAA,EADvC,AACuC,EADvC,CAAA,CAAA,QACuC,uBAAA,AAAuB,EAC1D,WAAa,MAAM,AAAI,MAAM,4PAA8P,EAC3R,qDACA,mICLJ,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAIe,eAAe,QAmDxB,EAaA,EA/DJ,QAAQ,GAAG,CAAC,sCAEZ,IAAM,EAAc,MAAM,CAAA,EAAA,EAAA,OAAA,AAAO,IAGjC,GAFmB,CAEf,CAF2B,GAAG,CAAC,cAAc,QAAU,OAE3C,CACd,QAAQ,GAAG,CAAC,2DAMZ,IAAM,EAAc,CAClB,CACE,GAAI,gBACJ,SAAU,KACV,UAAW,MACX,cAAe,WACf,cAAe,mBACf,WAAY,WACZ,cAAe,KACf,SAAU,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,IAAqB,CAAhB,KAAK,KAAsB,AAAjB,GACnD,YAAa,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,GAAqB,EAAhB,KAAK,IAAsB,CAAjB,EACtD,YAAa,KACb,kBAAmB,KACnB,cAAe,aACf,WAAY,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,IAAqB,CAAhB,KAAK,KAAK,AAAiB,GACtE,WAAY,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,GAAqB,EAAhB,KAAK,IAAsB,CAAjB,CACvD,EACA,CACE,GAAI,gBACJ,SAAU,KACV,UAAW,WACX,cAAe,UACf,cAAe,qBACf,WAAY,UACZ,cAAe,KACf,SAAU,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,IAAqB,CAAhB,KAAK,KAAK,AAAiB,GACpE,YAAa,KACb,YAAa,KACb,kBAAmB,KACnB,cAAe,aACf,WAAY,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,IAAqB,CAAhB,KAAK,KAAK,AAAiB,GACtE,WAAY,IAAI,KAAK,KAAK,GAAG,GAAK,IAAI,IAAqB,CAAhB,KAAK,KAAK,AAAiB,EACxE,EACD,CAED,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,uBAAuB,CAAA,CAAC,KAxCf,CAwCqB,AAvCpC,GAAI,eACJ,MAAO,eACT,EAqCuD,QAAS,GAClE,CAGA,GAAI,CACF,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,GAC/B,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,oDAAqD,GACnE,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,oCACX,CAEK,IACH,MADa,EACL,GAAG,CAAC,8DACZ,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,sCAIX,GAAI,CACF,GAAM,CACJ,KAAM,CAAE,KAAM,CAAQ,CAAE,CACxB,MAAO,CAAS,CACjB,CAAG,MAAM,EAAS,IAAI,CAAC,OAAO,IAE3B,GAAa,CAAC,CAAA,GAAU,CAC1B,QAAQ,GAAG,CAAC,gEAAiE,GAC7E,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,sCAGX,EAAO,CACT,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,wCAAyC,GACvD,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,oCACX,CAEA,IAAI,EAAY,EAAE,CACd,EAAiB,EAAE,CAEvB,GAAI,CACF,GAAM,CAAE,KAAM,CAAM,CAAE,MAAO,CAAO,CAAE,CAAG,MAAM,EAC5C,IAAI,CAAC,cACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAW,EAAK,EAAE,EACrB,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GAEtC,EACF,OADW,CACH,KAAK,CAAC,mCAAoC,GAElD,EAAY,GAAU,EAAE,AAE5B,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,uCAAwC,EACxD,CAEA,GAAI,CACF,GAAM,CAAE,KAAM,CAAO,CAAE,MAAO,CAAQ,CAAE,CAAG,MAAM,EAC9C,IAAI,CAAC,oBACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAW,EAAK,EAAE,EACrB,KAAK,CAAC,aAAc,CAAE,UAAW,EAAM,GAEtC,EACF,QAAQ,AADI,KACC,CAAC,wCAAyC,GAEvD,EAAiB,GAAW,EAAE,AAElC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,4CAA6C,EAC7D,CAEA,QAAQ,GAAG,CACT,CAAC,aAAa,EAAE,EAAU,MAAM,CAAC,iBAAiB,EAAE,EAAe,MAAM,CAAC,2BAA2B,EAAE,EAAK,EAAE,CAAA,CAAE,EAGlH,IA4DM,EA5DA,AA4Da,IA5DU,EAAU,GAAG,CAAC,AAAC,IAC1C,IAAI,EAAe,EAAO,aAAa,EAAI,KAE3C,GAAI,CAAC,GAAsC,aAAtB,EAAO,UAAU,CAAiB,CACrD,IAAM,EAAQ,EAAO,KAAK,EAAI,EAU9B,EAAe,KAAK,GAAG,CAAC,EAAG,KAAK,KAAK,CAAC,CATd,EAAO,aASuB,OATH,GAAI,GACpC,EAAO,mBAAmB,GAAI,GACxB,EAAO,YAAY,GAAI,EAI3B,AAAgB,GADf,KAAK,GAAG,CAAC,EAAG,EADR,MACgB,EAK5C,CAEA,IAAM,EAAmB,AAAC,GAAO,UAAU,EAAI,EAAA,CAAE,CAAE,WAAW,GAE9D,MAAO,CACL,GAAI,EAAO,EAAE,CACb,SAAU,EAAO,QAAQ,CACzB,UAAW,MACX,cACE,AAAqB,eAAa,WAAkC,aAArB,EAAkC,WAAa,UAChG,cAAe,EAAO,aAAa,EAAI,GACvC,WAAY,EAAO,UAAU,CAC7B,cAAe,EACf,SAAU,EAAO,YAAY,CAC7B,YAAa,EAAO,WAAW,CAC/B,YAAa,EAAO,WAAW,CAC/B,kBAAmB,EAAO,iBAAiB,CAC3C,cAAe,aACf,WAAY,EAAO,UAAU,CAC7B,WAAY,EAAO,UAAU,AAC/B,CACF,MAE8B,EAAe,GAAG,CAAC,AAAC,IAChD,IAAM,EAAmB,CAAC,EAAO,UAAU,EAAI,EAAA,CAAE,CAAE,WAAW,GAE9D,MAAO,CACL,GAAI,EAAO,EAAE,CACb,SAAU,EAAO,QAAQ,CACzB,UAAW,WACX,cACuB,aAArB,EAAkC,WAAkC,aAArB,EAAkC,WAAa,UAChG,cAAe,EAAO,aAAa,EAAI,GACvC,WAAY,EAAO,UAAU,CAC7B,cAAe,KACf,SAAU,EAAO,YAAY,CAC7B,YAAa,EAAO,WAAW,CAC/B,YAAa,EAAO,WAAW,CAC/B,kBAAmB,EAAO,iBAAiB,CAC3C,cAAe,aACf,WAAY,EAAO,UAAU,CAC7B,WAAY,EAAO,UAAU,AAC/B,CACF,GAEsE,CAAC,IAAI,CACzE,CAAC,EAAG,IAAM,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,GAAK,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,IAK7E,OAFA,QAAQ,GAAG,CAAC,CAAC,iCAAiC,EAAE,EAAW,MAAM,CAAC,cAAc,CAAC,EAE1E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,uBAAuB,CAAA,CAAC,KAAM,EAAM,QAAS,GACvD,gCA9LuB","ignoreList":[0]}