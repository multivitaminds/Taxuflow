{"version":3,"sources":["../../../../app/actions/neobank/get-cards.ts","../../../../.next-internal/server/app/neobank/cards/page/actions.js%20%28server%20actions%20loader%29","../../../../app/actions/neobank/create-card.ts"],"sourcesContent":["\"use server\"\n\nimport { createClient } from \"@/lib/supabase/server\"\n\nexport async function getNeobankCards() {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  if (!user) {\n    return { data: null, error: \"Not authenticated\" }\n  }\n\n  const { data, error } = await supabase\n    .from(\"neobank_cards\")\n    .select(\"*\")\n    .eq(\"user_id\", user.id)\n    .order(\"created_at\", { ascending: false })\n\n  if (error) {\n    console.error(\"[v0] Error fetching cards:\", error)\n    return { data: null, error: error.message }\n  }\n\n  return { data, error: null }\n}\n","export {getUserProfile as '40d983bdc873a2f33f08198e581ae6b3a6175ca29e'} from 'ACTIONS_MODULE0'\nexport {getUser as '00b4e5982374ff027d3c9db80af0059fe8abad476a'} from 'ACTIONS_MODULE1'\nexport {getNeobankCards as '00230742351143009d920d741671d90979ca544429'} from 'ACTIONS_MODULE2'\nexport {createNeobankCard as '40809ba98f19ebadb960e84122ddee48406fd3434a'} from 'ACTIONS_MODULE3'\nexport {updateCardStatus as '6014c16f1d260c4931b03eb27ebd48fdf038c2aa06'} from 'ACTIONS_MODULE3'\n","\"use server\"\n\nimport { createClient } from \"@/lib/supabase/server\"\nimport { revalidatePath } from \"next/cache\"\n\nexport async function createNeobankCard(formData: {\n  cardType: \"virtual\" | \"physical\"\n  cardName: string\n  monthlyLimit: number\n  cardholder: string\n}) {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  if (!user) {\n    return { success: false, error: \"Not authenticated\" }\n  }\n\n  // Generate card details\n  const last4 = Math.floor(1000 + Math.random() * 9000).toString()\n  const cvv = Math.floor(100 + Math.random() * 900).toString()\n  const currentYear = new Date().getFullYear()\n  const expiryYear = (currentYear + 4).toString().slice(-2)\n  const expiryMonth = String(Math.floor(Math.random() * 12) + 1).padStart(2, \"0\")\n\n  const { data, error } = await supabase\n    .from(\"neobank_cards\")\n    .insert({\n      user_id: user.id,\n      card_type: formData.cardType,\n      card_name: formData.cardName,\n      last_four: last4,\n      expiry_date: `${expiryMonth}/${expiryYear}`,\n      cvv: cvv,\n      cardholder_name: formData.cardholder.toUpperCase(),\n      monthly_limit: formData.monthlyLimit,\n      spent_amount: 0,\n      status: \"active\",\n    })\n    .select()\n    .single()\n\n  if (error) {\n    console.error(\"[v0] Error creating card:\", error)\n    return { success: false, error: error.message }\n  }\n\n  revalidatePath(\"/neobank/cards\")\n  return { success: true, data }\n}\n\nexport async function updateCardStatus(cardId: string, status: \"active\" | \"frozen\" | \"cancelled\") {\n  const supabase = await createClient()\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  if (!user) {\n    return { success: false, error: \"Not authenticated\" }\n  }\n\n  const { error } = await supabase\n    .from(\"neobank_cards\")\n    .update({ status, updated_at: new Date().toISOString() })\n    .eq(\"id\", cardId)\n    .eq(\"user_id\", user.id)\n\n  if (error) {\n    console.error(\"[v0] Error updating card status:\", error)\n    return { success: false, error: error.message }\n  }\n\n  revalidatePath(\"/neobank/cards\")\n  return { success: true }\n}\n"],"names":[],"mappings":"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"}