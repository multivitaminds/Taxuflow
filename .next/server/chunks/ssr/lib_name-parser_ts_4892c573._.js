module.exports=[350152,855346,709677,a=>{"use strict";a.s(["parseLastNameWithMiddleInitial",0,function(a){if(!a||"string"!=typeof a)return null;let b=a.trim();if(!b)return null;let c=b.split(/\s+/);if(1===c.length)return{middleInitial:"",lastName:c[0]};let d=c[0];return 1===d.length||2===d.length&&d.endsWith(".")?{middleInitial:d.replace(".","").toUpperCase(),lastName:c.slice(1).join(" ")}:{middleInitial:"",lastName:b}},"parseName",0,function(a){if(!a||"string"!=typeof a)return null;let b=a.trim();if(!b)return null;let c=b.split(/\s+/);if(1===c.length)return{firstName:c[0],middleInitial:"",lastName:""};if(2===c.length)return{firstName:c[0],middleInitial:"",lastName:c[1]};let d=c[0],e=c[c.length-1],f=c[1];return 1===f.length||2===f.length&&f.endsWith(".")?{firstName:d,middleInitial:f.replace(".","").toUpperCase(),lastName:e}:{firstName:d,middleInitial:f.charAt(0).toUpperCase(),lastName:e}}],350152);var b=a.i(108446),c=a.i(117462),d=a.i(703130),e=a.i(340695),f=a.i(277687),g=a.i(323746),h=a.i(197665),i=a.i(861084),j=a.i(674375),k=a.i(549117),l=a.i(949191),m=a.i(303314);a.s(["DocumentUpload",0,function({userId:a,onExtractComplete:n,formType:o="all",expectedDocType:p,title:q="Upload Tax Documents",description:r="Upload W-2s, 1099s, receipts, and other tax documents for AI extraction"}){let[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!1),{toast:w}=(0,f.useToast)(),x=(0,m.useRouter)();console.log("[v0] DocumentUpload component mounted"),console.log("[v0] DocumentUpload props:",{userId:a,formType:o,expectedDocType:p});let y=(0,c.useCallback)(a=>{a.preventDefault(),v(!1),console.log("[v0] Files dropped via drag-and-drop");let b=Array.from(a.dataTransfer.files);console.log("[v0] Number of files dropped:",b.length),z(b)},[]),z=async b=>{if(console.log("[v0] handleFiles called with",b.length,"files"),console.log("[v0] Current userId:",a),console.log("[v0] File names:",b.map(a=>a.name)),!a){console.error("[v0] No userId provided, showing authentication error"),w({title:"Authentication Required",description:"Please wait for authentication to complete, then try uploading again.",variant:"destructive"});return}let c=[],d=[];for(let a of b){if(!["application/pdf","image/jpeg","image/jpg","image/png"].includes(a.type)&&!a.name.match(/\.(pdf|jpg|jpeg|png)$/i)){d.push(`${a.name} (invalid type)`);continue}if(a.size>0xa00000){d.push(`${a.name} (exceeds 10MB)`);continue}c.push(a)}if(d.length>0&&w({title:"Invalid Files",description:`The following files cannot be uploaded: ${d.join(", ")}`,variant:"destructive"}),0===c.length)return;let e=c.map(a=>({id:Date.now().toString()+Math.random(),name:a.name,size:a.size,type:a.type,status:"uploading"}));t(a=>[...a,...e]);for(let b=0;b<c.length;b++){let d=c[b],f=e[b].id;try{if(console.log("[v0] Starting AI extraction for:",d.name),console.log("[v0] File size:",d.size/1048576,"MB"),console.log("[v0] File type:",d.type),d.size/1048576>10)throw Error("File too large. Maximum size is 10MB. Please compress the document.");t(a=>a.map(a=>a.id===f?{...a,status:"processing"}:a)),console.log("[v0] Converting file to base64...");let b=await d.arrayBuffer(),c=Buffer.from(b).toString("base64");console.log("[v0] Base64 length:",c.length);let e=new AbortController,g=setTimeout(()=>e.abort(),45e3);try{console.log("[v0] Calling /api/filing/extract-document...");let b=await fetch("/api/filing/extract-document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:c,fileName:d.name,mimeType:d.type,userId:a}),signal:e.signal});clearTimeout(g),console.log("[v0] Extract API response status:",b.status);let h=await b.json();if(console.log("[v0] Extraction response success:",h.success),console.log("[v0] Extraction response data type:",h.data?.documentType),console.log("[v0] Full extraction response:",JSON.stringify(h).substring(0,300)),h.success&&h.data){if(console.log("[v0] Extraction successful, processing results..."),p&&h.data.documentType!==p){let a=(h.data.documentType||"unknown").toUpperCase(),b=p.toUpperCase();console.log("[v0] Form type mismatch:",{detected:a,expected:b}),w({title:"Different Form Type Detected",description:`Uploaded ${a} form to ${b} page. Please verify this is correct.`,variant:"default"})}t(a=>a.map(a=>a.id===f?{...a,status:"complete",extractedData:h.data}:a)),console.log("[v0] Calling onExtractComplete callback..."),console.log("[v0] Callback data:",JSON.stringify(h.data).substring(0,200)),"demo_mode"===h.warning?w({title:"Demo Mode Active",description:"AI service unavailable. Demo data provided - please verify all information.",variant:"default"}):"template_data_detected"===h.warning?w({title:"Demo Document Detected",description:`${d.name} appears to be a demo/template. Data extracted - please verify before submitting.`,variant:"default"}):w({title:"Document Processed",description:`Successfully extracted ${h.data.documentType?.toUpperCase()||"data"} from ${d.name}`}),n?(console.log("[v0] Executing onExtractComplete callback"),n(h.data,{warning:h.warning,message:h.message})):console.log("[v0] No onExtractComplete callback provided")}else throw console.error("[v0] Extraction failed:",h.error),Error(h.error||"Extraction failed")}catch(a){if(clearTimeout(g),console.error("[v0] Fetch error:",a),a instanceof Error&&"AbortError"===a.name)throw Error("Request timed out. The document may be too large or complex. Please try with a smaller/clearer document.");throw a}}catch(b){console.error("[v0] Processing error:",b);let a=b instanceof Error?b.message:"Failed to process document";t(b=>b.map(b=>b.id===f?{...b,status:"error",errorMessage:a}:b)),w({title:"Processing Failed",description:a,variant:"destructive"})}}},A=async()=>{console.log("[v0] handleSubmit called, files:",s.length);let b=s.filter(a=>"complete"===a.status);if(console.log("[v0] Completed files:",b.length),0===b.length)return void w({title:"No Documents Ready",description:"Please wait for documents to finish processing",variant:"destructive"});if("1099-nec"===p&&n){let a=b.map(a=>a.extractedData);w({title:"Documents Ready",description:`${b.length} contractor document${b.length>1?"s":""} extracted successfully`}),n({contractors:a},{isMultiple:!0});return}try{let c;console.log("[v0] Submitting to /api/filing/submit-extracted with userId:",a),console.log("[v0] Documents data:",JSON.stringify(b.map(a=>a.extractedData)).substring(0,500));let d=await fetch("/api/filing/submit-extracted",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,documents:b.map(a=>a.extractedData)})});console.log("[v0] Response status:",d.status);let e=d.headers.get("content-type");if(e&&e.includes("application/json"))c=await d.json(),console.log("[v0] Response data:",JSON.stringify(c).substring(0,300));else{let a=await d.text();throw console.error("[v0] Received non-JSON response:",a.substring(0,300)),Error("Server returned an invalid response. Please try again or contact support.")}if(c.success)w({title:"Filing Submitted",description:"Your tax documents have been filed successfully"}),x.push("/dashboard/filing");else throw Error(c.error||"Failed to submit filing")}catch(a){console.error("[v0] Submission error:",a),w({title:"Submission Failed",description:a instanceof Error?a.message:"Failed to submit tax filing",variant:"destructive"})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:q}),(0,b.jsx)(d.CardDescription,{children:r})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{onDrop:y,onDragOver:a=>{a.preventDefault(),v(!0)},onDragLeave:()=>v(!1),className:`relative rounded-lg border-2 border-dashed p-12 text-center transition-colors ${u?"border-primary bg-primary/5":"border-muted-foreground/25"}`,children:[(0,b.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:a=>{if(console.log("[v0] File input changed"),a.target.files){let b=Array.from(a.target.files);console.log("[v0] Number of files selected:",b.length),z(b)}else console.log("[v0] No files selected")},className:"absolute inset-0 cursor-pointer opacity-0"}),(0,b.jsx)(g.Upload,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"Drop files here or click to upload"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supports PDF, JPG, PNG (Max 10MB per file)"})]})})]}),s.length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Uploaded Documents"})}),(0,b.jsx)(d.CardContent,{className:"space-y-3",children:s.map(a=>{let c=(a=>{switch(a.status){case"uploading":return{icon:(0,b.jsx)(i.Loader2,{className:"h-5 w-5 animate-spin text-blue-600"}),text:"Uploading...",color:"text-blue-600"};case"processing":return{icon:(0,b.jsx)(i.Loader2,{className:"h-5 w-5 animate-spin text-yellow-600"}),text:"AI Extracting Data...",color:"text-yellow-600"};case"complete":return{icon:(0,b.jsx)(j.CheckCircle2,{className:"h-5 w-5 text-green-600"}),text:"âœ“ Extracted Successfully",color:"text-green-600"};case"error":return{icon:(0,b.jsx)(l.AlertCircle,{className:"h-5 w-5 text-red-600"}),text:a.errorMessage||"Processing Failed",color:"text-red-600"}}})(a);return(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)(h.FileText,{className:"h-8 w-8 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(a.size/1024).toFixed(2)," KB"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[c.icon,(0,b.jsx)("span",{className:`text-sm font-medium ${c.color}`,children:c.text})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.id,void t(a=>a.filter(a=>a.id!==b))},children:(0,b.jsx)(k.X,{className:"h-4 w-4"})})]})]},a.id)})})]}),s.some(a=>"complete"===a.status)&&(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>t([]),children:"Clear All"}),(0,b.jsx)(e.Button,{onClick:A,className:"bg-gradient-to-r from-purple-600 to-orange-600",children:"Submit Filing"})]})]})}],855346);var n=a.i(727540),o=a.i(506702),p=a.i(583958),q=a.i(639151);a.s(["QuickBooksSync",0,function({userId:a,onSyncComplete:g}){let[h,k]=(0,c.useState)(null),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),{toast:v}=(0,f.useToast)(),w=(0,m.useRouter)();(0,c.useEffect)(()=>{x()},[]);let x=async()=>{try{let b=await fetch(`/api/quickbooks/sync-status?userId=${a}`),c=await b.json();k(c)}catch(a){console.error("Failed to fetch sync status:",a)}},y=async()=>{s(!0);try{let b=await fetch("/api/quickbooks/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a})}),c=await b.json();c.success&&(v({title:"Sync Complete",description:`Synced ${c.transactionCount} transactions and categorized them for taxes`}),x(),g&&c.extractedData&&g(c.extractedData))}catch(a){v({title:"Sync Failed",description:"Failed to sync QuickBooks data",variant:"destructive"})}finally{s(!1)}},z=async()=>{u(!0);try{let b=await fetch("/api/filing/submit-quickbooks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a})});(await b.json()).success&&(v({title:"Filing Submitted",description:"Your tax filing has been submitted successfully"}),w.push("/dashboard/filing"))}catch(a){v({title:"Submission Failed",description:"Failed to submit tax filing",variant:"destructive"})}finally{u(!1)}};return h?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(d.Card,{className:"border-purple-500/20 bg-gradient-to-br from-purple-500/5 to-orange-500/5 backdrop-blur-sm",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"bg-gradient-to-r from-purple-600 to-orange-600 bg-clip-text text-transparent",children:"QuickBooks Integration"}),(0,b.jsx)(d.CardDescription,{children:"Sync your QuickBooks data to automatically categorize transactions for taxes using AI"})]}),(0,b.jsx)(d.CardContent,{className:"space-y-6",children:h.connected?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-green-500/20 bg-gradient-to-r from-green-500/10 to-emerald-500/10 p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"rounded-full bg-green-500/20 p-2",children:(0,b.jsx)(j.CheckCircle2,{className:"h-6 w-6 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:"QuickBooks Connected"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Last synced: ",h.lastSync?new Date(h.lastSync).toLocaleString():"Never"]})]})]}),(0,b.jsxs)(e.Button,{onClick:y,disabled:r,variant:"outline",className:"border-green-500/20 bg-transparent",children:[r?(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(o.RefreshCw,{className:"mr-2 h-4 w-4"}),"Sync Now"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(d.Card,{className:"border-blue-500/20 bg-gradient-to-br from-blue-500/10 to-cyan-500/10",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Total Transactions"}),(0,b.jsx)(p.TrendingUp,{className:"h-4 w-4 text-blue-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:h.transactionCount}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Synced from QuickBooks"})]})]}),(0,b.jsxs)(d.Card,{className:"border-purple-500/20 bg-gradient-to-br from-purple-500/10 to-pink-500/10",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"AI Categorized"}),(0,b.jsx)(q.TrendingDown,{className:"h-4 w-4 text-purple-600"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:h.categorizedCount}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ready for tax filing"})]})]})]}),h.categorizedCount>0&&(0,b.jsx)("div",{className:"rounded-lg border border-green-500/20 bg-gradient-to-r from-green-500/10 to-emerald-500/10 p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.CheckCircle2,{className:"h-5 w-5 text-green-600"}),(0,b.jsx)("p",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Ready to file! Your transactions have been categorized and are ready for tax filing."})]})})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,b.jsx)("div",{className:"mb-4 rounded-full bg-purple-500/10 p-4",children:(0,b.jsx)(l.AlertCircle,{className:"h-12 w-12 text-purple-600"})}),(0,b.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"QuickBooks Not Connected"}),(0,b.jsx)("p",{className:"mb-4 text-center text-sm text-muted-foreground",children:"Connect your QuickBooks account to automatically import and categorize transactions"}),(0,b.jsxs)(e.Button,{onClick:()=>{window.location.href=`/api/quickbooks/connect?userId=${a}`},className:"bg-gradient-to-r from-purple-600 to-orange-600 hover:from-purple-700 hover:to-orange-700",children:[(0,b.jsx)(n.LinkIcon,{className:"mr-2 h-4 w-4"}),"Connect QuickBooks"]})]})})]}),h.connected&&h.categorizedCount>0&&(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(e.Button,{onClick:z,disabled:t,className:"bg-gradient-to-r from-purple-600 to-orange-600 hover:from-purple-700 hover:to-orange-700",children:[t&&(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submit Tax Filing"]})})]}):(0,b.jsx)(d.Card,{className:"border-purple-500/20 bg-gradient-to-br from-purple-500/5 to-orange-500/5",children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-purple-600"})})})}],709677)}];

//# sourceMappingURL=lib_name-parser_ts_4892c573._.js.map