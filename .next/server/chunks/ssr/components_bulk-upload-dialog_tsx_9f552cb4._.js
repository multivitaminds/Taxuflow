module.exports=[699876,a=>{"use strict";var b=a.i(108446),c=a.i(117462),d=a.i(965733),e=a.i(340695),f=a.i(323746),g=a.i(807518),h=a.i(958635);class i{static cleanCustomerData(a){return a.map(a=>this.cleanRecord(a))}static cleanRecord(a){return{contact_name:this.cleanName(a.contact_name),company_name:this.cleanName(a.company_name),email:this.cleanEmail(a.email),phone:this.cleanPhone(a.phone),address_line1:this.cleanAddress(a.address_line1),address_line2:this.cleanAddress(a.address_line2),city:this.cleanCity(a.city),state:this.cleanState(a.state),zip_code:this.cleanZipCode(a.zip_code),country:this.cleanCountry(a.country),tax_id:this.cleanTaxId(a.tax_id),notes:this.cleanNotes(a.notes)}}static cleanName(a){if(a)return String(a).trim().replace(/\s+/g," ").replace(/[^\w\s\-'.]/g,"")}static cleanEmail(a){if(a)return String(a).trim().toLowerCase()}static cleanPhone(a){if(!a)return;let b=String(a).replace(/\D/g,"");return 10===b.length?`(${b.slice(0,3)}) ${b.slice(3,6)}-${b.slice(6)}`:11===b.length&&"1"===b[0]?`+1 (${b.slice(1,4)}) ${b.slice(4,7)}-${b.slice(7)}`:b}static cleanAddress(a){if(a)return String(a).trim().replace(/\s+/g," ")}static cleanCity(a){if(a)return String(a).trim().replace(/\s+/g," ").replace(/\b\w/g,a=>a.toUpperCase())}static cleanState(a){if(!a)return;let b=String(a).trim().toUpperCase();return({ALABAMA:"AL",ALASKA:"AK",ARIZONA:"AZ",ARKANSAS:"AR",CALIFORNIA:"CA",COLORADO:"CO",CONNECTICUT:"CT",DELAWARE:"DE",FLORIDA:"FL",GEORGIA:"GA",HAWAII:"HI",IDAHO:"ID",ILLINOIS:"IL",INDIANA:"IN",IOWA:"IA",KANSAS:"KS",KENTUCKY:"KY",LOUISIANA:"LA",MAINE:"ME",MARYLAND:"MD",MASSACHUSETTS:"MA",MICHIGAN:"MI",MINNESOTA:"MN",MISSISSIPPI:"MS",MISSOURI:"MO",MONTANA:"MT",NEBRASKA:"NE",NEVADA:"NV","NEW HAMPSHIRE":"NH","NEW JERSEY":"NJ","NEW MEXICO":"NM","NEW YORK":"NY","NORTH CAROLINA":"NC","NORTH DAKOTA":"ND",OHIO:"OH",OKLAHOMA:"OK",OREGON:"OR",PENNSYLVANIA:"PA","RHODE ISLAND":"RI","SOUTH CAROLINA":"SC","SOUTH DAKOTA":"SD",TENNESSEE:"TN",TEXAS:"TX",UTAH:"UT",VERMONT:"VT",VIRGINIA:"VA",WASHINGTON:"WA","WEST VIRGINIA":"WV",WISCONSIN:"WI",WYOMING:"WY"})[b]||b}static cleanZipCode(a){if(!a)return;let b=String(a).replace(/\D/g,"");if(5===b.length);else if(9===b.length)return`${b.slice(0,5)}-${b.slice(5)}`;return b}static cleanCountry(a){if(!a)return"US";let b=String(a).trim().toUpperCase();return({"UNITED STATES":"US",USA:"US",AMERICA:"US",CANADA:"CA",MEXICO:"MX","UNITED KINGDOM":"GB",UK:"GB"})[b]||b}static cleanTaxId(a){if(a)return String(a).replace(/[^a-zA-Z0-9]/g,"")}static cleanNotes(a){if(a)return String(a).trim()}}class j{static validateCustomer(a){let b=[],c=[];return a.contact_name&&""!==a.contact_name.trim()||b.push({field:"contact_name",message:"Contact name is required"}),a.email?this.isValidEmail(a.email)||b.push({field:"email",message:"Invalid email format"}):c.push({field:"email",message:"Email is recommended for customer communication"}),a.phone&&!this.isValidPhone(a.phone)&&c.push({field:"phone",message:"Phone number format may be invalid"}),a.state&&!this.isValidState(a.state)&&c.push({field:"state",message:"State code may be invalid"}),a.zip_code&&!this.isValidZipCode(a.zip_code)&&c.push({field:"zip_code",message:"Zip code format may be invalid"}),a.tax_id&&!this.isValidTaxId(a.tax_id)&&c.push({field:"tax_id",message:"Tax ID format may be invalid"}),a.address_line1&&!a.city&&c.push({field:"city",message:"City is recommended when address is provided"}),a.address_line1&&!a.state&&c.push({field:"state",message:"State is recommended when address is provided"}),a.address_line1&&!a.zip_code&&c.push({field:"zip_code",message:"Zip code is recommended when address is provided"}),{isValid:0===b.length,errors:b,warnings:c}}static validateBatch(a){let b=[],c=[],d=[];return a.forEach(a=>{let e=this.validateCustomer(a);e.isValid?(b.push(a),e.warnings.length>0&&d.push({customer:a,warnings:e.warnings})):c.push({customer:a,errors:e.errors})}),{valid:b,invalid:c,warnings:d}}static isValidEmail(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}static isValidPhone(a){let b=a.replace(/\D/g,"");return b.length>=10&&b.length<=11}static isValidState(a){return["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"].includes(a.toUpperCase())}static isValidZipCode(a){return/^\d{5}(-\d{4})?$/.test(a)}static isValidTaxId(a){return 9===a.replace(/\D/g,"").length}}class k{static findDuplicates(a,b=[]){[...b,...a];let c=[],d=[],e=new Set;return a.forEach((f,g)=>{if(e.has(g))return;let h=!1;for(let a of b){let b=this.calculateMatch(f,a);if(b.matchScore>=.8){d.push({original:a,duplicate:f,matchScore:b.matchScore,matchFields:b.matchFields}),h=!0;break}}if(!h)for(let b=g+1;b<a.length;b++){if(e.has(b))continue;let c=this.calculateMatch(f,a[b]);if(c.matchScore>=.8){d.push({original:f,duplicate:a[b],matchScore:c.matchScore,matchFields:c.matchFields}),e.add(b),h=!0;break}}h||c.push(f)}),{unique:c,duplicates:d}}static calculateMatch(a,b){let c=[],d=0,e=0;if(a.email&&b.email&&(e+=.4,this.normalizeString(a.email)===this.normalizeString(b.email)&&(d+=.4,c.push("email"))),a.phone&&b.phone&&(e+=.3,a.phone.replace(/\D/g,"")===b.phone.replace(/\D/g,"")&&(d+=.3,c.push("phone"))),a.contact_name&&b.contact_name){e+=.2;let f=this.calculateStringSimilarity(this.normalizeString(a.contact_name),this.normalizeString(b.contact_name));f>.8&&(d+=.2*f,c.push("contact_name"))}if(a.company_name&&b.company_name){e+=.1;let f=this.calculateStringSimilarity(this.normalizeString(a.company_name),this.normalizeString(b.company_name));f>.8&&(d+=.1*f,c.push("company_name"))}return{matchScore:e>0?d/e:0,matchFields:c}}static normalizeString(a){return a.toLowerCase().trim().replace(/\s+/g," ")}static calculateStringSimilarity(a,b){let c=a.length,d=b.length,e=[];for(let a=0;a<=c;a++)e[a]=[a];for(let a=0;a<=d;a++)e[0][a]=a;for(let f=1;f<=c;f++)for(let c=1;c<=d;c++){let d=+(a[f-1]!==b[c-1]);e[f][c]=Math.min(e[f-1][c]+1,e[f][c-1]+1,e[f-1][c-1]+d)}let f=e[c][d],g=Math.max(c,d);return 0===g?1:1-f/g}}class l{static async process(a,b=[]){let c=i.cleanCustomerData(a),{valid:d,invalid:e,warnings:f}=j.validateBatch(c),{unique:g,duplicates:h}=k.findDuplicates(d,b),l={totalInput:a.length,cleaned:c.length,valid:d.length,invalid:e.length,duplicates:h.length,readyForImport:g.length};return{cleaned:c,valid:d,invalid:e,warnings:f,duplicates:h,unique:g,stats:l}}}class m{progress;listeners=[];constructor(a){this.progress={stages:[{name:"Parsing File",status:"pending",progress:0},{name:"Cleaning Data",status:"pending",progress:0},{name:"Validating Records",status:"pending",progress:0},{name:"Checking Duplicates",status:"pending",progress:0},{name:"Uploading to Database",status:"pending",progress:0}],currentStage:0,overallProgress:0,totalRecords:a,processedRecords:0,successfulRecords:0,failedRecords:0,startTime:Date.now()}}subscribe(a){return this.listeners.push(a),()=>{this.listeners=this.listeners.filter(b=>b!==a)}}notify(){this.listeners.forEach(a=>a({...this.progress}))}startStage(a,b){this.progress.currentStage=a,this.progress.stages[a].status="in-progress",this.progress.stages[a].progress=0,b&&(this.progress.stages[a].message=b),this.updateOverallProgress(),this.notify()}updateStageProgress(a,b,c){this.progress.stages[a].progress=Math.min(100,Math.max(0,b)),c&&(this.progress.stages[a].message=c),this.updateOverallProgress(),this.notify()}completeStage(a,b){this.progress.stages[a].status="completed",this.progress.stages[a].progress=100,b&&(this.progress.stages[a].message=b),this.updateOverallProgress(),this.notify()}errorStage(a,b){this.progress.stages[a].status="error",this.progress.stages[a].error=b,this.updateOverallProgress(),this.notify()}updateRecordProgress(a,b,c){this.progress.processedRecords=a,this.progress.successfulRecords=b,this.progress.failedRecords=c,this.updateEstimatedTime(),this.notify()}updateOverallProgress(){let a=this.progress.stages.length,b=this.progress.stages.filter(a=>"completed"===a.status).length,c=this.progress.stages[this.progress.currentStage]?.progress||0;this.progress.overallProgress=(b+c/100)/a*100}updateEstimatedTime(){let a=Date.now()-this.progress.startTime,b=this.progress.processedRecords;if(b>0){let c=this.progress.totalRecords-b;this.progress.estimatedTimeRemaining=Math.ceil(a/b*c)}}getProgress(){return{...this.progress}}}var n=a.i(703130),o=a.i(602150),p=a.i(595535),q=a.i(861084),r=a.i(765393),s=a.i(167305);function t({progress:a}){return(0,b.jsxs)(n.Card,{className:"p-6 border-border",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Upload Progress"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:[Math.round(a.overallProgress),"%"]})]}),(0,b.jsx)(o.Progress,{value:a.overallProgress,className:"h-3"}),a.estimatedTimeRemaining&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[(0,b.jsx)(s.Clock,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:["Estimated time remaining: ",(a=>{let b=Math.floor(a/1e3);if(b<60)return`${b}s`;let c=Math.floor(b/60);return`${c}m ${b%60}s`})(a.estimatedTimeRemaining)]})]})]}),(0,b.jsx)("div",{className:"space-y-4 mb-6",children:a.stages.map((a,c)=>(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(a=>{switch(a){case"completed":return(0,b.jsx)(g.CheckCircle,{className:"h-5 w-5 text-green-500"});case"in-progress":return(0,b.jsx)(q.Loader2,{className:"h-5 w-5 text-blue-500 animate-spin"});case"error":return(0,b.jsx)(r.XCircle,{className:"h-5 w-5 text-red-500"});default:return(0,b.jsx)(p.Circle,{className:"h-5 w-5 text-muted-foreground"})}})(a.status),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-foreground",children:a.name}),"in-progress"===a.status&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(a.progress),"%"]})]}),a.message&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.message}),a.error&&(0,b.jsx)("p",{className:"text-xs text-red-500 mt-1",children:a.error})]})]}),"in-progress"===a.status&&(0,b.jsx)(o.Progress,{value:a.progress,className:"h-1.5 ml-8"})]},c))}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4 pt-4 border-t border-border",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-foreground",children:a.totalRecords}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-500",children:a.processedRecords}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Processed"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-green-500",children:a.successfulRecords}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Success"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-red-500",children:a.failedRecords}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Failed"})]})]})]})}var u=a.i(205522),v=a.i(588237),w=a.i(887682),x=a.i(949191),y=a.i(674864),z=a.i(396860),A=a.i(844614),B=a.i(179869);function C({data:a,errors:d=[],warnings:f=[],duplicates:h=[],onEdit:i,onRemove:j}){let[k,l]=(0,c.useState)(""),[m,o]=(0,c.useState)("all"),[p,q]=(0,c.useState)(1),r=a=>{let b=d.some(b=>b.customer===a),c=f.some(b=>b.customer===a),e=h.some(b=>b.duplicate===a);return b?"error":e?"duplicate":c?"warning":"valid"},s=a.filter(a=>{let b=r(a),c="all"===m||"valid"===m&&"valid"===b||"errors"===m&&"error"===b||"warnings"===m&&"warning"===b||"duplicates"===m&&"duplicate"===b,d=!k||Object.values(a).some(a=>String(a).toLowerCase().includes(k.toLowerCase()));return c&&d}),t=Math.ceil(s.length/10),C=s.slice((p-1)*10,10*p),D={all:a.length,valid:a.filter(a=>"valid"===r(a)).length,errors:d.length,warnings:f.length,duplicates:h.length};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.Card,{className:"p-4 border-border",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(y.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(u.Input,{placeholder:"Search records...",value:k,onChange:a=>l(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(w.Select,{value:m,onValueChange:a=>o(a),children:[(0,b.jsxs)(w.SelectTrigger,{className:"w-48",children:[(0,b.jsx)(z.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(w.SelectValue,{})]}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsxs)(w.SelectItem,{value:"all",children:["All (",D.all,")"]}),(0,b.jsxs)(w.SelectItem,{value:"valid",children:["Valid (",D.valid,")"]}),(0,b.jsxs)(w.SelectItem,{value:"errors",children:["Errors (",D.errors,")"]}),(0,b.jsxs)(w.SelectItem,{value:"warnings",children:["Warnings (",D.warnings,")"]}),(0,b.jsxs)(w.SelectItem,{value:"duplicates",children:["Duplicates (",D.duplicates,")"]})]})]})]})}),(0,b.jsxs)(n.Card,{className:"border-border overflow-hidden",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(v.Table,{children:[(0,b.jsx)(v.TableHeader,{children:(0,b.jsxs)(v.TableRow,{children:[(0,b.jsx)(v.TableHead,{className:"w-12",children:"Status"}),(0,b.jsx)(v.TableHead,{children:"Contact Name"}),(0,b.jsx)(v.TableHead,{children:"Company"}),(0,b.jsx)(v.TableHead,{children:"Email"}),(0,b.jsx)(v.TableHead,{children:"Phone"}),(0,b.jsx)(v.TableHead,{children:"City"}),(0,b.jsx)(v.TableHead,{children:"State"}),(0,b.jsx)(v.TableHead,{className:"w-24",children:"Actions"})]})}),(0,b.jsx)(v.TableBody,{children:0===C.length?(0,b.jsx)(v.TableRow,{children:(0,b.jsx)(v.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No records found"})}):C.map((a,c)=>{let i,k,l,m=r(a),n=(i=d.find(b=>b.customer===a),k=f.find(b=>b.customer===a),l=h.find(b=>b.duplicate===a),{errors:i?.errors||[],warnings:k?.warnings||[],duplicate:l}),o=(p-1)*10+c;return(0,b.jsxs)(v.TableRow,{className:"error"===m?"bg-red-500/5":"",children:[(0,b.jsxs)(v.TableCell,{children:["valid"===m&&(0,b.jsx)(g.CheckCircle,{className:"h-5 w-5 text-green-500"}),"error"===m&&(0,b.jsx)(x.AlertCircle,{className:"h-5 w-5 text-red-500"}),"warning"===m&&(0,b.jsx)(x.AlertCircle,{className:"h-5 w-5 text-yellow-500"}),"duplicate"===m&&(0,b.jsx)(x.AlertCircle,{className:"h-5 w-5 text-orange-500"})]}),(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:a.contact_name}),n.errors.some(a=>"contact_name"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-500 mt-1",children:n.errors.find(a=>"contact_name"===a.field)?.message})]})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.company_name||"-"})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.email||"-"}),n.errors.some(a=>"email"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-500 mt-1",children:n.errors.find(a=>"email"===a.field)?.message}),n.warnings.some(a=>"email"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-yellow-500 mt-1",children:n.warnings.find(a=>"email"===a.field)?.message})]})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.phone||"-"})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.city||"-"})}),(0,b.jsx)(v.TableCell,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.state||"-"})}),(0,b.jsx)(v.TableCell,{children:j&&(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>j(o),className:"text-red-500 hover:text-red-600",children:"Remove"})})]},o)})})]})}),t>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t border-border",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",(p-1)*10+1," to"," ",Math.min(10*p,s.length)," of ",s.length," records"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>q(a=>Math.max(1,a-1)),disabled:1===p,children:(0,b.jsx)(A.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",p," of ",t]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>q(a=>Math.min(t,a+1)),disabled:p===t,children:(0,b.jsx)(B.ChevronRight,{className:"h-4 w-4"})})]})]})]})]})}var D=a.i(917171),E=a.i(982747);let F=[{value:"contact_name",label:"Contact Name",required:!0},{value:"company_name",label:"Company Name",required:!1},{value:"email",label:"Email",required:!1},{value:"phone",label:"Phone",required:!1},{value:"address_line1",label:"Address Line 1",required:!1},{value:"address_line2",label:"Address Line 2",required:!1},{value:"city",label:"City",required:!1},{value:"state",label:"State",required:!1},{value:"zip_code",label:"Zip Code",required:!1},{value:"country",label:"Country",required:!1},{value:"tax_id",label:"Tax ID",required:!1},{value:"notes",label:"Notes",required:!1}];function G({open:a,onOpenChange:f,sourceColumns:h,onConfirm:i}){let[j,k]=(0,c.useState)({}),l=F.filter(a=>a.required).every(a=>j[a.value]&&"skip"!==j[a.value]),m=()=>Object.values(j).filter(a=>a&&"skip"!==a).length;return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:f,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsx)(d.DialogTitle,{children:"Map Columns"}),(0,b.jsx)(d.DialogDescription,{children:"Map your file columns to the customer fields. Required fields are marked with an asterisk."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.Card,{className:"p-4 border-border bg-accent/5",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Mapping Progress"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[m()," of ",F.length," fields mapped"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.CheckCircle,{className:"h-5 w-5 text-green-500"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[Math.round(m()/F.length*100),"%"]})]})]})}),(0,b.jsx)("div",{className:"space-y-3",children:F.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 border border-border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)(D.Label,{className:"text-sm font-medium text-foreground",children:[a.label,a.required&&(0,b.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.required?"Required field":"Optional field"})]}),(0,b.jsx)(E.ArrowRight,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)(w.Select,{value:j[a.value]||"",onValueChange:b=>{var c;return c=a.value,void k(a=>({...a,[c]:b}))},children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{placeholder:"Select column..."})}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsx)(w.SelectItem,{value:"skip",children:"Skip this field"}),h.map(a=>(0,b.jsx)(w.SelectItem,{value:a,children:a},a))]})]})})]},a.value))}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-border",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>{i(j),f(!1)},disabled:!l,children:"Confirm Mapping"})]})]})]})})}var H=a.i(621958);a.s(["BulkUploadDialog",0,function({open:a,onOpenChange:i,onComplete:j}){let[k,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)("upload"),[s,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),[B,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),I=a=>{a.preventDefault(),a.stopPropagation(),"dragenter"===a.type||"dragover"===a.type?p(!0):"dragleave"===a.type&&p(!1)},J=async a=>{let b=a.name.split(".").pop()?.toLowerCase();if(!["csv","xlsx","xls","pdf"].includes(b||""))return void alert("Please upload a CSV, Excel, or PDF file");n(a),r("mapping");try{let c;c="csv"===b?await h.FileParser.parseCSV(a):"xlsx"===b||"xls"===b?await h.FileParser.parseExcel(a):await h.FileParser.parsePDF(a),u(c),c.data.length>0&&(Object.keys(c.data[0]),A(!0))}catch(a){console.error("Error parsing file:",a),alert("Failed to parse file. Please check the format and try again.")}},K=async a=>{y(a),A(!1),r("preview"),s&&w(await l.process(s.data,[]))},L=async()=>{if(!v||0===v.unique.length)return;r("processing");let a=new m(v.unique.length);D(a),a.subscribe(a=>{F(a)});try{a.startStage(0,"File parsed successfully"),a.completeStage(0),a.startStage(1,"Cleaning customer data..."),await new Promise(a=>setTimeout(a,500)),a.completeStage(1,`Cleaned ${v.cleaned.length} records`),a.startStage(2,"Validating records..."),await new Promise(a=>setTimeout(a,500)),a.completeStage(2,`${v.valid.length} valid records`),a.startStage(3,"Checking for duplicates..."),await new Promise(a=>setTimeout(a,500)),a.completeStage(3,`${v.duplicates.length} duplicates found`),a.startStage(4,"Uploading to database...");let b=[];for(let a=0;a<v.unique.length;a+=50)b.push(v.unique.slice(a,a+50));let c=0,d=0;for(let e=0;e<b.length;e++){(await fetch("/api/accounting/customers/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customers:b[e]})})).ok?c+=b[e].length:d+=b[e].length;let f=(e+1)/b.length*100;a.updateStageProgress(4,f,`Uploaded ${c} of ${v.unique.length} records`),a.updateRecordProgress(c+d,c,d)}a.completeStage(4,`Successfully uploaded ${c} customers`),setTimeout(()=>{j(),i(!1),M()},2e3)}catch(a){console.error("Error uploading customers:",a),B&&B.errorStage(4,"Failed to upload customers")}},M=()=>{n(null),u(null),w(null),y(null),r("upload"),D(null),F(null)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Dialog,{open:a,onOpenChange:i,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsx)(d.DialogTitle,{children:"Bulk Upload Customers"}),(0,b.jsx)(d.DialogDescription,{children:"Upload CSV, Excel, or PDF files with customer data. We'll automatically parse, clean, and validate the data."})]}),(0,b.jsxs)("div",{className:"space-y-6",children:["upload"===q&&(0,b.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${o?"border-accent bg-accent/5":"border-border"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:a=>{a.preventDefault(),a.stopPropagation(),p(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&J(a.dataTransfer.files[0])},children:[(0,b.jsx)(f.Upload,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-lg font-medium text-foreground mb-2",children:"Drag and drop your file here"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"or click to browse"}),(0,b.jsx)("input",{type:"file",id:"file-upload",className:"hidden",accept:".csv,.xlsx,.xls,.pdf",onChange:a=>{a.target.files&&a.target.files[0]&&J(a.target.files[0])}}),(0,b.jsx)("label",{htmlFor:"file-upload",children:(0,b.jsx)(e.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)("span",{children:"Choose File"})})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"Supported formats: CSV, Excel (.xlsx, .xls), PDF"})]}),"preview"===q&&v&&(0,b.jsxs)(H.Tabs,{defaultValue:"all",className:"w-full",children:[(0,b.jsxs)(H.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsxs)(H.TabsTrigger,{value:"all",children:["All (",v.stats.totalInput,")"]}),(0,b.jsxs)(H.TabsTrigger,{value:"valid",children:["Valid (",v.stats.valid,")"]}),(0,b.jsxs)(H.TabsTrigger,{value:"errors",children:["Errors (",v.stats.invalid,")"]}),(0,b.jsxs)(H.TabsTrigger,{value:"duplicates",children:["Duplicates (",v.stats.duplicates,")"]})]}),(0,b.jsx)(H.TabsContent,{value:"all",className:"mt-4",children:(0,b.jsx)(C,{data:v.cleaned,errors:v.invalid,warnings:v.warnings,duplicates:v.duplicates})}),(0,b.jsx)(H.TabsContent,{value:"valid",className:"mt-4",children:(0,b.jsx)(C,{data:v.valid})}),(0,b.jsx)(H.TabsContent,{value:"errors",className:"mt-4",children:(0,b.jsx)(C,{data:v.invalid.map(a=>a.customer),errors:v.invalid})}),(0,b.jsx)(H.TabsContent,{value:"duplicates",className:"mt-4",children:(0,b.jsx)(C,{data:v.duplicates.map(a=>a.duplicate),duplicates:v.duplicates})})]}),"processing"===q&&E&&(0,b.jsx)(t,{progress:E}),"preview"===q&&v&&(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:M,children:"Start Over"}),(0,b.jsxs)(e.Button,{onClick:L,disabled:0===v.unique.length,className:"gap-2",children:[(0,b.jsx)(g.CheckCircle,{className:"h-4 w-4"}),"Upload ",v.unique.length," Customer",1!==v.unique.length?"s":""]})]})]})]})}),s&&(0,b.jsx)(G,{open:z,onOpenChange:A,sourceColumns:s.data.length>0?Object.keys(s.data[0]):[],onConfirm:K})]})}],699876)}];

//# sourceMappingURL=components_bulk-upload-dialog_tsx_9f552cb4._.js.map