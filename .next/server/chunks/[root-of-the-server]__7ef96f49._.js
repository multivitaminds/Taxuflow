module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},644913,(e,t,r)=>{"use strict";t.exports=e.r(918622)},558553,(e,t,r)=>{"use strict";t.exports=e.r(644913).vendored["react-rsc"].React},976281,(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,o={},l={RequestCookies:()=>f,ResponseCookies:()=>g,parseCookie:()=>d,parseSetCookie:()=>p,stringifyCookie:()=>c};for(var u in l)a(o,u,{get:l[u],enumerable:!0});function c(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),a=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?a:`${a}; ${r.join("; ")}`}function d(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[a,n]=[r.slice(0,e),r.slice(e+1)];try{t.set(a,decodeURIComponent(null!=n?n:"true"))}catch{}}return t}function p(e){if(!e)return;let[[t,r],...a]=d(e),{domain:n,expires:s,httponly:i,maxage:o,path:l,samesite:u,secure:c,partitioned:p,priority:f}=Object.fromEntries(a.map(([e,t])=>[e.toLowerCase().replace(/-/g,""),t]));{var g,x,v={name:t,value:decodeURIComponent(r),domain:n,...s&&{expires:new Date(s)},...i&&{httpOnly:!0},..."string"==typeof o&&{maxAge:Number(o)},path:l,...u&&{sameSite:m.includes(g=(g=u).toLowerCase())?g:void 0},...c&&{secure:!0},...f&&{priority:h.includes(x=(x=f).toLowerCase())?x:void 0},...p&&{partitioned:!0}};let e={};for(let t in v)v[t]&&(e[t]=v[t]);return e}}t.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of s(t))i.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(o=n(t,r))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);var m=["strict","lax","none"],h=["low","medium","high"],f=class{constructor(e){this._parsed=new Map,this._headers=e;const t=e.get("cookie");if(t)for(const[e,r]of d(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===a).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,a=this._parsed;return a.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(a).map(([e,t])=>c(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>c(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},g=class{constructor(e){var t,r,a;this._parsed=new Map,this._headers=e;const n=null!=(a=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?a:[];for(const e of Array.isArray(n)?n:function(e){if(!e)return[];var t,r,a,n,s,i=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,s=!1;l();)if(","===(r=e.charAt(o))){for(a=o,o+=1,l(),n=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(s=!0,o=n,i.push(e.substring(t,a)),t=o):o=a+1}else o+=1;(!s||o>=e.length)&&i.push(e.substring(t,e.length))}return i}(n)){const t=p(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===a)}has(e){return this._parsed.has(e)}set(...e){let[t,r,a]=1===e.length?[e[0].name,e[0].value,e[0]]:e,n=this._parsed;return n.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...a})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=c(r);t.append("set-cookie",e)}}(n,this._headers),this}delete(...e){let[t,r]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...r,name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(c).join("; ")}}},110043,e=>{"use strict";e.i(392229);var t=e.i(929094),r=e.i(295986);async function a(){let e=await (0,r.cookies)();return(0,t.createServerClient)("https://auth.taxu.io","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nbXBpeXppZXFhbHVzcHN6bnZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzMDg2MzksImV4cCI6MjA3NTg4NDYzOX0.jlyovoe8I1_BV0i1BexuJ_2MfhGDkQGYyqx9ri97UGQ",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:a})=>e.set(t,r,a))}catch{}}}})}async function n(){return a()}async function s(){try{return await a()}catch(e){return console.error("[v0] Failed to create Supabase client:",e),null}}e.s(["createClient",0,a,"createClientSafe",0,s,"getSupabaseServerClient",0,n])},883051,(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,o={},l={VercelOidcTokenError:()=>c};for(var u in l)a(o,u,{get:l[u],enumerable:!0});t.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of s(t))i.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(o=n(t,r))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);class c extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},268830,e=>{"use strict";var t=e.i(682544),r=e.i(477416),a=e.i(888760),n=e.i(178890),s=e.i(685495),i=e.i(590424),o=e.i(333238),l=e.i(531427),u=e.i(172393),c=e.i(501598),d=e.i(133377),p=e.i(15902),m=e.i(115676),h=e.i(110214),f=e.i(376296),g=e.i(193695);e.i(633637);var x=e.i(712539),v=e.i(70996),y=e.i(701230),b=e.i(419142),R=e.i(110043);async function w(e){try{let{messages:t,userId:r,context:a}=await e.json(),n=await (0,R.createClient)(),{data:{user:s}}=await n.auth.getUser();if(!s)return new Response("Unauthorized",{status:401});let{data:i}=await n.from("user_profiles").select("*").eq("id",s.id).single(),{data:o}=await n.from("documents").select("file_name, ai_document_type, extracted_data").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(10),l=`You are an expert tax advisor powered by GPT-4o-mini, optimized for fast and accurate tax assistance.

EXPERTISE:
- Deep knowledge of US tax law (IRS regulations, tax code, recent changes)
- Tax optimization strategies
- Deduction discovery and maximization
- Audit risk assessment
- Tax planning and forecasting

USER CONTEXT:
${i?`Name: ${i.full_name}
Business: ${i.business_name||"Individual"}`:"New user"}

RECENT DOCUMENTS:
${o?.map(e=>`- ${e.file_name} (${e.ai_document_type})`).join("\n")||"No documents uploaded yet"}

INSTRUCTIONS:
1. Provide accurate, detailed tax advice
2. Cite specific IRS regulations when relevant
3. Explain complex concepts simply
4. Suggest optimization strategies proactively
5. Warn about audit risks
6. Always prioritize legal compliance

IMPORTANT: You are NOT a substitute for a licensed CPA or tax attorney. For complex situations, recommend consulting a professional.`;return(await (0,v.streamText)({model:"openai/gpt-4o-mini",messages:t,system:l,temperature:.3,maxTokens:4e3,tools:{calculateTax:(0,y.tool)({description:"Calculate estimated tax based on income and deductions",parameters:b.z.object({income:b.z.number().describe("Total income"),deductions:b.z.number().describe("Total deductions"),filingStatus:b.z.enum(["single","married_joint","married_separate","head_of_household"])}),execute:async({income:e,deductions:t,filingStatus:r})=>{let a=Math.max(0,e-t),n=0;return"single"===r&&(n=a<=11600?.1*a:a<=47150?1160+(a-11600)*.12:a<=100525?5426+(a-47150)*.22:17168.5+(a-100525)*.24),{taxableIncome:a,estimatedTax:Math.round(n),effectiveTaxRate:(n/e*100).toFixed(2)+"%"}}}),findDeductions:(0,y.tool)({description:"Search for applicable tax deductions based on user situation",parameters:b.z.object({userType:b.z.enum(["individual","business","freelancer"]),categories:b.z.array(b.z.string()).describe("Categories to search: home_office, vehicle, travel, etc")}),execute:async({userType:e,categories:t})=>{let r={home_office:{name:"Home Office Deduction",maxAmount:1500,requirements:"Exclusive and regular use for business",irs_form:"Form 8829"},vehicle:{name:"Business Vehicle Deduction",mileageRate:.67,requirements:"Track business miles with log",irs_form:"Schedule C"}};return t.map(e=>r[e]||null).filter(Boolean)}})},maxSteps:5})).toUIMessageStreamResponse()}catch(e){return console.error("[Tax Assistant Error]",e),new Response(JSON.stringify({error:"Failed to process request"}),{status:500})}}e.s(["POST",0,w,"maxDuration",0,60],717974);var _=e.i(717974);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/tax-assistant/route",pathname:"/api/tax-assistant",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/taxu-platform/v0-taxu-landing-page/app/api/tax-assistant/route.ts",nextConfigOutput:"",userland:_}),{workAsyncStorage:A,workUnitAsyncStorage:E,serverHooks:S}=C;async function O(e,t,a){C.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/tax-assistant/route";v=v.replace(/\/index$/,"")||"/";let y=await C.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:b,params:R,nextConfig:w,parsedUrl:_,isDraftMode:A,prerenderManifest:E,routerServerContext:S,isOnDemandRevalidate:O,revalidateOnlyGenerated:T,resolvedPathname:k,clientReferenceManifest:j,serverActionsManifest:N}=y,I=(0,o.normalizeAppPath)(v),P=!!(E.dynamicRoutes[I]||E.routes[k]),$=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,_,!1):t.end("This page could not be found"),null);if(P&&!A){let e=!!E.routes[k],t=E.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await $();throw new g.NoFallbackError}}let D=null;!P||C.isDev||A||(D="/index"===(D=k)?"/":D);let U=!0===C.isDev||!P,M=P&&!U;N&&j&&(0,i.setManifestsSingleton)({page:v,clientReferenceManifest:j,serverActionsManifest:N});let q=e.method||"GET",z=(0,s.getTracer)(),H=z.getActiveScopeSpan(),F={params:R,prerenderManifest:E,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>C.onRequestError(e,t,a,n,S)},sharedContext:{buildId:b}},B=new l.NodeNextRequest(e),X=new l.NodeNextResponse(t),J=u.NextRequestAdapter.fromNodeNextRequest(B,(0,u.signalFromNodeResponse)(t));try{let i=async e=>C.handle(J,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=z.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${q} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${v}`)}),o=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!o&&O&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(n);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!P)return await (0,p.sendResponse)(B,X,s,F.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,a=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:O})},!1,S),t}},c=await C.handleResponse({req:e,nextConfig:w,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:E,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:T,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:o});if(!P)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",O?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&P||g.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,h.getCacheControlHeader)(c.cacheControl)),await (0,p.sendResponse)(B,X,new Response(c.value.body,{headers:g,status:c.value.status||200})),null};H?await l(H):await z.withPropagatedContext(e.headers,()=>z.trace(c.BaseServerSpan.handleRequest,{spanName:`${q} ${v}`,kind:s.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:O})},!1,S),P)throw t;return await (0,p.sendResponse)(B,X,new Response(null,{status:500})),null}}e.s(["handler",0,O,"patchFetch",0,function(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:E})},"routeModule",0,C,"serverHooks",0,S,"workAsyncStorage",0,A,"workUnitAsyncStorage",0,E],268830)},819623,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__578b36f1._.js"].map(t=>e.l(t))).then(()=>t(443410)))},941867,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__ba837d10._.js"].map(t=>e.l(t))).then(()=>t(778382)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7ef96f49._.js.map