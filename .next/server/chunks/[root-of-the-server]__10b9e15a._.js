module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},577779,(e,t,r)=>{"use strict";t.exports=e.r(918622)},958492,(e,t,r)=>{"use strict";t.exports=e.r(577779).vendored["react-rsc"].React},464811,(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,i={},l={RequestCookies:()=>g,ResponseCookies:()=>f,parseCookie:()=>c,parseSetCookie:()=>d,stringifyCookie:()=>p};for(var u in l)a(i,u,{get:l[u],enumerable:!0});function p(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),a=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?a:`${a}; ${r.join("; ")}`}function c(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[a,n]=[r.slice(0,e),r.slice(e+1)];try{t.set(a,decodeURIComponent(null!=n?n:"true"))}catch{}}return t}function d(e){if(!e)return;let[[t,r],...a]=c(e),{domain:n,expires:s,httponly:o,maxage:i,path:l,samesite:u,secure:p,partitioned:d,priority:g}=Object.fromEntries(a.map(([e,t])=>[e.toLowerCase().replace(/-/g,""),t]));{var f,v,y={name:t,value:decodeURIComponent(r),domain:n,...s&&{expires:new Date(s)},...o&&{httpOnly:!0},..."string"==typeof i&&{maxAge:Number(i)},path:l,...u&&{sameSite:h.includes(f=(f=u).toLowerCase())?f:void 0},...p&&{secure:!0},...g&&{priority:m.includes(v=(v=g).toLowerCase())?v:void 0},...d&&{partitioned:!0}};let e={};for(let t in y)y[t]&&(e[t]=y[t]);return e}}t.exports=((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of s(t))o.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(i=n(t,r))||i.enumerable});return e})(a({},"__esModule",{value:!0}),i);var h=["strict","lax","none"],m=["low","medium","high"],g=class{constructor(e){this._parsed=new Map,this._headers=e;const t=e.get("cookie");if(t)for(const[e,r]of c(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===a).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,a=this._parsed;return a.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(a).map(([e,t])=>p(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>p(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},f=class{constructor(e){var t,r,a;this._parsed=new Map,this._headers=e;const n=null!=(a=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?a:[];for(const e of Array.isArray(n)?n:function(e){if(!e)return[];var t,r,a,n,s,o=[],i=0;function l(){for(;i<e.length&&/\s/.test(e.charAt(i));)i+=1;return i<e.length}for(;i<e.length;){for(t=i,s=!1;l();)if(","===(r=e.charAt(i))){for(a=i,i+=1,l(),n=i;i<e.length&&"="!==(r=e.charAt(i))&&";"!==r&&","!==r;)i+=1;i<e.length&&"="===e.charAt(i)?(s=!0,i=n,o.push(e.substring(t,a)),t=i):i=a+1}else i+=1;(!s||i>=e.length)&&o.push(e.substring(t,e.length))}return o}(n)){const t=d(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===a)}has(e){return this._parsed.has(e)}set(...e){let[t,r,a]=1===e.length?[e[0].name,e[0].value,e[0]]:e,n=this._parsed;return n.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...a})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=p(r);t.append("set-cookie",e)}}(n,this._headers),this}delete(...e){let[t,r]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...r,name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(p).join("; ")}}},456699,e=>{"use strict";e.i(929961);var t=e.i(771884),r=e.i(666753);async function a(){let e=await (0,r.cookies)(),a=process.env.NEXT_PUBLIC_SUPABASE_URL||process.env.SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||process.env.SUPABASE_ANON_KEY;return a&&n?(0,t.createServerClient)(a,n,{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:a})=>e.set(t,r,a))}catch{}}}}):(console.log("[v0] Running in preview mode without Supabase configuration"),null)}async function n(){return a()}async function s(){try{return await a()}catch(e){return console.error("[v0] Failed to create Supabase client:",e),null}}e.s(["createClient",0,a,"createClientSafe",0,s,"getSupabaseServerClient",0,n])},773939,(e,t,r)=>{"use strict";var a=Object.defineProperty,n=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,i={},l={VercelOidcTokenError:()=>p};for(var u in l)a(i,u,{get:l[u],enumerable:!0});t.exports=((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of s(t))o.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(i=n(t,r))||i.enumerable});return e})(a({},"__esModule",{value:!0}),i);class p extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},861154,e=>{"use strict";var t=e.i(516850),r=e.i(371100),a=e.i(397035),n=e.i(873968),s=e.i(649549),o=e.i(961840),i=e.i(153224),l=e.i(307998),u=e.i(529137),p=e.i(399762),c=e.i(650651),d=e.i(909836),h=e.i(518468),m=e.i(381254),g=e.i(808862),f=e.i(193695);e.i(164196);var v=e.i(534815),y=e.i(573703),x=e.i(456699);async function _(e){try{let t,r=await (0,x.getSupabaseServerClient)();if(!r)return console.error("[v0] Supabase client unavailable"),Response.json({error:"Service temporarily unavailable",details:"Database connection failed"},{status:503});try{let{data:{user:e}}=await r.auth.getUser();t=e}catch(e){return console.error("[v0] Auth error:",e),Response.json({error:"Authentication failed",details:"Unable to verify user session"},{status:401})}if(!t)return console.error("[v0] Unauthorized letter generation attempt"),Response.json({error:"Unauthorized",details:"Please log in to generate letters"},{status:401});let{businessName:a,ein:n,taxYear:s,formType:o,reason:i,additionalContext:l}=await e.json();console.log("[v0] Generating penalty abatement letter for:",a,"User:",t.email);let u=Date.now(),{text:p,usage:c}=await (0,y.generateText)({model:"openai/gpt-4o",prompt:`Generate a professional IRS penalty abatement request letter.

Details:
- Business/Taxpayer Name: ${a}
- EIN: ${n}
- Tax Year: ${s}
- Form Type: ${o}
- Reason for Late Filing: ${i}
${l?`- Additional Context: ${l}`:""}

The letter should:
1. Be addressed to the IRS
2. Reference "reasonable cause" provisions under IRC Section 6651
3. Explain the specific circumstances that caused the late filing
4. Request penalty waiver or abatement
5. Express commitment to future compliance
6. Use professional, respectful tone
7. Be formatted as a formal business letter
8. Include placeholders for signature and date

Make it persuasive but honest. Focus on reasonable cause arguments that the IRS typically accepts.`,temperature:.7,maxTokens:1500}),d=Date.now()-u;console.log("[v0] Generated abatement letter successfully");try{let{error:e}=await r.from("ai_usage_logs").insert({user_id:t.id,feature:"penalty_abatement_letter",model:"gpt-4o",provider:"openai",tokens_used:c?.totalTokens||0,input_tokens:c?.promptTokens||0,output_tokens:c?.completionTokens||0,estimated_cost:3e-5*(c?.totalTokens||0),request_data:{businessName:a,formType:o,taxYear:s,reason:i},response_data:{letterLength:p.length},prompt_length:500,response_length:p.length,duration_ms:d,status:"success"});e&&console.error("[v0] Failed to log AI usage:",e)}catch(e){console.error("[v0] AI usage logging error:",e)}return Response.json({letter:p,generatedAt:new Date().toISOString()})}catch(e){console.error("[v0] Abatement letter generation error:",e);try{let t=await (0,x.getSupabaseServerClient)(),{data:{user:r}}=await t.auth.getUser();r&&await t.from("ai_usage_logs").insert({user_id:r.id,feature:"penalty_abatement_letter",model:"gpt-4o",provider:"openai",status:"error",error_message:e instanceof Error?e.message:"Unknown error"})}catch{}return Response.json({error:"Failed to generate letter",details:e instanceof Error?e.message:"Unknown error occurred"},{status:500})}}e.s(["POST",0,_,"maxDuration",0,30],357353);var b=e.i(357353);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/generate-abatement-letter/route",pathname:"/api/generate-abatement-letter",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/generate-abatement-letter/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:w,workUnitAsyncStorage:A,serverHooks:S}=R;async function E(e,t,a){R.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/generate-abatement-letter/route";y=y.replace(/\/index$/,"")||"/";let x=await R.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:_,params:b,nextConfig:w,parsedUrl:A,isDraftMode:S,prerenderManifest:E,routerServerContext:C,isOnDemandRevalidate:k,revalidateOnlyGenerated:O,resolvedPathname:P,clientReferenceManifest:j,serverActionsManifest:T}=x,U=(0,i.normalizeAppPath)(y),N=!!(E.dynamicRoutes[U]||E.routes[P]),$=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,A,!1):t.end("This page could not be found"),null);if(N&&!S){let e=!!E.routes[P],t=E.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await $();throw new f.NoFallbackError}}let I=null;!N||R.isDev||S||(I="/index"===(I=P)?"/":I);let D=!0===R.isDev||!N,q=N&&!D;T&&j&&(0,o.setManifestsSingleton)({page:y,clientReferenceManifest:j,serverActionsManifest:T});let M=e.method||"GET",H=(0,s.getTracer)(),B=H.getActiveScopeSpan(),F={params:b,prerenderManifest:E,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>R.onRequestError(e,t,a,n,C)},sharedContext:{buildId:_}},L=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),G=u.NextRequestAdapter.fromNodeNextRequest(L,(0,u.signalFromNodeResponse)(t));try{let o=async e=>R.handle(G,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=H.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${M} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${y}`)}),i=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!i&&k&&O&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!N)return await (0,d.sendResponse)(L,K,s,F.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[g.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,a=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:k})},!1,C),t}},p=await R.handleResponse({req:e,nextConfig:w,cacheKey:I,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:E,isRoutePPREnabled:!1,isOnDemandRevalidate:k,revalidateOnlyGenerated:O,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:i});if(!N)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",k?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,h.fromNodeOutgoingHttpHeaders)(p.value.headers);return i&&N||f.delete(g.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,m.getCacheControlHeader)(p.cacheControl)),await (0,d.sendResponse)(L,K,new Response(p.value.body,{headers:f,status:p.value.status||200})),null};B?await l(B):await H.withPropagatedContext(e.headers,()=>H.trace(p.BaseServerSpan.handleRequest,{spanName:`${M} ${y}`,kind:s.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:k})},!1,C),N)throw t;return await (0,d.sendResponse)(L,K,new Response(null,{status:500})),null}}e.s(["handler",0,E,"patchFetch",0,function(){return(0,a.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:A})},"routeModule",0,R,"serverHooks",0,S,"workAsyncStorage",0,w,"workUnitAsyncStorage",0,A],861154)},216653,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__560e8385._.js"].map(t=>e.l(t))).then(()=>t(439609)))},792892,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__628a6cf5._.js"].map(t=>e.l(t))).then(()=>t(927791)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__10b9e15a._.js.map