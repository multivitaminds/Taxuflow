module.exports=[746024,e=>{"use strict";var t=e.i(516850),i=e.i(371100),r=e.i(397035),n=e.i(873968),a=e.i(649549),o=e.i(961840),s=e.i(153224),l=e.i(307998),d=e.i(529137),c=e.i(399762),u=e.i(650651),p=e.i(909836),m=e.i(518468),g=e.i(381254),v=e.i(808862),h=e.i(193695);e.i(164196);var f=e.i(534815),_=e.i(861874),R=e.i(663126);if(!process.env.STRIPE_SECRET_KEY)throw Error("STRIPE_SECRET_KEY is not set");let P=new R.default(process.env.STRIPE_SECRET_KEY,{apiVersion:"2024-11-20.acacia",typescript:!0});var x=e.i(456699);let E=[{id:"basic-w2",name:"Basic / Simple (W-2 Only)",price:49,priceId:"price_basic_w2_49",interval:"one-time",category:"individual",description:"W-2 filing with AI error checking",comparePrice:89,savings:"Save $40 vs TurboTax Deluxe",features:["W-2 filing and import","AI-powered error checking","Federal e-file included","Standard deduction","Refund tracking","Email support","IRS accuracy guarantee"]},{id:"plus-families",name:"Plus (Families, Homeowners, Investors)",price:99,priceId:"price_plus_99",interval:"one-time",category:"individual",description:"For complex returns with deductions and investments",popular:!0,comparePrice:149,savings:"Save $50 vs TurboTax Premier",features:["Everything in Basic","Itemized deductions","Mortgage interest deduction","Multiple W-2s and 1099s","Investment income (stocks, crypto)","Dependent management","Child tax credits","State filing included","Priority email support","Audit risk assessment"]},{id:"self-employed",name:"Self-Employed / Gig Worker",price:179,priceId:"price_self_employed_179",interval:"one-time",category:"individual",description:"1099 filing with AI bookkeeping and write-offs",comparePrice:249,savings:"Save $70 vs TurboTax Self-Employed",features:["Everything in Plus","Schedule C filing","1099-NEC and 1099-K filing","AI-powered expense tracking","Business write-offs maximizer","Mileage tracking and logging","Home office deduction","Quarterly tax estimates","Self-employment tax optimization","AI bookkeeping assistant","Unlimited tax questions"]},{id:"cpa-assisted",name:"Full CPA Assisted (Live Help)",price:299,priceId:"price_cpa_assisted_299",interval:"one-time",category:"individual",description:"CPA review with audit protection and unlimited support",comparePrice:499,savings:"Save $200 vs TurboTax Live Full Service",features:["Everything in Self-Employed","Dedicated CPA review","Unlimited tax expert consultations","Phone and video support","Audit defense and representation","IRS correspondence handling","Year-round tax planning","Priority filing (24-hour turnaround)","Tax strategy consultation","Peace of mind guarantee"]},{id:"business-basic",name:"Business Basic (Single-Member LLC)",price:399,priceId:"price_business_basic_399",interval:"one-time",category:"business",description:"Schedule C and LLC filing with AI bookkeeping",comparePrice:650,savings:"Save $251 vs traditional CPA",features:["Schedule C filing","Single-member LLC support","1099 contractor management","AI bookkeeping guidance","Quarterly estimated taxes","Expense categorization","Profit & loss statements","State business filing","Business deduction maximizer"]},{id:"business-pro",name:"Business Pro (S-Corp, Partnership)",price:799,priceId:"price_business_pro_799",interval:"one-time",category:"business",description:"S-Corp, Partnership with payroll and AI cleanup",comparePrice:1500,savings:"Save $701 vs traditional CPA",features:["Everything in Business Basic","Form 1120S (S-Corp filing)","Form 1065 (Partnership filing)","K-1 generation for partners","Payroll tax filing (Form 941)","W-2 and 1099 bulk filing","AI bookkeeping cleanup","QuickBooks integration","Monthly financial close assistance","Multi-state nexus analysis","Dedicated business advisor"]},{id:"enterprise",name:"Enterprise (Multi-State, Complex)",price:1499,priceId:"price_enterprise_1499",interval:"one-time",category:"business",description:"Corporate filings with dedicated support",comparePrice:5e3,savings:"Save $3,501 vs traditional CPA firm",features:["Everything in Business Pro","Form 1120 (C-Corp filing)","Multi-state tax compliance","Sales tax nexus analysis","International tax considerations","R&D tax credit analysis","Corporate structure optimization","Monthly bookkeeping service","Dedicated CFO-level advisor","24/7 priority support","Custom integrations","White-glove onboarding"]}],y=[{id:"state-return",name:"State Return",price:35,priceId:"addon_state_35",description:"Additional state tax return filing",turbotaxPrice:60},{id:"audit-defense",name:"Audit Defense",price:89,priceId:"addon_audit_89",description:"Full IRS audit representation and support",turbotaxPrice:150},{id:"crypto-import",name:"Crypto Tax Import",price:49,priceId:"addon_crypto_49",description:"Import and calculate crypto gains/losses",turbotaxPrice:99},{id:"prior-year",name:"Prior Year Return",price:49,priceId:"addon_prior_year_49",description:"File an amended or prior year tax return",turbotaxPrice:99},{id:"estimated-tax",name:"Estimated Tax Setup",price:79,priceId:"addon_estimated_79",description:"Quarterly estimated tax calculation and reminders"},{id:"bookkeeping-cleanup",name:"Bookkeeping Cleanup",price:150,priceId:"addon_bookkeeping_monthly_150",description:"Monthly AI-powered bookkeeping cleanup service"}];async function C(e){try{console.log("[v0] Checkout API called");let{planId:t,addOnId:i}=await e.json();if(console.log("[v0] Plan ID:",t,"Add-on ID:",i),!t&&!i)return _.NextResponse.json({error:"Plan ID or Add-on ID is required"},{status:400});let r=null;if(t){let e=E.find(e=>e.id===t);if(!e)return console.log("[v0] Invalid plan ID:",t),_.NextResponse.json({error:"Invalid plan"},{status:400});r={name:e.name,description:e.description,price:e.price,interval:e.interval},console.log("[v0] Plan found:",e.name,e.price)}else if(i){let e=y.find(e=>e.id===i);if(!e)return console.log("[v0] Invalid add-on ID:",i),_.NextResponse.json({error:"Invalid add-on"},{status:400});r={name:e.name,description:e.description,price:e.price,interval:null},console.log("[v0] Add-on found:",e.name,e.price)}if(!r)return _.NextResponse.json({error:"Invalid item"},{status:400});let n=process.env.NEXT_PUBLIC_SUPABASE_URL&&process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,a=process.env.STRIPE_SECRET_KEY;if(!n||!a)return console.log("[v0] Missing API keys, defaulting to demo mode immediately"),_.NextResponse.json({url:`${process.env.NEXT_PUBLIC_APP_URL||"https://taxu.io"}/dashboard/subscription?success=true&${t?`plan=${t}`:`addon=${i}`}&demo=true`});if(0===r.price)return _.NextResponse.json({error:"Free items don't require checkout"},{status:400});let o=await (0,x.createClientSafe)();if(!o)return console.log("[v0] Supabase client failed to initialize, returning demo mode"),_.NextResponse.json({url:`${process.env.NEXT_PUBLIC_APP_URL||"https://taxu.io"}/dashboard/subscription?success=true&${t?`plan=${t}`:`addon=${i}`}&demo=true`});let{data:{user:s}}=await o.auth.getUser();if(!s)return console.log("[v0] No user found, returning mock success"),_.NextResponse.json({url:`${process.env.NEXT_PUBLIC_APP_URL||"https://taxu.io"}/dashboard/subscription?success=true&${t?`plan=${t}`:`addon=${i}`}&demo=true`});console.log("[v0] User authenticated:",s.id);let{data:l}=await o.from("user_profiles").select("stripe_customer_id, email, full_name").eq("id",s.id).single();console.log("[v0] User profile:",l);let d=l?.stripe_customer_id;d||(console.log("[v0] Creating new Stripe customer"),d=(await P.customers.create({email:l?.email||s.email,name:l?.full_name,metadata:{supabase_user_id:s.id}})).id,console.log("[v0] Created customer:",d),await o.from("user_profiles").update({stripe_customer_id:d}).eq("id",s.id));let c=r.interval&&"one-time"!==r.interval;console.log("[v0] Creating checkout session, mode:",c?"subscription":"payment");let u=await P.checkout.sessions.create({customer:d,mode:c?"subscription":"payment",line_items:[{price_data:{currency:"usd",product_data:{name:r.name,description:r.description},unit_amount:Math.round(100*r.price),...c?{recurring:{interval:r.interval}}:{}},quantity:1}],success_url:`${process.env.NEXT_PUBLIC_APP_URL||"https://taxu.io"}/dashboard/subscription?success=true&${t?`plan=${t}`:`addon=${i}`}`,cancel_url:`${process.env.NEXT_PUBLIC_APP_URL||"https://taxu.io"}/dashboard/subscription?canceled=true`,metadata:{supabase_user_id:s.id,...t?{plan_id:t,planId:t}:{},...i?{addon_id:i,addOnId:i}:{}}});return console.log("[v0] Checkout session created:",u.id),_.NextResponse.json({url:u.url})}catch(e){return console.error("[v0] Checkout error:",e),_.NextResponse.json({error:"Failed to create checkout session",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["POST",0,C],752073);var I=e.i(752073);let b=new t.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/checkout/route",pathname:"/api/checkout",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/checkout/route.ts",nextConfigOutput:"",userland:I}),{workAsyncStorage:S,workUnitAsyncStorage:A,serverHooks:w}=b;async function k(e,t,r){b.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let _="/api/checkout/route";_=_.replace(/\/index$/,"")||"/";let R=await b.prepare(e,t,{srcPage:_,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:P,params:x,nextConfig:E,parsedUrl:y,isDraftMode:C,prerenderManifest:I,routerServerContext:S,isOnDemandRevalidate:A,revalidateOnlyGenerated:w,resolvedPathname:k,clientReferenceManifest:T,serverActionsManifest:N}=R,U=(0,s.normalizeAppPath)(_),$=!!(I.dynamicRoutes[U]||I.routes[k]),B=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,y,!1):t.end("This page could not be found"),null);if($&&!C){let e=!!I.routes[k],t=I.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await B();throw new h.NoFallbackError}}let D=null;!$||b.isDev||C||(D="/index"===(D=k)?"/":D);let L=!0===b.isDev||!$,O=$&&!L;N&&T&&(0,o.setManifestsSingleton)({page:_,clientReferenceManifest:T,serverActionsManifest:N});let M=e.method||"GET",F=(0,a.getTracer)(),q=F.getActiveScopeSpan(),H={params:x,prerenderManifest:I,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,r,n)=>b.onRequestError(e,t,r,n,S)},sharedContext:{buildId:P}},j=new l.NodeNextRequest(e),K=new l.NodeNextResponse(t),X=d.NextRequestAdapter.fromNodeNextRequest(j,(0,d.signalFromNodeResponse)(t));try{let o=async e=>b.handle(X,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=F.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=i.get("next.route");if(r){let t=`${M} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${_}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var a,l;let d=async({previousCacheEntry:i})=>{try{if(!s&&A&&w&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await o(n);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let d=H.renderOpts.collectedTags;if(!$)return await (0,p.sendResponse)(j,K,a,H.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(a.headers);d&&(t[v.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,r=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:f.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:r}}}}catch(t){throw(null==i?void 0:i.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:A})},!1,S),t}},c=await b.handleResponse({req:e,nextConfig:E,cacheKey:D,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:I,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:w,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:s});if(!$)return null;if((null==c||null==(a=c.value)?void 0:a.kind)!==f.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",A?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let h=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&$||h.delete(v.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||h.get("Cache-Control")||h.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,p.sendResponse)(j,K,new Response(c.value.body,{headers:h,status:c.value.status||200})),null};q?await l(q):await F.withPropagatedContext(e.headers,()=>F.trace(c.BaseServerSpan.handleRequest,{spanName:`${M} ${_}`,kind:a.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},l))}catch(t){if(t instanceof h.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:A})},!1,S),$)throw t;return await (0,p.sendResponse)(j,K,new Response(null,{status:500})),null}}e.s(["handler",0,k,"patchFetch",0,function(){return(0,r.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:A})},"routeModule",0,b,"serverHooks",0,w,"workAsyncStorage",0,S,"workUnitAsyncStorage",0,A],746024)}];

//# sourceMappingURL=d319d_next_dist_esm_build_templates_app-route_fcf4a594.js.map