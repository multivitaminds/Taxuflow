module.exports=[81111,(e,i,r)=>{i.exports=e.x("node:stream",()=>require("node:stream"))},300878,e=>{"use strict";var i=e.i(84710);e.s(["FilingStatusEmail",0,function({userName:e,filingType:r,status:s,submissionId:n,refundAmount:t,rejectionReasons:a,dashboardUrl:o}){return(0,i.jsxs)("html",{children:[(0,i.jsx)("head",{children:(0,i.jsx)("style",{children:`
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; background: #f3f4f6; }
          .container { max-width: 600px; margin: 40px auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
          .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px 30px; text-align: center; }
          .header h1 { color: white; margin: 0; font-size: 28px; }
          .content { padding: 40px 30px; }
          .status-badge { display: inline-block; padding: 12px 24px; border-radius: 8px; font-weight: 600; margin: 20px 0; }
          .button { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 32px; border-radius: 8px; text-decoration: none; font-weight: 600; margin: 20px 0; }
          .footer { background: #f9fafb; padding: 30px; text-align: center; color: #6b7280; font-size: 14px; }
          .rejection-list { background: #fef2f2; border-left: 4px solid #ef4444; padding: 16px; margin: 20px 0; border-radius: 4px; }
        `})}),(0,i.jsx)("body",{children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)("div",{className:"header",children:(0,i.jsx)("h1",{children:"Taxu"})}),(0,i.jsxs)("div",{className:"content",children:[(0,i.jsxs)("h2",{children:["Hi ",e,","]}),(0,i.jsx)("p",{style:{fontSize:"16px",lineHeight:"1.6",color:"#374151"},children:{accepted:"Your tax return has been accepted by the IRS! ðŸŽ‰",rejected:"Your tax return was rejected and needs attention.",pending:"Your tax return is being processed."}[s]}),(0,i.jsxs)("div",{className:"status-badge",style:{background:{accepted:"#10b981",rejected:"#ef4444",pending:"#f59e0b"}[s],color:"white"},children:[s.toUpperCase()," - ",r]}),(0,i.jsxs)("p",{style:{color:"#6b7280",fontSize:"14px"},children:["Submission ID: ",n]}),"accepted"===s&&t&&t>0&&(0,i.jsxs)("div",{style:{background:"#f0fdf4",padding:"20px",borderRadius:"8px",margin:"20px 0"},children:[(0,i.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#166534"},children:"Expected Refund"}),(0,i.jsxs)("p",{style:{margin:"8px 0 0 0",fontSize:"32px",fontWeight:"bold",color:"#15803d"},children:["$",t.toLocaleString()]})]}),"rejected"===s&&a&&a.length>0&&(0,i.jsxs)("div",{className:"rejection-list",children:[(0,i.jsx)("p",{style:{fontWeight:"600",color:"#991b1b",margin:"0 0 12px 0"},children:"Rejection Reasons:"}),(0,i.jsx)("ul",{style:{margin:0,paddingLeft:"20px",color:"#7f1d1d"},children:a.map((e,r)=>(0,i.jsx)("li",{style:{marginBottom:"8px"},children:e},r))})]}),(0,i.jsx)("a",{href:o,className:"button",children:"View in Dashboard"}),(0,i.jsxs)("p",{style:{fontSize:"14px",color:"#6b7280",marginTop:"30px"},children:["accepted"===s&&"Your refund will be processed by the IRS within 21 days.","rejected"===s&&"Please review the rejection reasons and resubmit your corrected return.","pending"===s&&"We'll notify you as soon as the IRS processes your return."]})]}),(0,i.jsxs)("div",{className:"footer",children:[(0,i.jsx)("p",{children:"Â© 2025 Taxu. All rights reserved."}),(0,i.jsx)("p",{children:(0,i.jsx)("a",{href:`${o}/settings/notifications`,style:{color:"#667eea"},children:"Manage email preferences"})})]})]})})]})}])},289098,e=>{"use strict";var i=e.i(84710);e.s(["DocumentProcessedEmail",0,function({userName:e,documentName:r,documentType:s,extractedData:n,dashboardUrl:t}){return(0,i.jsxs)("html",{children:[(0,i.jsx)("head",{children:(0,i.jsx)("style",{children:`
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; background: #f3f4f6; }
          .container { max-width: 600px; margin: 40px auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
          .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px 30px; text-align: center; }
          .header h1 { color: white; margin: 0; font-size: 28px; }
          .content { padding: 40px 30px; }
          .data-card { background: #f9fafb; border-radius: 8px; padding: 20px; margin: 20px 0; }
          .button { display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 32px; border-radius: 8px; text-decoration: none; font-weight: 600; margin: 20px 0; }
          .footer { background: #f9fafb; padding: 30px; text-align: center; color: #6b7280; font-size: 14px; }
        `})}),(0,i.jsx)("body",{children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)("div",{className:"header",children:(0,i.jsx)("h1",{children:"Taxu"})}),(0,i.jsxs)("div",{className:"content",children:[(0,i.jsxs)("h2",{children:["Hi ",e,","]}),(0,i.jsx)("p",{style:{fontSize:"16px",lineHeight:"1.6",color:"#374151"},children:"Your document has been processed successfully! âœ¨"}),(0,i.jsxs)("div",{className:"data-card",children:[(0,i.jsx)("p",{style:{fontWeight:"600",margin:"0 0 12px 0",color:"#111827"},children:"Document Details"}),(0,i.jsxs)("p",{style:{margin:"8px 0",color:"#6b7280"},children:[(0,i.jsx)("strong",{children:"Name:"})," ",r]}),(0,i.jsxs)("p",{style:{margin:"8px 0",color:"#6b7280"},children:[(0,i.jsx)("strong",{children:"Type:"})," ",s]})]}),Object.keys(n).length>0&&(0,i.jsxs)("div",{className:"data-card",children:[(0,i.jsx)("p",{style:{fontWeight:"600",margin:"0 0 12px 0",color:"#111827"},children:"Extracted Information"}),Object.entries(n).map(([e,r])=>(0,i.jsxs)("p",{style:{margin:"8px 0",color:"#6b7280"},children:[(0,i.jsxs)("strong",{children:[e,":"]})," ",String(r)]},e))]}),(0,i.jsx)("a",{href:t,className:"button",children:"View Document"}),(0,i.jsx)("p",{style:{fontSize:"14px",color:"#6b7280",marginTop:"30px"},children:"Review the extracted data and use it to file your taxes or add it to your accounting records."})]}),(0,i.jsxs)("div",{className:"footer",children:[(0,i.jsx)("p",{children:"Â© 2025 Taxu. All rights reserved."}),(0,i.jsx)("p",{children:(0,i.jsx)("a",{href:`${t}/settings/notifications`,style:{color:"#667eea"},children:"Manage email preferences"})})]})]})})]})}])},134138,e=>e.a(async(i,r)=>{try{var s=e.i(456699),n=e.i(644075),t=e.i(300878),a=e.i(289098),o=i([n]);[n]=o.then?(await o)():o;let p=process.env.RESEND_API_KEY;async function d({to:e,subject:i,html:r,userId:n,emailType:t}){try{let a=await fetch("https://api.resend.com/emails",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({from:"Taxu <notifications@taxu.io>",to:e,subject:i,html:r})}),o=await a.json();if(!a.ok)throw Error(o.message||"Failed to send email");let d=await (0,s.createClient)();return await d.from("email_logs").insert({user_id:n,email_to:e,email_type:t,subject:i,status:"sent",provider_id:o.id}),console.log("[v0] âœ… Email sent successfully:",o.id),{success:!0,id:o.id}}catch(r){if(console.error("[v0] âŒ Failed to send email:",r),n){let a=await (0,s.createClient)();await a.from("email_logs").insert({user_id:n,email_to:e,email_type:t,subject:i,status:"failed",error_message:r instanceof Error?r.message:"Unknown error"})}return{success:!1,error:r}}}async function c(e,i,r,a){let o=await (0,s.createClient)(),{data:c}=await o.from("email_preferences").select("*").eq("user_id",e).single();if(c&&!c.filing_updates)return void console.log("[v0] User has disabled filing update emails");let l=(0,n.render)((0,t.FilingStatusEmail)({userName:r,filingType:a.form_type,status:a.filing_status,submissionId:a.submission_id,refundAmount:a.refund_amount,rejectionReasons:a.rejection_reasons,dashboardUrl:`${process.env.NEXT_PUBLIC_APP_URL}/dashboard/filing/${a.id}`})),p="accepted"===a.filing_status?"Accepted":"rejected"===a.filing_status?"Rejected":"Updated";await d({to:i,subject:`Your ${a.form_type} Filing Has Been ${p}`,html:l,userId:e,emailType:"filing_status"})}async function l(e,i,r,t){let o=await (0,s.createClient)(),{data:c}=await o.from("email_preferences").select("*").eq("user_id",e).single();if(c&&!c.document_processing)return void console.log("[v0] User has disabled document processing emails");let l=(0,n.render)((0,a.DocumentProcessedEmail)({userName:r,documentName:t.file_name,documentType:t.document_type,extractedData:t.extracted_data||{},dashboardUrl:`${process.env.NEXT_PUBLIC_APP_URL}/dashboard/documents/${t.id}`}));await d({to:i,subject:`Your ${t.document_type} Has Been Processed`,html:l,userId:e,emailType:"document_processed"})}e.s(["sendDocumentProcessedEmail",0,l,"sendEmail",0,d,"sendFilingStatusEmail",0,c]),r()}catch(e){r(e)}},!1),620782,e=>{e.v(i=>Promise.all(["server/chunks/[externals]__1990d4c1._.js","server/chunks/d319d_next_dist_compiled_f7db8ec7._.js"].map(i=>e.l(i))).then(()=>i(281326)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f57cd5f1._.js.map