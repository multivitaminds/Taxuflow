(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,792249,(e,t,s)=>{var r;let i;e.e,r=function e(){var t,s="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==s?s:{},r=!s.document&&!!s.postMessage,i=s.IS_PAPA_WORKER||!1,a={},n=0,l={};function o(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var t=v(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new m(t),(this._handle.streamer=this)._config=t}).call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(a=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,a)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&void 0!==(a=this._config.beforeFirstChunk(e))&&(e=a),this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e,a=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=a.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),a&&a.data&&(this._rowCount+=a.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,i)s.postMessage({results:a,workerId:l.WORKER_ID,finished:r});else if(S(this._config.chunk)&&!t){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=a=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!r||!S(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){S(this._config.error)?this._config.error(e):i&&this._config.error&&s.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=l.RemoteChunkSize),o.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,s,i=this._config.downloadRequestHeaders;for(s in i)t.setRequestHeader(s,i[s])}this._config.chunkSize&&(e=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+e));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){let e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(e=(e=t).getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(Error(e))}}function c(e){(e=e||{}).chunkSize||(e.chunkSize=l.LocalChunkSize),o.call(this,e);var t,s,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,s=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,i=(this._config.chunkSize&&(i=Math.min(this._start+this._config.chunkSize,this._input.size),e=s.call(e,this._start,i)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function h(e){var t;o.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,s;if(!this._finished)return t=(e=this._config.chunkSize)?(s=t.substring(0,e),t.substring(e)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function u(e){o.call(this,e=e||{});var t=[],s=!0,r=!1;this.pause=function(){o.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){o.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):s=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),s&&(s=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(e){var t,s,r,i,a=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,n=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,o=this,d=0,c=0,h=!1,u=!1,m=[],g={data:[],errors:[],meta:{}};function x(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function _(){if(g&&r&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(g.data=g.data.filter(function(e){return!x(e)})),y()){if(g)if(Array.isArray(g.data[0])){for(var t,s=0;y()&&s<g.data.length;s++)g.data[s].forEach(i);g.data.splice(0,1)}else g.data.forEach(i);function i(t,s){S(e.transformHeader)&&(t=e.transformHeader(t,s)),m.push(t)}}function o(t,s){for(var r=e.header?{}:[],i=0;i<t.length;i++){var l=i,o=t[i],o=((t,s)=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping))?"true"===s||"TRUE"===s||"false"!==s&&"FALSE"!==s&&((e=>{if(a.test(e)&&-0x20000000000000<(e=parseFloat(e))&&e<0x20000000000000)return 1})(s)?parseFloat(s):n.test(s)?new Date(s):""===s?null:s):s)(l=e.header?i>=m.length?"__parsed_extra":m[i]:l,o=e.transform?e.transform(o,l):o);"__parsed_extra"===l?(r[l]=r[l]||[],r[l].push(o)):r[l]=o}return e.header&&(i>m.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+i,c+s):i<m.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+i,c+s)),r}g&&(e.header||e.dynamicTyping||e.transform)&&(t=1,!g.data.length||Array.isArray(g.data[0])?(g.data=g.data.map(o),t=g.data.length):g.data=o(g.data,0),e.header&&g.meta&&(g.meta.fields=m),c+=t)}function y(){return e.header&&0===m.length}function C(e,t,s,r){e={type:e,code:t,message:s},void 0!==r&&(e.row=r),g.errors.push(e)}S(e.step)&&(i=e.step,e.step=function(t){g=t,y()?_():(_(),0!==g.data.length&&(d+=t.data.length,e.preview&&d>e.preview?s.abort():(g.data=g.data[0],i(g,o))))}),this.parse=function(i,a,n){var o=e.quoteChar||'"',o=(e.newline||(e.newline=this.guessLineEndings(i,o)),r=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(i),g.meta.delimiter=e.delimiter):((o=((t,s,r,i,a)=>{var n,o,d,c;a=a||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var h=0;h<a.length;h++){for(var u,m=a[h],p=0,g=0,_=0,v=(d=void 0,new f({comments:i,delimiter:m,newline:s,preview:10}).parse(t)),y=0;y<v.data.length;y++)r&&x(v.data[y])?_++:(g+=u=v.data[y].length,void 0===d?d=u:0<u&&(p+=Math.abs(u-d),d=u));0<v.data.length&&(g/=v.data.length-_),(void 0===o||p<=o)&&(void 0===c||c<g)&&1.99<g&&(o=p,n=m,c=g)}return{successful:!!(e.delimiter=n),bestDelimiter:n}})(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=o.bestDelimiter:(r=!0,e.delimiter=l.DefaultDelimiter),g.meta.delimiter=e.delimiter),v(e));return e.preview&&e.header&&o.preview++,t=i,g=(s=new f(o)).parse(t,a,n),_(),h?{meta:{paused:!0}}:g||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,s.abort(),t=S(e.chunk)?"":t.substring(s.getCharIndex())},this.resume=function(){o.streamer._halted?(h=!1,o.streamer.parseChunk(t,!0)):setTimeout(o.resume,3)},this.aborted=function(){return u},this.abort=function(){u=!0,s.abort(),g.meta.aborted=!0,S(e.complete)&&e.complete(g),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576);var t=RegExp(p(t)+"([^]*?)"+p(t),"gm"),s=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<s[0].length;if(1===s.length||e)return"\n";for(var r=0,i=0;i<s.length;i++)"\n"===s[i][0]&&r++;return r>=s.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(e){var t=(e=e||{}).delimiter,s=e.newline,r=e.comments,i=e.step,a=e.preview,n=e.fastMode,o=null,d=!1,c=null==e.quoteChar?'"':e.quoteChar,h=c;if(void 0!==e.escapeChar&&(h=e.escapeChar),("string"!=typeof t||-1<l.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<l.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==s&&"\r"!==s&&"\r\n"!==s&&(s="\n");var u=0,m=!1;this.parse=function(l,f,g){if("string"!=typeof l)throw Error("Input must be a string");var x=l.length,_=t.length,v=s.length,y=r.length,C=S(i),b=[],j=[],N=[],w=u=0;if(!l)return F();if(n||!1!==n&&-1===l.indexOf(c)){for(var E=l.split(s),A=0;A<E.length;A++){if(N=E[A],u+=N.length,A!==E.length-1)u+=s.length;else if(g)break;if(!r||N.substring(0,y)!==r){if(C){if(b=[],D(N.split(t)),U(),m)return F()}else D(N.split(t));if(a&&a<=A)return b=b.slice(0,a),F(!0)}}return F()}for(var T=l.indexOf(t,u),R=l.indexOf(s,u),k=RegExp(p(h)+p(c),"g"),I=l.indexOf(c,u);;)if(l[u]===c)for(I=u,u++;;){if(-1===(I=l.indexOf(c,I+1)))return g||j.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:u}),L();if(I===x-1)return L(l.substring(u,I).replace(k,c));if(c===h&&l[I+1]===h)I++;else if(c===h||0===I||l[I-1]!==h){-1!==T&&T<I+1&&(T=l.indexOf(t,I+1));var O=M(-1===(R=-1!==R&&R<I+1?l.indexOf(s,I+1):R)?T:Math.min(T,R));if(l.substr(I+1+O,_)===t){N.push(l.substring(u,I).replace(k,c)),l[u=I+1+O+_]!==c&&(I=l.indexOf(c,u)),T=l.indexOf(t,u),R=l.indexOf(s,u);break}if(O=M(R),l.substring(I+1+O,I+1+O+v)===s){if(N.push(l.substring(u,I).replace(k,c)),P(I+1+O+v),T=l.indexOf(t,u),I=l.indexOf(c,u),C&&(U(),m))return F();if(a&&b.length>=a)return F(!0);break}j.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:u}),I++}}else if(r&&0===N.length&&l.substring(u,u+y)===r){if(-1===R)return F();u=R+v,R=l.indexOf(s,u),T=l.indexOf(t,u)}else if(-1!==T&&(T<R||-1===R))N.push(l.substring(u,T)),u=T+_,T=l.indexOf(t,u);else{if(-1===R)break;if(N.push(l.substring(u,R)),P(R+v),C&&(U(),m))return F();if(a&&b.length>=a)return F(!0)}return L();function D(e){b.push(e),w=u}function M(e){return -1!==e&&(e=l.substring(I+1,e))&&""===e.trim()?e.length:0}function L(e){return g||(void 0===e&&(e=l.substring(u)),N.push(e),u=x,D(N),C&&U()),F()}function P(e){u=e,D(N),N=[],R=l.indexOf(s,u)}function F(r){if(e.header&&!f&&b.length&&!d){var i=b[0],a=Object.create(null),n=new Set(i);let t=!1;for(let s=0;s<i.length;s++){let r=i[s];if(a[r=S(e.transformHeader)?e.transformHeader(r,s):r]){let e,l=a[r];for(;e=r+"_"+l,l++,n.has(e););n.add(e),i[s]=e,a[r]++,t=!0,(o=null===o?{}:o)[e]=r}else a[r]=1,i[s]=r;n.add(r)}t&&console.warn("Duplicate headers found and renamed."),d=!0}return{data:b,errors:j,meta:{delimiter:t,linebreak:s,aborted:m,truncated:!!r,cursor:w+(f||0),renamedHeaders:o}}}function U(){i(F()),b=[],j=[]}},this.abort=function(){m=!0},this.getCharIndex=function(){return u}}function g(e){var t=e.data,s=a[t.workerId],r=!1;if(t.error)s.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,x(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:_,resume:_};if(S(s.userStep)){for(var n=0;n<t.results.data.length&&(s.userStep({data:t.results.data[n],errors:t.results.errors,meta:t.results.meta},i),!r);n++);delete t.results}else S(s.userChunk)&&(s.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&x(t.workerId,t.results)}function x(e,t){var s=a[e];S(s.userComplete)&&s.userComplete(t),s.terminate(),delete a[e]}function _(){throw Error("Not implemented.")}function v(e){if("object"!=typeof e||null===e)return e;var t,s=Array.isArray(e)?[]:{};for(t in e)s[t]=v(e[t]);return s}function y(e,t){return function(){e.apply(t,arguments)}}function S(e){return"function"==typeof e}return l.parse=function(t,r){var i,o,m,p=(r=r||{}).dynamicTyping||!1;if(S(p)&&(r.dynamicTypingFunction=p,p={}),r.dynamicTyping=p,r.transform=!!S(r.transform)&&r.transform,!r.worker||!l.WORKERS_SUPPORTED){let e;return p=null,l.NODE_STREAM_INPUT,"string"==typeof t?(t=65279!==(e=t).charCodeAt(0)?e:e.slice(1),p=new(r.download?d:h)(r)):!0===t.readable&&S(t.read)&&S(t.on)?p=new u(r):(s.File&&t instanceof File||t instanceof Object)&&(p=new c(r)),p.stream(t)}(p=!!l.WORKERS_SUPPORTED&&(o=s.URL||s.webkitURL||null,m=e.toString(),i=l.BLOB_URL||(l.BLOB_URL=o.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",m,")();"],{type:"text/javascript"}))),(i=new s.Worker(i)).onmessage=g,i.id=n++,a[i.id]=i)).userStep=r.step,p.userChunk=r.chunk,p.userComplete=r.complete,p.userError=r.error,r.step=S(r.step),r.chunk=S(r.chunk),r.complete=S(r.complete),r.error=S(r.error),delete r.worker,p.postMessage({input:t,config:r,workerId:p.id})},l.unparse=function(e,t){var s=!1,r=!0,i=",",a="\r\n",n='"',o=n+n,d=!1,c=null,h=!1,u=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||l.BAD_DELIMITERS.filter(function(e){return -1!==t.delimiter.indexOf(e)}).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(s=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(d=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(n=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(o=t.escapeChar+n),t.escapeFormulae instanceof RegExp?h=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(h=/^[=+\-@\t\r].*$/)}})(),RegExp(p(n),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return m(null,e,d);if("object"==typeof e[0])return m(c||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),m(e.fields||[],e.data||[],d);throw Error("Unable to serialize unrecognized input");function m(e,t,s){var n="",l=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),o=!Array.isArray(t[0]);if(l&&r){for(var d=0;d<e.length;d++)0<d&&(n+=i),n+=f(e[d],d);0<t.length&&(n+=a)}for(var c=0;c<t.length;c++){var h=(l?e:t[c]).length,u=!1,m=l?0===Object.keys(t[c]).length:0===t[c].length;if(s&&!l&&(u="greedy"===s?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===s&&l){for(var p=[],g=0;g<h;g++){var x=o?e[g]:g;p.push(t[c][x])}u=""===p.join("").trim()}if(!u){for(var _=0;_<h;_++){0<_&&!m&&(n+=i);var v=l&&o?e[_]:_;n+=f(t[c][v],_)}c<t.length-1&&(!s||0<h&&!m)&&(n+=a)}}return n}function f(e,t){var r,a;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(a=!1,h&&"string"==typeof e&&h.test(e)&&(e="'"+e,a=!0),r=e.toString().replace(u,o),(a=a||!0===s||"function"==typeof s&&s(e,t)||Array.isArray(s)&&s[t]||((e,t)=>{for(var s=0;s<t.length;s++)if(-1<e.indexOf(t[s]))return!0;return!1})(r,l.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?n+r+n:r)}},l.RECORD_SEP="\x1e",l.UNIT_SEP="\x1f",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r","\n",'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!r&&!!s.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=0xa00000,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=f,l.ParserHandle=m,l.NetworkStreamer=d,l.FileStreamer=c,l.StringStreamer=h,l.ReadableStreamStreamer=u,s.jQuery&&((t=s.jQuery).fn.parse=function(e){var r=e.config||{},i=[];return this.each(function(e){if(!("INPUT"===t(this).prop("tagName").toUpperCase()&&"file"===t(this).attr("type").toLowerCase()&&s.FileReader)||!this.files||0===this.files.length)return!0;for(var a=0;a<this.files.length;a++)i.push({file:this.files[a],inputElem:this,instanceConfig:t.extend({},r)})}),a(),this;function a(){if(0===i.length)S(e.complete)&&e.complete();else{var s,r,a,o=i[0];if(S(e.before)){var d=e.before(o.file,o.inputElem);if("object"==typeof d){if("abort"===d.action)return s=o.file,r=o.inputElem,a=d.reason,void(S(e.error)&&e.error({name:"AbortError"},s,r,a));if("skip"===d.action)return void n();"object"==typeof d.config&&(o.instanceConfig=t.extend(o.instanceConfig,d.config))}else if("skip"===d)return void n()}var c=o.instanceConfig.complete;o.instanceConfig.complete=function(e){S(c)&&c(e,o.file,o.inputElem),n()},l.parse(o.file,o.instanceConfig)}}function n(){i.splice(0,1),a()}}),i&&(s.onmessage=function(e){e=e.data,void 0===l.WORKER_ID&&e&&(l.WORKER_ID=e.workerId),"string"==typeof e.input?s.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0}):(s.File&&e.input instanceof File||e.input instanceof Object)&&(e=l.parse(e.input,e.config))&&s.postMessage({workerId:l.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(o.prototype)).constructor=d,(c.prototype=Object.create(o.prototype)).constructor=c,(h.prototype=Object.create(h.prototype)).constructor=h,(u.prototype=Object.create(o.prototype)).constructor=u,l},"function"==typeof define&&define.amd?void 0!==(i=r())&&e.v(i):t.exports=r()},397874,e=>{"use strict";var t=e.i(437322),s=e.i(949161),r=e.i(814479),i=e.i(363284),a=e.i(679411),n=e.i(904697),l=e.i(792249);class o{static async parseCSV(e){return new Promise(t=>{l.default.parse(e,{header:!0,skipEmptyLines:!0,complete:e=>{t(this.processCSVData(e.data))},error:e=>{t({data:[],errors:[{row:0,field:"file",message:e.message}],warnings:[],totalRows:0,validRows:0})}})})}static async parseExcel(e){return this.parseCSV(e)}static async parsePDF(e){return{data:[],errors:[{row:0,field:"file",message:"PDF parsing requires OCR integration"}],warnings:[],totalRows:0,validRows:0}}static processCSVData(e){let t=[],s=[],r=[];return e.forEach((e,i)=>{let a=i+2,n=this.mapRowToCustomer(e);n.contact_name&&""!==n.contact_name.trim()?(n.email&&!this.isValidEmail(n.email)&&r.push({row:a,field:"email",message:"Invalid email format"}),n.phone&&!this.isValidPhone(n.phone)&&r.push({row:a,field:"phone",message:"Invalid phone format"}),t.push(n)):s.push({row:a,field:"contact_name",message:"Contact name is required"})}),{data:t,errors:s,warnings:r,totalRows:e.length,validRows:t.length}}static mapRowToCustomer(e){let t=t=>{for(let s of t){let t=e[s]||e[s.toLowerCase()]||e[s.toUpperCase()];if(t)return String(t).trim()}};return{contact_name:t(["contact_name","name","customer_name","full_name","Contact Name","Name"])||"",company_name:t(["company_name","company","business_name","Company Name","Company"]),email:t(["email","email_address","Email","Email Address"]),phone:t(["phone","phone_number","telephone","Phone","Phone Number"]),address_line1:t(["address_line1","address","street","Address","Street"]),address_line2:t(["address_line2","address2","suite","Address 2"]),city:t(["city","City"]),state:t(["state","State","province","Province"]),zip_code:t(["zip_code","zip","postal_code","Zip Code","ZIP"]),country:t(["country","Country"])||"US",tax_id:t(["tax_id","ein","ssn","Tax ID","EIN"]),notes:t(["notes","comments","Notes","Comments"])}}static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static isValidPhone(e){let t=e.replace(/\D/g,"");return t.length>=10&&t.length<=11}}class d{static cleanCustomerData(e){return e.map(e=>this.cleanRecord(e))}static cleanRecord(e){return{contact_name:this.cleanName(e.contact_name),company_name:this.cleanName(e.company_name),email:this.cleanEmail(e.email),phone:this.cleanPhone(e.phone),address_line1:this.cleanAddress(e.address_line1),address_line2:this.cleanAddress(e.address_line2),city:this.cleanCity(e.city),state:this.cleanState(e.state),zip_code:this.cleanZipCode(e.zip_code),country:this.cleanCountry(e.country),tax_id:this.cleanTaxId(e.tax_id),notes:this.cleanNotes(e.notes)}}static cleanName(e){if(e)return String(e).trim().replace(/\s+/g," ").replace(/[^\w\s\-'.]/g,"")}static cleanEmail(e){if(e)return String(e).trim().toLowerCase()}static cleanPhone(e){if(!e)return;let t=String(e).replace(/\D/g,"");return 10===t.length?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:11===t.length&&"1"===t[0]?`+1 (${t.slice(1,4)}) ${t.slice(4,7)}-${t.slice(7)}`:t}static cleanAddress(e){if(e)return String(e).trim().replace(/\s+/g," ")}static cleanCity(e){if(e)return String(e).trim().replace(/\s+/g," ").replace(/\b\w/g,e=>e.toUpperCase())}static cleanState(e){if(!e)return;let t=String(e).trim().toUpperCase();return({ALABAMA:"AL",ALASKA:"AK",ARIZONA:"AZ",ARKANSAS:"AR",CALIFORNIA:"CA",COLORADO:"CO",CONNECTICUT:"CT",DELAWARE:"DE",FLORIDA:"FL",GEORGIA:"GA",HAWAII:"HI",IDAHO:"ID",ILLINOIS:"IL",INDIANA:"IN",IOWA:"IA",KANSAS:"KS",KENTUCKY:"KY",LOUISIANA:"LA",MAINE:"ME",MARYLAND:"MD",MASSACHUSETTS:"MA",MICHIGAN:"MI",MINNESOTA:"MN",MISSISSIPPI:"MS",MISSOURI:"MO",MONTANA:"MT",NEBRASKA:"NE",NEVADA:"NV","NEW HAMPSHIRE":"NH","NEW JERSEY":"NJ","NEW MEXICO":"NM","NEW YORK":"NY","NORTH CAROLINA":"NC","NORTH DAKOTA":"ND",OHIO:"OH",OKLAHOMA:"OK",OREGON:"OR",PENNSYLVANIA:"PA","RHODE ISLAND":"RI","SOUTH CAROLINA":"SC","SOUTH DAKOTA":"SD",TENNESSEE:"TN",TEXAS:"TX",UTAH:"UT",VERMONT:"VT",VIRGINIA:"VA",WASHINGTON:"WA","WEST VIRGINIA":"WV",WISCONSIN:"WI",WYOMING:"WY"})[t]||t}static cleanZipCode(e){if(!e)return;let t=String(e).replace(/\D/g,"");if(5===t.length);else if(9===t.length)return`${t.slice(0,5)}-${t.slice(5)}`;return t}static cleanCountry(e){if(!e)return"US";let t=String(e).trim().toUpperCase();return({"UNITED STATES":"US",USA:"US",AMERICA:"US",CANADA:"CA",MEXICO:"MX","UNITED KINGDOM":"GB",UK:"GB"})[t]||t}static cleanTaxId(e){if(e)return String(e).replace(/[^a-zA-Z0-9]/g,"")}static cleanNotes(e){if(e)return String(e).trim()}}class c{static validateCustomer(e){let t=[],s=[];return e.contact_name&&""!==e.contact_name.trim()||t.push({field:"contact_name",message:"Contact name is required"}),e.email?this.isValidEmail(e.email)||t.push({field:"email",message:"Invalid email format"}):s.push({field:"email",message:"Email is recommended for customer communication"}),e.phone&&!this.isValidPhone(e.phone)&&s.push({field:"phone",message:"Phone number format may be invalid"}),e.state&&!this.isValidState(e.state)&&s.push({field:"state",message:"State code may be invalid"}),e.zip_code&&!this.isValidZipCode(e.zip_code)&&s.push({field:"zip_code",message:"Zip code format may be invalid"}),e.tax_id&&!this.isValidTaxId(e.tax_id)&&s.push({field:"tax_id",message:"Tax ID format may be invalid"}),e.address_line1&&!e.city&&s.push({field:"city",message:"City is recommended when address is provided"}),e.address_line1&&!e.state&&s.push({field:"state",message:"State is recommended when address is provided"}),e.address_line1&&!e.zip_code&&s.push({field:"zip_code",message:"Zip code is recommended when address is provided"}),{isValid:0===t.length,errors:t,warnings:s}}static validateBatch(e){let t=[],s=[],r=[];return e.forEach(e=>{let i=this.validateCustomer(e);i.isValid?(t.push(e),i.warnings.length>0&&r.push({customer:e,warnings:i.warnings})):s.push({customer:e,errors:i.errors})}),{valid:t,invalid:s,warnings:r}}static isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static isValidPhone(e){let t=e.replace(/\D/g,"");return t.length>=10&&t.length<=11}static isValidState(e){return["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"].includes(e.toUpperCase())}static isValidZipCode(e){return/^\d{5}(-\d{4})?$/.test(e)}static isValidTaxId(e){return 9===e.replace(/\D/g,"").length}}class h{static findDuplicates(e,t=[]){[...t,...e];let s=[],r=[],i=new Set;return e.forEach((a,n)=>{if(i.has(n))return;let l=!1;for(let e of t){let t=this.calculateMatch(a,e);if(t.matchScore>=.8){r.push({original:e,duplicate:a,matchScore:t.matchScore,matchFields:t.matchFields}),l=!0;break}}if(!l)for(let t=n+1;t<e.length;t++){if(i.has(t))continue;let s=this.calculateMatch(a,e[t]);if(s.matchScore>=.8){r.push({original:a,duplicate:e[t],matchScore:s.matchScore,matchFields:s.matchFields}),i.add(t),l=!0;break}}l||s.push(a)}),{unique:s,duplicates:r}}static calculateMatch(e,t){let s=[],r=0,i=0;if(e.email&&t.email&&(i+=.4,this.normalizeString(e.email)===this.normalizeString(t.email)&&(r+=.4,s.push("email"))),e.phone&&t.phone&&(i+=.3,e.phone.replace(/\D/g,"")===t.phone.replace(/\D/g,"")&&(r+=.3,s.push("phone"))),e.contact_name&&t.contact_name){i+=.2;let a=this.calculateStringSimilarity(this.normalizeString(e.contact_name),this.normalizeString(t.contact_name));a>.8&&(r+=.2*a,s.push("contact_name"))}if(e.company_name&&t.company_name){i+=.1;let a=this.calculateStringSimilarity(this.normalizeString(e.company_name),this.normalizeString(t.company_name));a>.8&&(r+=.1*a,s.push("company_name"))}return{matchScore:i>0?r/i:0,matchFields:s}}static normalizeString(e){return e.toLowerCase().trim().replace(/\s+/g," ")}static calculateStringSimilarity(e,t){let s=e.length,r=t.length,i=[];for(let e=0;e<=s;e++)i[e]=[e];for(let e=0;e<=r;e++)i[0][e]=e;for(let a=1;a<=s;a++)for(let s=1;s<=r;s++){let r=+(e[a-1]!==t[s-1]);i[a][s]=Math.min(i[a-1][s]+1,i[a][s-1]+1,i[a-1][s-1]+r)}let a=i[s][r],n=Math.max(s,r);return 0===n?1:1-a/n}}class u{static async process(e,t=[]){let s=d.cleanCustomerData(e),{valid:r,invalid:i,warnings:a}=c.validateBatch(s),{unique:n,duplicates:l}=h.findDuplicates(r,t),o={totalInput:e.length,cleaned:s.length,valid:r.length,invalid:i.length,duplicates:l.length,readyForImport:n.length};return{cleaned:s,valid:r,invalid:i,warnings:a,duplicates:l,unique:n,stats:o}}}class m{progress;listeners=[];constructor(e){this.progress={stages:[{name:"Parsing File",status:"pending",progress:0},{name:"Cleaning Data",status:"pending",progress:0},{name:"Validating Records",status:"pending",progress:0},{name:"Checking Duplicates",status:"pending",progress:0},{name:"Uploading to Database",status:"pending",progress:0}],currentStage:0,overallProgress:0,totalRecords:e,processedRecords:0,successfulRecords:0,failedRecords:0,startTime:Date.now()}}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notify(){this.listeners.forEach(e=>e({...this.progress}))}startStage(e,t){this.progress.currentStage=e,this.progress.stages[e].status="in-progress",this.progress.stages[e].progress=0,t&&(this.progress.stages[e].message=t),this.updateOverallProgress(),this.notify()}updateStageProgress(e,t,s){this.progress.stages[e].progress=Math.min(100,Math.max(0,t)),s&&(this.progress.stages[e].message=s),this.updateOverallProgress(),this.notify()}completeStage(e,t){this.progress.stages[e].status="completed",this.progress.stages[e].progress=100,t&&(this.progress.stages[e].message=t),this.updateOverallProgress(),this.notify()}errorStage(e,t){this.progress.stages[e].status="error",this.progress.stages[e].error=t,this.updateOverallProgress(),this.notify()}updateRecordProgress(e,t,s){this.progress.processedRecords=e,this.progress.successfulRecords=t,this.progress.failedRecords=s,this.updateEstimatedTime(),this.notify()}updateOverallProgress(){let e=this.progress.stages.length,t=this.progress.stages.filter(e=>"completed"===e.status).length,s=this.progress.stages[this.progress.currentStage]?.progress||0;this.progress.overallProgress=(t+s/100)/e*100}updateEstimatedTime(){let e=Date.now()-this.progress.startTime,t=this.progress.processedRecords;if(t>0){let s=this.progress.totalRecords-t;this.progress.estimatedTimeRemaining=Math.ceil(e/t*s)}}getProgress(){return{...this.progress}}}var p=e.i(594950),f=e.i(29518),g=e.i(832334),x=e.i(187189),_=e.i(384231),v=e.i(408173);function y({progress:e}){return(0,t.jsxs)(p.Card,{className:"p-6 border-border",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Upload Progress"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:[Math.round(e.overallProgress),"%"]})]}),(0,t.jsx)(f.Progress,{value:e.overallProgress,className:"h-3"}),e.estimatedTimeRemaining&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[(0,t.jsx)(v.Clock,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Estimated time remaining: ",(e=>{let t=Math.floor(e/1e3);if(t<60)return`${t}s`;let s=Math.floor(t/60);return`${s}m ${t%60}s`})(e.estimatedTimeRemaining)]})]})]}),(0,t.jsx)("div",{className:"space-y-4 mb-6",children:e.stages.map((e,s)=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch(e){case"completed":return(0,t.jsx)(n.CheckCircle,{className:"h-5 w-5 text-green-500"});case"in-progress":return(0,t.jsx)(x.Loader2,{className:"h-5 w-5 text-blue-500 animate-spin"});case"error":return(0,t.jsx)(_.XCircle,{className:"h-5 w-5 text-red-500"});default:return(0,t.jsx)(g.Circle,{className:"h-5 w-5 text-muted-foreground"})}})(e.status),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.name}),"in-progress"===e.status&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(e.progress),"%"]})]}),e.message&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.message}),e.error&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:e.error})]})]}),"in-progress"===e.status&&(0,t.jsx)(f.Progress,{value:e.progress,className:"h-1.5 ml-8"})]},s))}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 pt-4 border-t border-border",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-foreground",children:e.totalRecords}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-500",children:e.processedRecords}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Processed"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-500",children:e.successfulRecords}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Success"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-red-500",children:e.failedRecords}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Failed"})]})]})]})}var S=e.i(844994),C=e.i(136449),b=e.i(838589),j=e.i(176359),N=e.i(562029),w=e.i(766342),E=e.i(685911),A=e.i(600945);function T({data:e,errors:r=[],warnings:a=[],duplicates:l=[],onEdit:o,onRemove:d}){let[c,h]=(0,s.useState)(""),[u,m]=(0,s.useState)("all"),[f,g]=(0,s.useState)(1),x=e=>{let t=r.some(t=>t.customer===e),s=a.some(t=>t.customer===e),i=l.some(t=>t.duplicate===e);return t?"error":i?"duplicate":s?"warning":"valid"},_=e.filter(e=>{let t=x(e),s="all"===u||"valid"===u&&"valid"===t||"errors"===u&&"error"===t||"warnings"===u&&"warning"===t||"duplicates"===u&&"duplicate"===t,r=!c||Object.values(e).some(e=>String(e).toLowerCase().includes(c.toLowerCase()));return s&&r}),v=Math.ceil(_.length/10),y=_.slice((f-1)*10,10*f),T={all:e.length,valid:e.filter(e=>"valid"===x(e)).length,errors:r.length,warnings:a.length,duplicates:l.length};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(p.Card,{className:"p-4 border-border",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(N.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(S.Input,{placeholder:"Search records...",value:c,onChange:e=>h(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(b.Select,{value:u,onValueChange:e=>m(e),children:[(0,t.jsxs)(b.SelectTrigger,{className:"w-48",children:[(0,t.jsx)(w.Filter,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(b.SelectValue,{})]}),(0,t.jsxs)(b.SelectContent,{children:[(0,t.jsxs)(b.SelectItem,{value:"all",children:["All (",T.all,")"]}),(0,t.jsxs)(b.SelectItem,{value:"valid",children:["Valid (",T.valid,")"]}),(0,t.jsxs)(b.SelectItem,{value:"errors",children:["Errors (",T.errors,")"]}),(0,t.jsxs)(b.SelectItem,{value:"warnings",children:["Warnings (",T.warnings,")"]}),(0,t.jsxs)(b.SelectItem,{value:"duplicates",children:["Duplicates (",T.duplicates,")"]})]})]})]})}),(0,t.jsxs)(p.Card,{className:"border-border overflow-hidden",children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(C.Table,{children:[(0,t.jsx)(C.TableHeader,{children:(0,t.jsxs)(C.TableRow,{children:[(0,t.jsx)(C.TableHead,{className:"w-12",children:"Status"}),(0,t.jsx)(C.TableHead,{children:"Contact Name"}),(0,t.jsx)(C.TableHead,{children:"Company"}),(0,t.jsx)(C.TableHead,{children:"Email"}),(0,t.jsx)(C.TableHead,{children:"Phone"}),(0,t.jsx)(C.TableHead,{children:"City"}),(0,t.jsx)(C.TableHead,{children:"State"}),(0,t.jsx)(C.TableHead,{className:"w-24",children:"Actions"})]})}),(0,t.jsx)(C.TableBody,{children:0===y.length?(0,t.jsx)(C.TableRow,{children:(0,t.jsx)(C.TableCell,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No records found"})}):y.map((e,s)=>{let o,c,h,u=x(e),m=(o=r.find(t=>t.customer===e),c=a.find(t=>t.customer===e),h=l.find(t=>t.duplicate===e),{errors:o?.errors||[],warnings:c?.warnings||[],duplicate:h}),p=(f-1)*10+s;return(0,t.jsxs)(C.TableRow,{className:"error"===u?"bg-red-500/5":"",children:[(0,t.jsxs)(C.TableCell,{children:["valid"===u&&(0,t.jsx)(n.CheckCircle,{className:"h-5 w-5 text-green-500"}),"error"===u&&(0,t.jsx)(j.AlertCircle,{className:"h-5 w-5 text-red-500"}),"warning"===u&&(0,t.jsx)(j.AlertCircle,{className:"h-5 w-5 text-yellow-500"}),"duplicate"===u&&(0,t.jsx)(j.AlertCircle,{className:"h-5 w-5 text-orange-500"})]}),(0,t.jsx)(C.TableCell,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:e.contact_name}),m.errors.some(e=>"contact_name"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:m.errors.find(e=>"contact_name"===e.field)?.message})]})}),(0,t.jsx)(C.TableCell,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.company_name||"-"})}),(0,t.jsx)(C.TableCell,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email||"-"}),m.errors.some(e=>"email"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:m.errors.find(e=>"email"===e.field)?.message}),m.warnings.some(e=>"email"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-yellow-500 mt-1",children:m.warnings.find(e=>"email"===e.field)?.message})]})}),(0,t.jsx)(C.TableCell,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.phone||"-"})}),(0,t.jsx)(C.TableCell,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.city||"-"})}),(0,t.jsx)(C.TableCell,{children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.state||"-"})}),(0,t.jsx)(C.TableCell,{children:d&&(0,t.jsx)(i.Button,{variant:"ghost",size:"sm",onClick:()=>d(p),className:"text-red-500 hover:text-red-600",children:"Remove"})})]},p)})})]})}),v>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t border-border",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",(f-1)*10+1," to"," ",Math.min(10*f,_.length)," of ",_.length," records"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===f,children:(0,t.jsx)(E.ChevronLeft,{className:"h-4 w-4"})}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",f," of ",v]}),(0,t.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.min(v,e+1)),disabled:f===v,children:(0,t.jsx)(A.ChevronRight,{className:"h-4 w-4"})})]})]})]})]})}var R=e.i(823018),k=e.i(305682);let I=[{value:"contact_name",label:"Contact Name",required:!0},{value:"company_name",label:"Company Name",required:!1},{value:"email",label:"Email",required:!1},{value:"phone",label:"Phone",required:!1},{value:"address_line1",label:"Address Line 1",required:!1},{value:"address_line2",label:"Address Line 2",required:!1},{value:"city",label:"City",required:!1},{value:"state",label:"State",required:!1},{value:"zip_code",label:"Zip Code",required:!1},{value:"country",label:"Country",required:!1},{value:"tax_id",label:"Tax ID",required:!1},{value:"notes",label:"Notes",required:!1}];function O({open:e,onOpenChange:a,sourceColumns:l,onConfirm:o}){let[d,c]=(0,s.useState)({}),h=I.filter(e=>e.required).every(e=>d[e.value]&&"skip"!==d[e.value]),u=()=>Object.values(d).filter(e=>e&&"skip"!==e).length;return(0,t.jsx)(r.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(r.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(r.DialogHeader,{children:[(0,t.jsx)(r.DialogTitle,{children:"Map Columns"}),(0,t.jsx)(r.DialogDescription,{children:"Map your file columns to the customer fields. Required fields are marked with an asterisk."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(p.Card,{className:"p-4 border-border bg-accent/5",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Mapping Progress"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[u()," of ",I.length," fields mapped"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.CheckCircle,{className:"h-5 w-5 text-green-500"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[Math.round(u()/I.length*100),"%"]})]})]})}),(0,t.jsx)("div",{className:"space-y-3",children:I.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 border border-border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)(R.Label,{className:"text-sm font-medium text-foreground",children:[e.label,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.required?"Required field":"Optional field"})]}),(0,t.jsx)(k.ArrowRight,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)(b.Select,{value:d[e.value]||"",onValueChange:t=>{var s;return s=e.value,void c(e=>({...e,[s]:t}))},children:[(0,t.jsx)(b.SelectTrigger,{children:(0,t.jsx)(b.SelectValue,{placeholder:"Select column..."})}),(0,t.jsxs)(b.SelectContent,{children:[(0,t.jsx)(b.SelectItem,{value:"skip",children:"Skip this field"}),l.map(e=>(0,t.jsx)(b.SelectItem,{value:e,children:e},e))]})]})})]},e.value))}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-border",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:()=>{o(d),a(!1)},disabled:!h,children:"Confirm Mapping"})]})]})]})})}var D=e.i(738867);e.s(["BulkUploadDialog",0,function({open:e,onOpenChange:l,onComplete:d}){let[c,h]=(0,s.useState)(null),[p,f]=(0,s.useState)(!1),[g,x]=(0,s.useState)("upload"),[_,v]=(0,s.useState)(null),[S,C]=(0,s.useState)(null),[b,j]=(0,s.useState)(null),[N,w]=(0,s.useState)(!1),[E,A]=(0,s.useState)(null),[R,k]=(0,s.useState)(null),I=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?f(!0):"dragleave"===e.type&&f(!1)},M=async e=>{let t=e.name.split(".").pop()?.toLowerCase();if(!["csv","xlsx","xls","pdf"].includes(t||""))return void alert("Please upload a CSV, Excel, or PDF file");h(e),x("mapping");try{let s;s="csv"===t?await o.parseCSV(e):"xlsx"===t||"xls"===t?await o.parseExcel(e):await o.parsePDF(e),v(s),s.data.length>0&&(Object.keys(s.data[0]),w(!0))}catch(e){console.error("Error parsing file:",e),alert("Failed to parse file. Please check the format and try again.")}},L=async e=>{j(e),w(!1),x("preview"),_&&C(await u.process(_.data,[]))},P=async()=>{if(!S||0===S.unique.length)return;x("processing");let e=new m(S.unique.length);A(e),e.subscribe(e=>{k(e)});try{e.startStage(0,"File parsed successfully"),e.completeStage(0),e.startStage(1,"Cleaning customer data..."),await new Promise(e=>setTimeout(e,500)),e.completeStage(1,`Cleaned ${S.cleaned.length} records`),e.startStage(2,"Validating records..."),await new Promise(e=>setTimeout(e,500)),e.completeStage(2,`${S.valid.length} valid records`),e.startStage(3,"Checking for duplicates..."),await new Promise(e=>setTimeout(e,500)),e.completeStage(3,`${S.duplicates.length} duplicates found`),e.startStage(4,"Uploading to database...");let t=[];for(let e=0;e<S.unique.length;e+=50)t.push(S.unique.slice(e,e+50));let s=0,r=0;for(let i=0;i<t.length;i++){(await fetch("/api/accounting/customers/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customers:t[i]})})).ok?s+=t[i].length:r+=t[i].length;let a=(i+1)/t.length*100;e.updateStageProgress(4,a,`Uploaded ${s} of ${S.unique.length} records`),e.updateRecordProgress(s+r,s,r)}e.completeStage(4,`Successfully uploaded ${s} customers`),setTimeout(()=>{d(),l(!1),F()},2e3)}catch(e){console.error("Error uploading customers:",e),E&&E.errorStage(4,"Failed to upload customers")}},F=()=>{h(null),v(null),C(null),j(null),x("upload"),A(null),k(null)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Dialog,{open:e,onOpenChange:l,children:(0,t.jsxs)(r.DialogContent,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(r.DialogHeader,{children:[(0,t.jsx)(r.DialogTitle,{children:"Bulk Upload Customers"}),(0,t.jsx)(r.DialogDescription,{children:"Upload CSV, Excel, or PDF files with customer data. We'll automatically parse, clean, and validate the data."})]}),(0,t.jsxs)("div",{className:"space-y-6",children:["upload"===g&&(0,t.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${p?"border-accent bg-accent/5":"border-border"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:e=>{e.preventDefault(),e.stopPropagation(),f(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&M(e.dataTransfer.files[0])},children:[(0,t.jsx)(a.Upload,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium text-foreground mb-2",children:"Drag and drop your file here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"or click to browse"}),(0,t.jsx)("input",{type:"file",id:"file-upload",className:"hidden",accept:".csv,.xlsx,.xls,.pdf",onChange:e=>{e.target.files&&e.target.files[0]&&M(e.target.files[0])}}),(0,t.jsx)("label",{htmlFor:"file-upload",children:(0,t.jsx)(i.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)("span",{children:"Choose File"})})}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"Supported formats: CSV, Excel (.xlsx, .xls), PDF"})]}),"preview"===g&&S&&(0,t.jsxs)(D.Tabs,{defaultValue:"all",className:"w-full",children:[(0,t.jsxs)(D.TabsList,{className:"grid w-full grid-cols-4",children:[(0,t.jsxs)(D.TabsTrigger,{value:"all",children:["All (",S.stats.totalInput,")"]}),(0,t.jsxs)(D.TabsTrigger,{value:"valid",children:["Valid (",S.stats.valid,")"]}),(0,t.jsxs)(D.TabsTrigger,{value:"errors",children:["Errors (",S.stats.invalid,")"]}),(0,t.jsxs)(D.TabsTrigger,{value:"duplicates",children:["Duplicates (",S.stats.duplicates,")"]})]}),(0,t.jsx)(D.TabsContent,{value:"all",className:"mt-4",children:(0,t.jsx)(T,{data:S.cleaned,errors:S.invalid,warnings:S.warnings,duplicates:S.duplicates})}),(0,t.jsx)(D.TabsContent,{value:"valid",className:"mt-4",children:(0,t.jsx)(T,{data:S.valid})}),(0,t.jsx)(D.TabsContent,{value:"errors",className:"mt-4",children:(0,t.jsx)(T,{data:S.invalid.map(e=>e.customer),errors:S.invalid})}),(0,t.jsx)(D.TabsContent,{value:"duplicates",className:"mt-4",children:(0,t.jsx)(T,{data:S.duplicates.map(e=>e.duplicate),duplicates:S.duplicates})})]}),"processing"===g&&R&&(0,t.jsx)(y,{progress:R}),"preview"===g&&S&&(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:F,children:"Start Over"}),(0,t.jsxs)(i.Button,{onClick:P,disabled:0===S.unique.length,className:"gap-2",children:[(0,t.jsx)(n.CheckCircle,{className:"h-4 w-4"}),"Upload ",S.unique.length," Customer",1!==S.unique.length?"s":""]})]})]})]})}),_&&(0,t.jsx)(O,{open:N,onOpenChange:w,sourceColumns:_.data.length>0?Object.keys(_.data[0]):[],onConfirm:L})]})}],397874)}]);